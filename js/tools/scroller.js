// koffee 1.4.0

/*
 0000000   0000000  00000000    0000000   000      000      00000000  00000000
000       000       000   000  000   000  000      000      000       000   000
0000000   000       0000000    000   000  000      000      0000000   0000000
     000  000       000   000  000   000  000      000      000       000   000
0000000    0000000  000   000   0000000   0000000  0000000  00000000  000   000
 */
var Scroller, _, clamp, drag, elem, klog, ref, stopEvent,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), stopEvent = ref.stopEvent, clamp = ref.clamp, drag = ref.drag, elem = ref.elem, klog = ref.klog, _ = ref._;

Scroller = (function() {
    Scroller.colors = {};

    function Scroller(column) {
        this.column = column;
        this.update = bind(this.update, this);
        this.onScroll = bind(this.onScroll, this);
        this.onWheel = bind(this.onWheel, this);
        this.onDrag = bind(this.onDrag, this);
        this.onStart = bind(this.onStart, this);
        this.elem = elem({
            "class": 'scrollbar right'
        });
        this.column.div.insertBefore(this.elem, this.column.table);
        this.handle = elem({
            "class": 'scrollhandle right'
        });
        this.elem.appendChild(this.handle);
        this.drag = new drag({
            target: this.elem,
            onStart: this.onStart,
            onMove: this.onDrag,
            cursor: 'ns-resize'
        });
        this.elem.addEventListener('wheel', this.onWheel);
        this.column.div.addEventListener('wheel', this.onWheel);
        this.column.div.addEventListener('scroll', this.onScroll);
        this.target = this.column.div;
    }

    Scroller.prototype.numRows = function() {
        return this.column.numRows();
    };

    Scroller.prototype.visRows = function() {
        return 1 + parseInt(this.column.browser.height() / this.rowHeight());
    };

    Scroller.prototype.height = function() {
        return this.column.browser.height();
    };

    Scroller.prototype.rowHeight = function() {
        return this.column.rowHeight();
    };

    Scroller.prototype.onStart = function(drag, event) {
        var br, ln, ly, sy;
        br = this.elem.getBoundingClientRect();
        sy = clamp(0, this.height(), event.clientY - br.top);
        ln = parseInt(this.numRows() * sy / this.height());
        ly = (ln - this.visRows() / 2) * this.rowHeight();
        return this.target.scrollTop = ly;
    };

    Scroller.prototype.onDrag = function(drag) {
        var delta;
        delta = (drag.delta.y / (this.visRows() * this.rowHeight())) * this.numRows() * this.rowHeight();
        this.target.scrollTop += delta;
        return this.update();
    };

    Scroller.prototype.onWheel = function(event) {
        if (Math.abs(event.deltaX) >= 2 * Math.abs(event.deltaY) || Math.abs(event.deltaY) === 0) {
            this.target.scrollLeft += event.deltaX;
        } else {
            this.target.scrollTop += event.deltaY;
        }
        return stopEvent(event);
    };

    Scroller.prototype.onScroll = function(event) {
        return this.update();
    };

    Scroller.prototype.toIndex = function(i) {
        var newTop, row;
        row = this.column.rows[i].div;
        newTop = this.target.scrollTop;
        if (newTop < row.offsetTop + this.rowHeight() - this.height()) {
            newTop = row.offsetTop + this.rowHeight() - this.height();
        } else if (newTop > row.offsetTop) {
            newTop = row.offsetTop;
        }
        this.target.scrollTop = parseInt(newTop);
        return this.update();
    };

    Scroller.colorForClass = function(clss) {
        var color, div;
        if (this.colors[clss] == null) {
            div = elem({
                "class": clss
            });
            document.body.appendChild(div);
            color = window.getComputedStyle(div).color;
            this.colors[clss] = color;
            div.remove();
        }
        return this.colors[clss];
    };

    Scroller.fadeColor = function(a, b, f) {
        var av, bv, fv, i, j;
        av = this.parseColor(a);
        bv = this.parseColor(b);
        fv = [0, 0, 0];
        for (i = j = 0; j < 3; i = ++j) {
            fv[i] = Math.round((1 - f) * av[i] + f * bv[i]);
        }
        return "rgb(" + fv[0] + ", " + fv[1] + ", " + fv[2] + ")";
    };

    Scroller.parseColor = function(c) {
        var e, s, v;
        if (_.isString(c) && c.startsWith('rgb')) {
            s = c.indexOf('(');
            e = c.indexOf(')');
            c = c.slice(s + 1, e);
            v = c.split(',');
            return [parseInt(v[0]), parseInt(v[1]), parseInt(v[2])];
        }
    };

    Scroller.prototype.update = function() {
        var base, base1, bh, cf, cs, longColor, ref1, ref2, ref3, scrollHeight, scrollTop, shortColor, vh;
        if (this.numRows() * this.rowHeight() < this.height()) {
            this.elem.style.display = 'none';
            this.elem.style.top = "0";
            this.handle.style.top = "0";
            this.handle.style.height = "0";
            this.handle.style.width = "0";
        } else {
            this.elem.style.display = 'block';
            bh = this.numRows() * this.rowHeight();
            vh = Math.min(this.visRows() * this.rowHeight(), this.height());
            scrollTop = parseInt((this.target.scrollTop / bh) * vh);
            scrollHeight = parseInt(((this.visRows() * this.rowHeight()) / bh) * vh);
            scrollHeight = Math.max(scrollHeight, parseInt(this.rowHeight() / 4));
            scrollTop = Math.min(scrollTop, this.height() - scrollHeight);
            scrollTop = Math.max(0, scrollTop);
            this.elem.style.top = this.target.scrollTop + "px";
            this.handle.style.top = scrollTop + "px";
            this.handle.style.height = scrollHeight + "px";
            this.handle.style.width = "2px";
            longColor = Scroller.colorForClass('scroller long');
            shortColor = Scroller.colorForClass('scroller short');
            cf = 1 - clamp(0, 1, (scrollHeight - 10) / 200);
            cs = Scroller.fadeColor(longColor, shortColor, cf);
            this.handle.style.backgroundColor = cs;
        }
        if (((ref1 = this.column.parent) != null ? ref1.type : void 0) === 'preview') {
            if ((typeof (base = this.column).prevColumn === "function" ? base.prevColumn().div.scrollTop : void 0) !== this.target.scrollTop) {
                this.column.prevColumn().div.scrollTop = this.target.scrollTop;
            }
        } else if ((typeof (base1 = this.column).nextColumn === "function" ? (ref2 = base1.nextColumn()) != null ? (ref3 = ref2.parent) != null ? ref3.type : void 0 : void 0 : void 0) === 'preview') {
            if (this.column.nextColumn().div.scrollTop !== this.target.scrollTop) {
                this.column.nextColumn().div.scrollTop = this.target.scrollTop;
            }
        }
        return this.handle.style.right = "-" + this.target.scrollLeft + "px";
    };

    return Scroller;

})();

module.exports = Scroller;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Nyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7Ozs7QUFBQSxJQUFBLG9EQUFBO0lBQUE7O0FBUUEsTUFBNEMsT0FBQSxDQUFRLEtBQVIsQ0FBNUMsRUFBRSx5QkFBRixFQUFhLGlCQUFiLEVBQW9CLGVBQXBCLEVBQTBCLGVBQTFCLEVBQWdDLGVBQWhDLEVBQXNDOztBQUVoQztJQUVGLFFBQUMsQ0FBQSxNQUFELEdBQVU7O0lBRVAsa0JBQUMsTUFBRDtRQUFDLElBQUMsQ0FBQSxTQUFEOzs7Ozs7UUFFQSxJQUFDLENBQUEsSUFBRCxHQUFRLElBQUEsQ0FBSztZQUFBLENBQUEsS0FBQSxDQUFBLEVBQU8saUJBQVA7U0FBTDtRQUNSLElBQUMsQ0FBQSxNQUFNLENBQUMsR0FBRyxDQUFDLFlBQVosQ0FBeUIsSUFBQyxDQUFBLElBQTFCLEVBQWdDLElBQUMsQ0FBQSxNQUFNLENBQUMsS0FBeEM7UUFFQSxJQUFDLENBQUEsTUFBRCxHQUFVLElBQUEsQ0FBSztZQUFBLENBQUEsS0FBQSxDQUFBLEVBQU8sb0JBQVA7U0FBTDtRQUNWLElBQUMsQ0FBQSxJQUFJLENBQUMsV0FBTixDQUFrQixJQUFDLENBQUEsTUFBbkI7UUFFQSxJQUFDLENBQUEsSUFBRCxHQUFRLElBQUksSUFBSixDQUNKO1lBQUEsTUFBQSxFQUFTLElBQUMsQ0FBQSxJQUFWO1lBQ0EsT0FBQSxFQUFTLElBQUMsQ0FBQSxPQURWO1lBRUEsTUFBQSxFQUFTLElBQUMsQ0FBQSxNQUZWO1lBR0EsTUFBQSxFQUFTLFdBSFQ7U0FESTtRQU1SLElBQUMsQ0FBQSxJQUFJLENBQUMsZ0JBQU4sQ0FBNkIsT0FBN0IsRUFBc0MsSUFBQyxDQUFBLE9BQXZDO1FBQ0EsSUFBQyxDQUFBLE1BQU0sQ0FBQyxHQUFHLENBQUMsZ0JBQVosQ0FBNkIsT0FBN0IsRUFBc0MsSUFBQyxDQUFBLE9BQXZDO1FBQ0EsSUFBQyxDQUFBLE1BQU0sQ0FB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Q3pDOzs7Ozs7QUF5Q1osTUFBTSxDQUFDLE9BQVAsR0FBaUIiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbiAwMDAwMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMCAgICAgIDAwMCAgICAgIDAwMDAwMDAwICAwMDAwMDAwMFxuMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgIDAwMFxuMDAwMDAwMCAgIDAwMCAgICAgICAwMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgICAgMDAwMDAwMCAgIDAwMDAwMDBcbiAgICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgICAgIDAwMCAgICAgICAwMDAgICAwMDBcbjAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDBcbiMjI1xuXG57IHN0b3BFdmVudCwgY2xhbXAsIGRyYWcsIGVsZW0sIGtsb2csIF8gfSA9IHJlcXVpcmUgJ2t4aydcblxuY2xhc3MgU2Nyb2xsZXJcblxuICAgIEBjb2xvcnMgPSB7fVxuICAgIFxuICAgIEA6IChAY29sdW1uKSAtPlxuXG4gICAgICAgIEBlbGVtID0gZWxlbSBjbGFzczogJ3Njcm9sbGJhciByaWdodCdcbiAgICAgICAgQGNvbHVtbi5kaXYuaW5zZXJ0QmVmb3JlIEBlbGVtLCBAY29sdW1uLnRhYmxlXG5cbiAgICAgICAgQGhhbmRsZSA9IGVsZW0gY2xhc3M6ICdzY3JvbGxoYW5kbGUgcmlnaHQnXG4gICAgICAgIEBlbGVtLmFwcGVuZENoaWxkIEBoYW5kbGVcblxuICAgICAgICBAZHJhZyA9IG5ldyBkcmFnXG4gICAgICAgICAgICB0YXJnZXQ6ICBAZWxlbVxuICAgICAgICAgICAgb25TdGFydDogQG9uU3RhcnRcbiAgICAgICAgICAgIG9uTW92ZTogIEBvbkRyYWdcbiAgICAgICAgICAgIGN1cnNvcjogICducy1yZXNpemUnXG5cbiAgICAgICAgQGVsZW0uYWRkRXZlbnRMaXN0ZW5lciAgICAgICAnd2hlZWwnICBAb25XaGVlbFxuICAgICAgICBAY29sdW1uLmRpdi5hZGRFdmVudExpc3RlbmVyICd3aGVlbCcgIEBvbldoZWVsXG4gICAgICAgIEBjb2x1bW4uZGl2LmFkZEV2ZW50TGlzdGVuZXIgJ3Njcm9sbCcgQG9uU2Nyb2xsXG4gICAgICAgIEB0YXJnZXQgPSBAY29sdW1uLmRpdlxuICAgICAgICBcbiAgICBudW1Sb3dzOiAgIC0+IEBjb2x1bW4ubnVtUm93cygpXG4gICAgdmlzUm93czogICAtPiAxICsgcGFyc2VJbnQgQGNvbHVtbi5icm93c2VyLmhlaWdodCgpIC8gQHJvd0hlaWdodCgpXG4gICAgaGVpZ2h0OiAgICAtPiBAY29sdW1uLmJyb3dzZXIuaGVpZ2h0KClcbiAgICByb3dIZWlnaHQ6IC0+IEBjb2x1bW4ucm93SGVpZ2h0KClcbiAgICBcbiAgICAjICAwMDAwMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAwMDAwMDBcbiAgICAjIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDBcbiAgICAjIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgICAgICAwMDBcbiAgICAjICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDBcbiAgICAjIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDBcblxuICAgIG9uU3RhcnQ6IChkcmFnLCBldmVudCkgPT5cbiAgICAgICAgXG4gICAgICAgIGJyID0gQGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgICAgc3kgPSBjbGFtcCAwLCBAaGVpZ2h0KCksIGV2ZW50LmNsaWVudFkgLSBici50b3BcbiAgICAgICAgbG4gPSBwYXJzZUludCBAbnVtUm93cygpICogc3kvQGhlaWdodCgpXG4gICAgICAgIGx5ID0gKGxuIC0gQHZpc1Jvd3MoKSAvIDIpICogQHJvd0hlaWdodCgpXG4gICAgICAgIEB0YXJnZXQuc2Nyb2xsVG9wID0gbHlcblxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwMCAgICAwMDAwMDAwICAgIDAwMDAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwICAwMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDBcbiAgICAjIDAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwXG5cbiAgICBvbkRyYWc6IChkcmFnKSA9PlxuICAgICAgICBcbiAgICAgICAgZGVsdGEgPSAoZHJhZy5kZWx0YS55IC8gKEB2aXNSb3dzKCkgKiBAcm93SGVpZ2h0KCkpKSAqIEBudW1Sb3dzKCkgKiBAcm93SGVpZ2h0KClcbiAgICAgICAgQHRhcmdldC5zY3JvbGxUb3AgKz0gZGVsdGFcbiAgICAgICAgQHVwZGF0ZSgpXG5cbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAgIDAwMFxuICAgICMgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwXG4gICAgIyAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMFxuICAgICMgMDAgICAgIDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMFxuXG4gICAgb25XaGVlbDogKGV2ZW50KSA9PlxuICAgICAgICBcbiAgICAgICAgaWYgTWF0aC5hYnMoZXZlbnQuZGVsdGFYKSA+PSAyKk1hdGguYWJzKGV2ZW50LmRlbHRhWSkgb3IgTWF0aC5hYnMoZXZlbnQuZGVsdGFZKSA9PSAwXG4gICAgICAgICAgICBAdGFyZ2V0LnNjcm9sbExlZnQgKz0gZXZlbnQuZGVsdGFYXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIEB0YXJnZXQuc2Nyb2xsVG9wICs9IGV2ZW50LmRlbHRhWVxuICAgICAgICBzdG9wRXZlbnQgZXZlbnQgICAgXG4gICAgICAgIFxuICAgIG9uU2Nyb2xsOiAoZXZlbnQpID0+IEB1cGRhdGUoKVxuXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMCAgICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwXG4gICAgIyAgMDAwMDAwMCAgIDAwMCAgICAgICAgMDAwMDAwMCAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwMDAwMDBcblxuICAgIHRvSW5kZXg6IChpKSAtPlxuICAgICAgICBcbiAgICAgICAgcm93ID0gQGNvbHVtbi5yb3dzW2ldLmRpdlxuICAgICAgICBuZXdUb3AgPSBAdGFyZ2V0LnNjcm9sbFRvcFxuICAgICAgICBpZiBuZXdUb3AgPCByb3cub2Zmc2V0VG9wICsgQHJvd0hlaWdodCgpIC0gQGhlaWdodCgpXG4gICAgICAgICAgICBuZXdUb3AgPSByb3cub2Zmc2V0VG9wICsgQHJvd0hlaWdodCgpIC0gQGhlaWdodCgpXG4gICAgICAgIGVsc2UgaWYgbmV3VG9wID4gcm93Lm9mZnNldFRvcFxuICAgICAgICAgICAgbmV3VG9wID0gcm93Lm9mZnNldFRvcFxuICAgICAgICBAdGFyZ2V0LnNjcm9sbFRvcCA9IHBhcnNlSW50IG5ld1RvcFxuICAgICAgICBAdXBkYXRlKClcblxuICAgIEBjb2xvckZvckNsYXNzOiAoY2xzcykgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIG5vdCBAY29sb3JzW2Nsc3NdP1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBkaXYgPSBlbGVtIGNsYXNzOiBjbHNzXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkIGRpdlxuICAgICAgICAgICAgY29sb3IgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkaXYpLmNvbG9yXG4gICAgICAgICAgICBAY29sb3JzW2Nsc3NdID0gY29sb3JcbiAgICAgICAgICAgIGRpdi5yZW1vdmUoKVxuICAgICAgICAgICAgXG4gICAgICAgIHJldHVybiBAY29sb3JzW2Nsc3NdXG4gICAgICAgIFxuICAgIEBmYWRlQ29sb3I6IChhLGIsZikgLT5cbiAgICAgICAgXG4gICAgICAgIGF2ID0gQHBhcnNlQ29sb3IgYVxuICAgICAgICBidiA9IEBwYXJzZUNvbG9yIGJcbiAgICAgICAgZnYgPSBbMCwwLDBdXG4gICAgICAgIGZvciBpIGluIFswLi4uM11cbiAgICAgICAgICAgIGZ2W2ldID0gTWF0aC5yb3VuZCAoMS1mKSAqIGF2W2ldICsgZiAqIGJ2W2ldXG4gICAgICAgIFwicmdiKCN7ZnZbMF19LCAje2Z2WzFdfSwgI3tmdlsyXX0pXCJcbiAgICAgICBcbiAgICBAcGFyc2VDb2xvcjogKGMpIC0+XG4gICAgICAgIFxuICAgICAgICBpZiBfLmlzU3RyaW5nKGMpIGFuZCBjLnN0YXJ0c1dpdGggJ3JnYidcbiAgICAgICAgICAgIHMgPSBjLmluZGV4T2YgJygnXG4gICAgICAgICAgICBlID0gYy5pbmRleE9mICcpJ1xuICAgICAgICAgICAgYyA9IGMuc2xpY2UgcysxLCBlXG4gICAgICAgICAgICB2ID0gYy5zcGxpdCAnLCdcbiAgICAgICAgICAgIHJldHVybiBbcGFyc2VJbnQodlswXSksIHBhcnNlSW50KHZbMV0pLCBwYXJzZUludCh2WzJdKV1cbiAgICAgICAgXG4gICAgdXBkYXRlOiA9PlxuICAgICAgICBcbiAgICAgICAgaWYgQG51bVJvd3MoKSAqIEByb3dIZWlnaHQoKSA8IEBoZWlnaHQoKVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBAZWxlbS5zdHlsZS5kaXNwbGF5ICAgPSAnbm9uZSdcbiAgICAgICAgICAgIEBlbGVtLnN0eWxlLnRvcCAgICAgICA9IFwiMFwiXG4gICAgICAgICAgICBAaGFuZGxlLnN0eWxlLnRvcCAgICAgPSBcIjBcIlxuICAgICAgICAgICAgQGhhbmRsZS5zdHlsZS5oZWlnaHQgID0gXCIwXCJcbiAgICAgICAgICAgIEBoYW5kbGUuc3R5bGUud2lkdGggICA9IFwiMFwiXG4gICAgICAgICAgICBcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgQGVsZW0uc3R5bGUuZGlzcGxheSAgID0gJ2Jsb2NrJ1xuICAgICAgICAgICAgYmggICAgICAgICAgID0gQG51bVJvd3MoKSAqIEByb3dIZWlnaHQoKVxuICAgICAgICAgICAgdmggICAgICAgICAgID0gTWF0aC5taW4gKEB2aXNSb3dzKCkgKiBAcm93SGVpZ2h0KCkpLCBAaGVpZ2h0KClcbiAgICAgICAgICAgIHNjcm9sbFRvcCAgICA9IHBhcnNlSW50IChAdGFyZ2V0LnNjcm9sbFRvcCAvIGJoKSAqIHZoXG4gICAgICAgICAgICBzY3JvbGxIZWlnaHQgPSBwYXJzZUludCAoKEB2aXNSb3dzKCkgKiBAcm93SGVpZ2h0KCkpIC8gYmgpICogdmhcbiAgICAgICAgICAgIHNjcm9sbEhlaWdodCA9IE1hdGgubWF4IHNjcm9sbEhlaWdodCwgcGFyc2VJbnQgQHJvd0hlaWdodCgpLzRcbiAgICAgICAgICAgIHNjcm9sbFRvcCAgICA9IE1hdGgubWluIHNjcm9sbFRvcCwgQGhlaWdodCgpLXNjcm9sbEhlaWdodFxuICAgICAgICAgICAgc2Nyb2xsVG9wICAgID0gTWF0aC5tYXggMCwgc2Nyb2xsVG9wXG5cbiAgICAgICAgICAgIEBlbGVtLnN0eWxlLnRvcCA9IFwiI3tAdGFyZ2V0LnNjcm9sbFRvcH1weFwiXG5cbiAgICAgICAgICAgIEBoYW5kbGUuc3R5bGUudG9wICAgICA9IFwiI3tzY3JvbGxUb3B9cHhcIlxuICAgICAgICAgICAgQGhhbmRsZS5zdHlsZS5oZWlnaHQgID0gXCIje3Njcm9sbEhlaWdodH1weFwiXG4gICAgICAgICAgICBAaGFuZGxlLnN0eWxlLndpZHRoICAgPSBcIjJweFwiXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxvbmdDb2xvciAgPSBTY3JvbGxlci5jb2xvckZvckNsYXNzICdzY3JvbGxlciBsb25nJ1xuICAgICAgICAgICAgc2hvcnRDb2xvciA9IFNjcm9sbGVyLmNvbG9yRm9yQ2xhc3MgJ3Njcm9sbGVyIHNob3J0J1xuICAgICAgICAgICAgY2YgPSAxIC0gY2xhbXAgMCwgMSwgKHNjcm9sbEhlaWdodC0xMCkvMjAwXG4gICAgICAgICAgICBjcyA9IFNjcm9sbGVyLmZhZGVDb2xvciBsb25nQ29sb3IsIHNob3J0Q29sb3IsIGNmXG4gICAgICAgICAgICBAaGFuZGxlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNzXG5cbiAgICAgICAgaWYgQGNvbHVtbi5wYXJlbnQ/LnR5cGUgPT0gJ3ByZXZpZXcnXG4gICAgICAgICAgICBpZiBAY29sdW1uLnByZXZDb2x1bW4/KCkuZGl2LnNjcm9sbFRvcCAhPSBAdGFyZ2V0LnNjcm9sbFRvcFxuICAgICAgICAgICAgICAgIEBjb2x1bW4ucHJldkNvbHVtbigpLmRpdi5zY3JvbGxUb3AgPSBAdGFyZ2V0LnNjcm9sbFRvcFxuICAgICAgICBlbHNlIGlmIEBjb2x1bW4ubmV4dENvbHVtbj8oKT8ucGFyZW50Py50eXBlID09ICdwcmV2aWV3J1xuICAgICAgICAgICAgaWYgQGNvbHVtbi5uZXh0Q29sdW1uKCkuZGl2LnNjcm9sbFRvcCAhPSBAdGFyZ2V0LnNjcm9sbFRvcFxuICAgICAgICAgICAgICAgIEBjb2x1bW4ubmV4dENvbHVtbigpLmRpdi5zY3JvbGxUb3AgPSBAdGFyZ2V0LnNjcm9sbFRvcFxuICAgICAgICAgICAgXG4gICAgICAgIEBoYW5kbGUuc3R5bGUucmlnaHQgPSBcIi0je0B0YXJnZXQuc2Nyb2xsTGVmdH1weFwiXG5cbm1vZHVsZS5leHBvcnRzID0gU2Nyb2xsZXJcbiJdfQ==
//# sourceURL=../../coffee/tools/scroller.coffee