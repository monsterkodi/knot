// koffee 1.12.0

/*
 0000000   0000000  00000000    0000000   000      000      00000000  00000000
000       000       000   000  000   000  000      000      000       000   000
0000000   000       0000000    000   000  000      000      0000000   0000000
     000  000       000   000  000   000  000      000      000       000   000
0000000    0000000  000   000   0000000   0000000  0000000  00000000  000   000
 */
var Scroller, _, clamp, drag, elem, ref, stopEvent,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), stopEvent = ref.stopEvent, clamp = ref.clamp, elem = ref.elem, drag = ref.drag, _ = ref._;

Scroller = (function() {
    Scroller.colors = {};

    function Scroller(column) {
        this.column = column;
        this.update = bind(this.update, this);
        this.onScroll = bind(this.onScroll, this);
        this.onWheel = bind(this.onWheel, this);
        this.onDrag = bind(this.onDrag, this);
        this.onStart = bind(this.onStart, this);
        this.elem = elem({
            "class": 'scrollbar right'
        });
        this.column.div.insertBefore(this.elem, this.column.table);
        this.handle = elem({
            "class": 'scrollhandle right'
        });
        this.elem.appendChild(this.handle);
        this.drag = new drag({
            target: this.elem,
            onStart: this.onStart,
            onMove: this.onDrag,
            cursor: 'ns-resize'
        });
        this.elem.addEventListener('wheel', this.onWheel);
        this.column.div.addEventListener('wheel', this.onWheel);
        this.column.div.addEventListener('scroll', this.onScroll);
        this.target = this.column.div;
    }

    Scroller.prototype.numRows = function() {
        return this.column.numRows();
    };

    Scroller.prototype.visRows = function() {
        return 1 + parseInt(this.column.browser.height() / this.rowHeight());
    };

    Scroller.prototype.height = function() {
        return this.column.browser.height();
    };

    Scroller.prototype.rowHeight = function() {
        return this.column.rowHeight();
    };

    Scroller.prototype.onStart = function(drag, event) {
        var br, ln, ly, sy;
        br = this.elem.getBoundingClientRect();
        sy = clamp(0, this.height(), event.clientY - br.top);
        ln = parseInt(this.numRows() * sy / this.height());
        ly = (ln - this.visRows() / 2) * this.rowHeight();
        return this.target.scrollTop = ly;
    };

    Scroller.prototype.onDrag = function(drag) {
        var delta;
        delta = (drag.delta.y / (this.visRows() * this.rowHeight())) * this.numRows() * this.rowHeight();
        this.target.scrollTop += delta;
        return this.update();
    };

    Scroller.prototype.onWheel = function(event) {
        if (Math.abs(event.deltaX) >= 2 * Math.abs(event.deltaY) || Math.abs(event.deltaY) === 0) {
            this.target.scrollLeft += event.deltaX;
        } else {
            this.target.scrollTop += event.deltaY;
        }
        return stopEvent(event);
    };

    Scroller.prototype.onScroll = function(event) {
        return this.update();
    };

    Scroller.prototype.toIndex = function(i) {
        var newTop, row;
        row = this.column.rows[i].div;
        newTop = this.target.scrollTop;
        if (newTop < row.offsetTop + this.rowHeight() - this.height()) {
            newTop = row.offsetTop + this.rowHeight() - this.height();
        } else if (newTop > row.offsetTop) {
            newTop = row.offsetTop;
        }
        this.target.scrollTop = parseInt(newTop);
        return this.update();
    };

    Scroller.colorForClass = function(clss) {
        var color, div;
        if (this.colors[clss] == null) {
            div = elem({
                "class": clss
            });
            document.body.appendChild(div);
            color = window.getComputedStyle(div).color;
            this.colors[clss] = color;
            div.remove();
        }
        return this.colors[clss];
    };

    Scroller.fadeColor = function(a, b, f) {
        var av, bv, fv, i, j;
        av = this.parseColor(a);
        bv = this.parseColor(b);
        fv = [0, 0, 0];
        for (i = j = 0; j < 3; i = ++j) {
            fv[i] = Math.round((1 - f) * av[i] + f * bv[i]);
        }
        return "rgb(" + fv[0] + ", " + fv[1] + ", " + fv[2] + ")";
    };

    Scroller.parseColor = function(c) {
        var e, s, v;
        if (_.isString(c) && c.startsWith('rgb')) {
            s = c.indexOf('(');
            e = c.indexOf(')');
            c = c.slice(s + 1, e);
            v = c.split(',');
            return [parseInt(v[0]), parseInt(v[1]), parseInt(v[2])];
        }
    };

    Scroller.prototype.update = function() {
        var base, base1, bh, cf, cs, longColor, ref1, ref2, ref3, scrollHeight, scrollTop, shortColor, vh;
        if (this.numRows() * this.rowHeight() < this.height()) {
            this.elem.style.display = 'none';
            this.elem.style.top = "0";
            this.handle.style.top = "0";
            this.handle.style.height = "0";
            this.handle.style.width = "0";
        } else {
            this.elem.style.display = 'block';
            bh = this.numRows() * this.rowHeight();
            vh = Math.min(this.visRows() * this.rowHeight(), this.height());
            scrollTop = parseInt((this.target.scrollTop / bh) * vh);
            scrollHeight = parseInt(((this.visRows() * this.rowHeight()) / bh) * vh);
            scrollHeight = Math.max(scrollHeight, parseInt(this.rowHeight() / 4));
            scrollTop = Math.min(scrollTop, this.height() - scrollHeight);
            scrollTop = Math.max(0, scrollTop);
            this.elem.style.top = this.target.scrollTop + "px";
            this.handle.style.top = scrollTop + "px";
            this.handle.style.height = scrollHeight + "px";
            this.handle.style.width = "2px";
            longColor = Scroller.colorForClass('scroller long');
            shortColor = Scroller.colorForClass('scroller short');
            cf = 1 - clamp(0, 1, (scrollHeight - 10) / 200);
            cs = Scroller.fadeColor(longColor, shortColor, cf);
            this.handle.style.backgroundColor = cs;
        }
        if (((ref1 = this.column.parent) != null ? ref1.type : void 0) === 'preview') {
            if ((typeof (base = this.column).prevColumn === "function" ? base.prevColumn().div.scrollTop : void 0) !== this.target.scrollTop) {
                this.column.prevColumn().div.scrollTop = this.target.scrollTop;
            }
        } else if ((typeof (base1 = this.column).nextColumn === "function" ? (ref2 = base1.nextColumn()) != null ? (ref3 = ref2.parent) != null ? ref3.type : void 0 : void 0 : void 0) === 'preview') {
            if (this.column.nextColumn().div.scrollTop !== this.target.scrollTop) {
                this.column.nextColumn().div.scrollTop = this.target.scrollTop;
            }
        }
        return this.handle.style.right = "-" + this.target.scrollLeft + "px";
    };

    return Scroller;

})();

module.exports = Scroller;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Nyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiLi4vLi4vY29mZmVlL3Rvb2xzIiwic291cmNlcyI6WyJzY3JvbGxlci5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUEsOENBQUE7SUFBQTs7QUFRQSxNQUFzQyxPQUFBLENBQVEsS0FBUixDQUF0QyxFQUFFLHlCQUFGLEVBQWEsaUJBQWIsRUFBb0IsZUFBcEIsRUFBMEIsZUFBMUIsRUFBZ0M7O0FBRTFCO0lBRUYsUUFBQyxDQUFBLE1BQUQsR0FBVTs7SUFFUCxrQkFBQyxNQUFEO1FBQUMsSUFBQyxDQUFBLFNBQUQ7Ozs7OztRQUVBLElBQUMsQ0FBQSxJQUFELEdBQVEsSUFBQSxDQUFLO1lBQUEsQ0FBQSxLQUFBLENBQUEsRUFBTyxpQkFBUDtTQUFMO1FBQ1IsSUFBQyxDQUFBLE1BQU0sQ0FBQyxHQUFHLENBQUMsWUFBWixDQUF5QixJQUFDLENBQUEsSUFBMUIsRUFBZ0MsSUFBQyxDQUFBLE1BQU0sQ0FBQyxLQUF4QztRQUVBLElBQUMsQ0FBQSxNQUFELEdBQVUsSUFBQSxDQUFLO1lBQUEsQ0FBQSxLQUFBLENBQUEsRUFBTyxvQkFBUDtTQUFMO1FBQ1YsSUFBQyxDQUFBLElBQUksQ0FBQyxXQUFOLENBQWtCLElBQUMsQ0FBQSxNQUFuQjtRQUVBLElBQUMsQ0FBQSxJQUFELEdBQVEsSUFBSSxJQUFKLENBQ0o7WUFBQSxNQUFBLEVBQVMsSUFBQyxDQUFBLElBQVY7WUFDQSxPQUFBLEVBQVMsSUFBQyxDQUFBLE9BRFY7WUFFQSxNQUFBLEVBQVMsSUFBQyxDQUFBLE1BRlY7WUFHQSxNQUFBLEVBQVMsV0FIVDtTQURJO1FBTVIsSUFBQyxDQUFBLElBQUksQ0FBQyxnQkFBTixDQUE2QixPQUE3QixFQUFzQyxJQUFDLENBQUEsT0FBdkM7UUFDQSxJQUFDLENBQUEsTUFBTSxDQUFDLEdBQUcsQ0FBQyxnQkFBWixDQUE2QixPQUE3QixFQUFzQyxJQUFDLENBQUEsT0FBdkM7UUFD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LENBQUMsVUFBWixHQUF1QjtJQXZDekM7Ozs7OztBQXlDWixNQUFNLENBQUMsT0FBUCxHQUFpQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuIDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgICAgMDAwICAgICAgMDAwMDAwMDAgIDAwMDAwMDAwXG4wMDAgICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAgICAwMDAgICAgICAgMDAwICAgMDAwXG4wMDAwMDAwICAgMDAwICAgICAgIDAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAgICAwMDAwMDAwICAgMDAwMDAwMFxuICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgIDAwMFxuMDAwMDAwMCAgICAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMFxuIyMjXG5cbnsgc3RvcEV2ZW50LCBjbGFtcCwgZWxlbSwgZHJhZywgXyB9ID0gcmVxdWlyZSAna3hrJ1xuXG5jbGFzcyBTY3JvbGxlclxuXG4gICAgQGNvbG9ycyA9IHt9XG4gICAgXG4gICAgQDogKEBjb2x1bW4pIC0+XG5cbiAgICAgICAgQGVsZW0gPSBlbGVtIGNsYXNzOiAnc2Nyb2xsYmFyIHJpZ2h0J1xuICAgICAgICBAY29sdW1uLmRpdi5pbnNlcnRCZWZvcmUgQGVsZW0sIEBjb2x1bW4udGFibGVcblxuICAgICAgICBAaGFuZGxlID0gZWxlbSBjbGFzczogJ3Njcm9sbGhhbmRsZSByaWdodCdcbiAgICAgICAgQGVsZW0uYXBwZW5kQ2hpbGQgQGhhbmRsZVxuXG4gICAgICAgIEBkcmFnID0gbmV3IGRyYWdcbiAgICAgICAgICAgIHRhcmdldDogIEBlbGVtXG4gICAgICAgICAgICBvblN0YXJ0OiBAb25TdGFydFxuICAgICAgICAgICAgb25Nb3ZlOiAgQG9uRHJhZ1xuICAgICAgICAgICAgY3Vyc29yOiAgJ25zLXJlc2l6ZSdcblxuICAgICAgICBAZWxlbS5hZGRFdmVudExpc3RlbmVyICAgICAgICd3aGVlbCcgIEBvbldoZWVsXG4gICAgICAgIEBjb2x1bW4uZGl2LmFkZEV2ZW50TGlzdGVuZXIgJ3doZWVsJyAgQG9uV2hlZWxcbiAgICAgICAgQGNvbHVtbi5kaXYuYWRkRXZlbnRMaXN0ZW5lciAnc2Nyb2xsJyBAb25TY3JvbGxcbiAgICAgICAgQHRhcmdldCA9IEBjb2x1bW4uZGl2XG4gICAgICAgIFxuICAgIG51bVJvd3M6ICAgLT4gQGNvbHVtbi5udW1Sb3dzKClcbiAgICB2aXNSb3dzOiAgIC0+IDEgKyBwYXJzZUludCBAY29sdW1uLmJyb3dzZXIuaGVpZ2h0KCkgLyBAcm93SGVpZ2h0KClcbiAgICBoZWlnaHQ6ICAgIC0+IEBjb2x1bW4uYnJvd3Nlci5oZWlnaHQoKVxuICAgIHJvd0hlaWdodDogLT4gQGNvbHVtbi5yb3dIZWlnaHQoKVxuICAgIFxuICAgICMgIDAwMDAwMDAgIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwMFxuICAgICMgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMFxuICAgICMgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMDAwICAwMDAwMDAwICAgICAgIDAwMFxuICAgICMgICAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMFxuICAgICMgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMFxuXG4gICAgb25TdGFydDogKGRyYWcsIGV2ZW50KSA9PlxuICAgICAgICBcbiAgICAgICAgYnIgPSBAZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgICBzeSA9IGNsYW1wIDAsIEBoZWlnaHQoKSwgZXZlbnQuY2xpZW50WSAtIGJyLnRvcFxuICAgICAgICBsbiA9IHBhcnNlSW50IEBudW1Sb3dzKCkgKiBzeS9AaGVpZ2h0KClcbiAgICAgICAgbHkgPSAobG4gLSBAdmlzUm93cygpIC8gMikgKiBAcm93SGVpZ2h0KClcbiAgICAgICAgQHRhcmdldC5zY3JvbGxUb3AgPSBseVxuXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAgMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMDAwICAwMDAgIDAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuICAgICMgMDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDBcblxuICAgIG9uRHJhZzogKGRyYWcpID0+XG4gICAgICAgIFxuICAgICAgICBkZWx0YSA9IChkcmFnLmRlbHRhLnkgLyAoQHZpc1Jvd3MoKSAqIEByb3dIZWlnaHQoKSkpICogQG51bVJvd3MoKSAqIEByb3dIZWlnaHQoKVxuICAgICAgICBAdGFyZ2V0LnNjcm9sbFRvcCArPSBkZWx0YVxuICAgICAgICBAdXBkYXRlKClcblxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwXG4gICAgIyAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDBcbiAgICAjIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwXG4gICAgIyAwMCAgICAgMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwXG5cbiAgICBvbldoZWVsOiAoZXZlbnQpID0+XG4gICAgICAgIFxuICAgICAgICBpZiBNYXRoLmFicyhldmVudC5kZWx0YVgpID49IDIqTWF0aC5hYnMoZXZlbnQuZGVsdGFZKSBvciBNYXRoLmFicyhldmVudC5kZWx0YVkpID09IDBcbiAgICAgICAgICAgIEB0YXJnZXQuc2Nyb2xsTGVmdCArPSBldmVudC5kZWx0YVhcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgQHRhcmdldC5zY3JvbGxUb3AgKz0gZXZlbnQuZGVsdGFZXG4gICAgICAgIHN0b3BFdmVudCBldmVudCAgICBcbiAgICAgICAgXG4gICAgb25TY3JvbGw6IChldmVudCkgPT4gQHVwZGF0ZSgpXG5cbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAgICAwMDAgICAgIDAwMDAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDBcbiAgICAjICAwMDAwMDAwICAgMDAwICAgICAgICAwMDAwMDAwICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMFxuXG4gICAgdG9JbmRleDogKGkpIC0+XG4gICAgICAgIFxuICAgICAgICByb3cgPSBAY29sdW1uLnJvd3NbaV0uZGl2XG4gICAgICAgIG5ld1RvcCA9IEB0YXJnZXQuc2Nyb2xsVG9wXG4gICAgICAgIGlmIG5ld1RvcCA8IHJvdy5vZmZzZXRUb3AgKyBAcm93SGVpZ2h0KCkgLSBAaGVpZ2h0KClcbiAgICAgICAgICAgIG5ld1RvcCA9IHJvdy5vZmZzZXRUb3AgKyBAcm93SGVpZ2h0KCkgLSBAaGVpZ2h0KClcbiAgICAgICAgZWxzZSBpZiBuZXdUb3AgPiByb3cub2Zmc2V0VG9wXG4gICAgICAgICAgICBuZXdUb3AgPSByb3cub2Zmc2V0VG9wXG4gICAgICAgIEB0YXJnZXQuc2Nyb2xsVG9wID0gcGFyc2VJbnQgbmV3VG9wXG4gICAgICAgIEB1cGRhdGUoKVxuXG4gICAgQGNvbG9yRm9yQ2xhc3M6IChjbHNzKSAtPlxuICAgICAgICBcbiAgICAgICAgaWYgbm90IEBjb2xvcnNbY2xzc10/XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRpdiA9IGVsZW0gY2xhc3M6IGNsc3NcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQgZGl2XG4gICAgICAgICAgICBjb2xvciA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRpdikuY29sb3JcbiAgICAgICAgICAgIEBjb2xvcnNbY2xzc10gPSBjb2xvclxuICAgICAgICAgICAgZGl2LnJlbW92ZSgpXG4gICAgICAgICAgICBcbiAgICAgICAgcmV0dXJuIEBjb2xvcnNbY2xzc11cbiAgICAgICAgXG4gICAgQGZhZGVDb2xvcjogKGEsYixmKSAtPlxuICAgICAgICBcbiAgICAgICAgYXYgPSBAcGFyc2VDb2xvciBhXG4gICAgICAgIGJ2ID0gQHBhcnNlQ29sb3IgYlxuICAgICAgICBmdiA9IFswLDAsMF1cbiAgICAgICAgZm9yIGkgaW4gWzAuLi4zXVxuICAgICAgICAgICAgZnZbaV0gPSBNYXRoLnJvdW5kICgxLWYpICogYXZbaV0gKyBmICogYnZbaV1cbiAgICAgICAgXCJyZ2IoI3tmdlswXX0sICN7ZnZbMV19LCAje2Z2WzJdfSlcIlxuICAgICAgIFxuICAgIEBwYXJzZUNvbG9yOiAoYykgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIF8uaXNTdHJpbmcoYykgYW5kIGMuc3RhcnRzV2l0aCAncmdiJ1xuICAgICAgICAgICAgcyA9IGMuaW5kZXhPZiAnKCdcbiAgICAgICAgICAgIGUgPSBjLmluZGV4T2YgJyknXG4gICAgICAgICAgICBjID0gYy5zbGljZSBzKzEsIGVcbiAgICAgICAgICAgIHYgPSBjLnNwbGl0ICcsJ1xuICAgICAgICAgICAgcmV0dXJuIFtwYXJzZUludCh2WzBdKSwgcGFyc2VJbnQodlsxXSksIHBhcnNlSW50KHZbMl0pXVxuICAgICAgICBcbiAgICB1cGRhdGU6ID0+XG4gICAgICAgIFxuICAgICAgICBpZiBAbnVtUm93cygpICogQHJvd0hlaWdodCgpIDwgQGhlaWdodCgpXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIEBlbGVtLnN0eWxlLmRpc3BsYXkgICA9ICdub25lJ1xuICAgICAgICAgICAgQGVsZW0uc3R5bGUudG9wICAgICAgID0gXCIwXCJcbiAgICAgICAgICAgIEBoYW5kbGUuc3R5bGUudG9wICAgICA9IFwiMFwiXG4gICAgICAgICAgICBAaGFuZGxlLnN0eWxlLmhlaWdodCAgPSBcIjBcIlxuICAgICAgICAgICAgQGhhbmRsZS5zdHlsZS53aWR0aCAgID0gXCIwXCJcbiAgICAgICAgICAgIFxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBAZWxlbS5zdHlsZS5kaXNwbGF5ICAgPSAnYmxvY2snXG4gICAgICAgICAgICBiaCAgICAgICAgICAgPSBAbnVtUm93cygpICogQHJvd0hlaWdodCgpXG4gICAgICAgICAgICB2aCAgICAgICAgICAgPSBNYXRoLm1pbiAoQHZpc1Jvd3MoKSAqIEByb3dIZWlnaHQoKSksIEBoZWlnaHQoKVxuICAgICAgICAgICAgc2Nyb2xsVG9wICAgID0gcGFyc2VJbnQgKEB0YXJnZXQuc2Nyb2xsVG9wIC8gYmgpICogdmhcbiAgICAgICAgICAgIHNjcm9sbEhlaWdodCA9IHBhcnNlSW50ICgoQHZpc1Jvd3MoKSAqIEByb3dIZWlnaHQoKSkgLyBiaCkgKiB2aFxuICAgICAgICAgICAgc2Nyb2xsSGVpZ2h0ID0gTWF0aC5tYXggc2Nyb2xsSGVpZ2h0LCBwYXJzZUludCBAcm93SGVpZ2h0KCkvNFxuICAgICAgICAgICAgc2Nyb2xsVG9wICAgID0gTWF0aC5taW4gc2Nyb2xsVG9wLCBAaGVpZ2h0KCktc2Nyb2xsSGVpZ2h0XG4gICAgICAgICAgICBzY3JvbGxUb3AgICAgPSBNYXRoLm1heCAwLCBzY3JvbGxUb3BcblxuICAgICAgICAgICAgQGVsZW0uc3R5bGUudG9wID0gXCIje0B0YXJnZXQuc2Nyb2xsVG9wfXB4XCJcblxuICAgICAgICAgICAgQGhhbmRsZS5zdHlsZS50b3AgICAgID0gXCIje3Njcm9sbFRvcH1weFwiXG4gICAgICAgICAgICBAaGFuZGxlLnN0eWxlLmhlaWdodCAgPSBcIiN7c2Nyb2xsSGVpZ2h0fXB4XCJcbiAgICAgICAgICAgIEBoYW5kbGUuc3R5bGUud2lkdGggICA9IFwiMnB4XCJcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbG9uZ0NvbG9yICA9IFNjcm9sbGVyLmNvbG9yRm9yQ2xhc3MgJ3Njcm9sbGVyIGxvbmcnXG4gICAgICAgICAgICBzaG9ydENvbG9yID0gU2Nyb2xsZXIuY29sb3JGb3JDbGFzcyAnc2Nyb2xsZXIgc2hvcnQnXG4gICAgICAgICAgICBjZiA9IDEgLSBjbGFtcCAwLCAxLCAoc2Nyb2xsSGVpZ2h0LTEwKS8yMDBcbiAgICAgICAgICAgIGNzID0gU2Nyb2xsZXIuZmFkZUNvbG9yIGxvbmdDb2xvciwgc2hvcnRDb2xvciwgY2ZcbiAgICAgICAgICAgIEBoYW5kbGUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY3NcblxuICAgICAgICBpZiBAY29sdW1uLnBhcmVudD8udHlwZSA9PSAncHJldmlldydcbiAgICAgICAgICAgIGlmIEBjb2x1bW4ucHJldkNvbHVtbj8oKS5kaXYuc2Nyb2xsVG9wICE9IEB0YXJnZXQuc2Nyb2xsVG9wXG4gICAgICAgICAgICAgICAgQGNvbHVtbi5wcmV2Q29sdW1uKCkuZGl2LnNjcm9sbFRvcCA9IEB0YXJnZXQuc2Nyb2xsVG9wXG4gICAgICAgIGVsc2UgaWYgQGNvbHVtbi5uZXh0Q29sdW1uPygpPy5wYXJlbnQ/LnR5cGUgPT0gJ3ByZXZpZXcnXG4gICAgICAgICAgICBpZiBAY29sdW1uLm5leHRDb2x1bW4oKS5kaXYuc2Nyb2xsVG9wICE9IEB0YXJnZXQuc2Nyb2xsVG9wXG4gICAgICAgICAgICAgICAgQGNvbHVtbi5uZXh0Q29sdW1uKCkuZGl2LnNjcm9sbFRvcCA9IEB0YXJnZXQuc2Nyb2xsVG9wXG4gICAgICAgICAgICBcbiAgICAgICAgQGhhbmRsZS5zdHlsZS5yaWdodCA9IFwiLSN7QHRhcmdldC5zY3JvbGxMZWZ0fXB4XCJcblxubW9kdWxlLmV4cG9ydHMgPSBTY3JvbGxlclxuIl19
//# sourceURL=../../coffee/tools/scroller.coffee