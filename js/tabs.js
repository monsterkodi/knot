// koffee 1.12.0

/*
000000000   0000000   0000000     0000000
   000     000   000  000   000  000     
   000     000000000  0000000    0000000 
   000     000   000  000   000       000
   000     000   000  0000000    0000000
 */
var $, Tab, Tabs, Term, _, drag, elem, empty, kpos, popup, post, ref, slash, stopEvent,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), $ = ref.$, _ = ref._, drag = ref.drag, elem = ref.elem, empty = ref.empty, kpos = ref.kpos, popup = ref.popup, post = ref.post, slash = ref.slash, stopEvent = ref.stopEvent;

Tab = require('./tab');

Term = require('./term');

Tabs = (function() {
    function Tabs(titlebar) {
        this.showContextMenu = bind(this.showContextMenu, this);
        this.onContextMenu = bind(this.onContextMenu, this);
        this.closeTabs = bind(this.closeTabs, this);
        this.onDragStop = bind(this.onDragStop, this);
        this.onDragMove = bind(this.onDragMove, this);
        this.onDragStart = bind(this.onDragStart, this);
        this.onClick = bind(this.onClick, this);
        this.restore = bind(this.restore, this);
        this.stash = bind(this.stash, this);
        this.tabs = [];
        this.div = elem({
            "class": 'tabs'
        });
        titlebar.insertBefore(this.div, $('.minimize'));
        this.div.addEventListener('click', this.onClick);
        this.div.addEventListener('contextmenu', this.onContextMenu);
        post.on('stash', this.stash);
        post.on('restore', this.restore);
        this.drag = new drag({
            target: this.div,
            onStart: this.onDragStart,
            onMove: this.onDragMove,
            onStop: this.onDragStop
        });
    }

    Tabs.prototype.stash = function() {
        var paths, ref1, tab;
        paths = (function() {
            var i, len, ref1, results;
            ref1 = this.tabs;
            results = [];
            for (i = 0, len = ref1.length; i < len; i++) {
                tab = ref1[i];
                results.push(tab.text);
            }
            return results;
        }).call(this);
        return window.stash.set('tabs', {
            paths: paths,
            active: Math.min((ref1 = this.activeTab()) != null ? ref1.index() : void 0, paths.length - 1)
        });
    };

    Tabs.prototype.restore = function() {
        var active, paths, ref1;
        active = window.stash.get('tabs:active', 0);
        paths = window.stash.get('tabs:paths');
        if (empty(paths)) {
            this.addTab(slash.tilde(process.cwd()));
            return;
        }
        while (paths.length) {
            this.addTab(paths.shift());
        }
        return (ref1 = this.tabs[active]) != null ? ref1.activate() : void 0;
    };

    Tabs.prototype.onClick = function(event) {
        var tab;
        if (tab = this.tab(event.target)) {
            if (event.target.classList.contains('dot')) {
                this.closeTab(tab);
            } else {
                tab.activate();
            }
        }
        return true;
    };

    Tabs.prototype.onDragStart = function(d, e) {
        var br;
        this.dragTab = this.tab(e.target);
        if (!this.dragTab) {
            return 'skip';
        }
        if (event.button !== 1) {
            return 'skip';
        }
        this.dragDiv = this.dragTab.div.cloneNode(true);
        this.dragTab.div.style.opacity = '0';
        br = this.dragTab.div.getBoundingClientRect();
        this.dragDiv.style.position = 'absolute';
        this.dragDiv.style.top = br.top + "px";
        this.dragDiv.style.left = br.left + "px";
        this.dragDiv.style.width = (br.width - 12) + "px";
        this.dragDiv.style.height = (br.height - 3) + "px";
        this.dragDiv.style.flex = 'unset';
        this.dragDiv.style.pointerEvents = 'none';
        return document.body.appendChild(this.dragDiv);
    };

    Tabs.prototype.onDragMove = function(d, e) {
        var tab;
        this.dragDiv.style.transform = "translateX(" + d.deltaSum.x + "px)";
        if (tab = this.tabAtX(d.pos.x)) {
            if (tab.index() !== this.dragTab.index()) {
                return this.swap(tab, this.dragTab);
            }
        }
    };

    Tabs.prototype.onDragStop = function(d, e) {
        this.dragTab.div.style.opacity = '';
        return this.dragDiv.remove();
    };

    Tabs.prototype.tab = function(id) {
        if (_.isNumber(id)) {
            return this.tabs[id];
        }
        if (_.isElement(id)) {
            return _.find(this.tabs, function(t) {
                return t.div.contains(id);
            });
        }
        if (_.isString(id)) {
            return _.find(this.tabs, function(t) {
                return t.info.text === id;
            });
        }
    };

    Tabs.prototype.activeTab = function() {
        return _.find(this.tabs, function(t) {
            return t.isActive();
        });
    };

    Tabs.prototype.numTabs = function() {
        return this.tabs.length;
    };

    Tabs.prototype.tabAtX = function(x) {
        return _.find(this.tabs, function(t) {
            var br;
            br = t.div.getBoundingClientRect();
            return (br.left <= x && x <= br.left + br.width);
        });
    };

    Tabs.prototype.resized = function() {
        var i, len, ref1, results, tab;
        ref1 = this.tabs;
        results = [];
        for (i = 0, len = ref1.length; i < len; i++) {
            tab = ref1[i];
            results.push(tab.term.resized());
        }
        return results;
    };

    Tabs.prototype.addTab = function(text) {
        var tab;
        tab = new Tab(this, new Term);
        tab.term.tab = tab;
        if (text) {
            tab.update(text);
        }
        this.tabs.push(tab);
        tab.activate();
        post.emit('menuAction', 'Clear');
        return tab;
    };

    Tabs.prototype.closeTab = function(tab) {
        var ref1;
        if (tab == null) {
            tab = this.activeTab();
        }
        if (tab == null) {
            return;
        }
        if (this.tabs.length > 1) {
            if (tab === this.activeTab()) {
                if ((ref1 = tab.nextOrPrev()) != null) {
                    ref1.activate();
                }
            }
        }
        tab.close();
        _.pull(this.tabs, tab);
        if (empty(this.tabs)) {
            post.emit('menuAction', 'Close');
        }
        return this;
    };

    Tabs.prototype.closeOtherTabs = function() {
        var keep;
        if (!this.activeTab()) {
            return;
        }
        keep = _.pullAt(this.tabs, this.activeTab().index());
        while (this.numTabs()) {
            this.tabs.pop().close();
        }
        return this.tabs = keep;
    };

    Tabs.prototype.closeTabs = function() {
        var results;
        results = [];
        while (this.numTabs()) {
            results.push(this.tabs.pop().close());
        }
        return results;
    };

    Tabs.prototype.navigate = function(key) {
        var index;
        index = this.activeTab().index();
        index += (function() {
            switch (key) {
                case 'left':
                    return -1;
                case 'right':
                    return +1;
            }
        })();
        index = (this.numTabs() + index) % this.numTabs();
        return this.tabs[index].activate();
    };

    Tabs.prototype.swap = function(ta, tb) {
        var ref1;
        if ((ta == null) || (tb == null)) {
            return;
        }
        if (ta.index() > tb.index()) {
            ref1 = [tb, ta], ta = ref1[0], tb = ref1[1];
        }
        this.tabs[ta.index()] = tb;
        this.tabs[tb.index() + 1] = ta;
        return this.div.insertBefore(tb.div, ta.div);
    };

    Tabs.prototype.move = function(key) {
        var tab;
        tab = this.activeTab();
        switch (key) {
            case 'left':
                return this.swap(tab, tab.prev());
            case 'right':
                return this.swap(tab, tab.next());
        }
    };

    Tabs.prototype.onContextMenu = function(event) {
        return stopEvent(event, this.showContextMenu(kpos(event)));
    };

    Tabs.prototype.showContextMenu = function(absPos) {
        var opt, tab;
        if (tab = this.tab(event.target)) {
            tab.activate();
        }
        if (absPos == null) {
            absPos = kpos(this.view.getBoundingClientRect().left, this.view.getBoundingClientRect().top);
        }
        opt = {
            items: [
                {
                    text: 'Close Other Tabs',
                    combo: 'ctrl+shift+w'
                }
            ]
        };
        opt.x = absPos.x;
        opt.y = absPos.y;
        return popup.menu(opt);
    };

    return Tabs;

})();

module.exports = Tabs;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFicy5qcyIsInNvdXJjZVJvb3QiOiIuLi9jb2ZmZWUiLCJzb3VyY2VzIjpbInRhYnMuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7Ozs7QUFBQSxJQUFBLGtGQUFBO0lBQUE7O0FBUUEsTUFBbUUsT0FBQSxDQUFRLEtBQVIsQ0FBbkUsRUFBRSxTQUFGLEVBQUssU0FBTCxFQUFRLGVBQVIsRUFBYyxlQUFkLEVBQW9CLGlCQUFwQixFQUEyQixlQUEzQixFQUFpQyxpQkFBakMsRUFBd0MsZUFBeEMsRUFBOEMsaUJBQTlDLEVBQXFEOztBQUVyRCxHQUFBLEdBQU8sT0FBQSxDQUFRLE9BQVI7O0FBQ1AsSUFBQSxHQUFPLE9BQUEsQ0FBUSxRQUFSOztBQUVEO0lBRUMsY0FBQyxRQUFEOzs7Ozs7Ozs7O1FBRUMsSUFBQyxDQUFBLElBQUQsR0FBUTtRQUNSLElBQUMsQ0FBQSxHQUFELEdBQU8sSUFBQSxDQUFLO1lBQUEsQ0FBQSxLQUFBLENBQUEsRUFBTSxNQUFOO1NBQUw7UUFFUCxRQUFRLENBQUMsWUFBVCxDQUFzQixJQUFDLENBQUEsR0FBdkIsRUFBNEIsQ0FBQSxDQUFFLFdBQUYsQ0FBNUI7UUFFQSxJQUFDLENBQUEsR0FBRyxDQUFDLGdCQUFMLENBQXNCLE9BQXRCLEVBQW9DLElBQUMsQ0FBQSxPQUFyQztRQUNBLElBQUMsQ0FBQSxHQUFHLENBQUMsZ0JBQUwsQ0FBc0IsYUFBdEIsRUFBb0MsSUFBQyxDQUFBLGFBQXJDO1FBRUEsSUFBSSxDQUFDLEVBQUwsQ0FBUSxPQUFSLEVBQWtCLElBQUMsQ0FBQSxLQUFuQjtRQUNBLElBQUksQ0FBQyxFQUFMLENBQVEsU0FBUixFQUFrQixJQUFDLENBQUEsT0FBbkI7UUFFQSxJQUFDLENBQUEsSUFBRCxHQUFRLElBQUksSUFBSixDQUNKO1lBQUEsTUFBQSxFQUFTLElBQUMsQ0FBQSxHQUFWO1lBQ0EsT0FBQSxFQUFTLElBQUMsQ0FBQSxXQURWO1lBRUEsTUFBQSxFQUFTLElBQUMsQ0FBQSxVQUZW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O21CQWFOLGFBQUEsR0FBZSxTQUFDLEtBQUQ7ZUFBVyxTQUFBLENBQVUsS0FBVixFQUFpQixJQUFDLENBQUEsZUFBRCxDQUFpQixJQUFBLENBQUssS0FBTCxDQUFqQixDQUFqQjtJQUFYOzttQkFFZixlQUFBLEdBQWlCLFNBQUMsTUFBRDtBQUViLFlBQUE7UUFBQSxJQUFHLEdBQUEsR0FBTSxJQUFDLENBQUEsR0FBRCxDQUFLLEtBQUssQ0FBQyxNQUFYLENBQVQ7WUFDSSxHQUFHLENBQUMsUUFBSixDQUFBLEVBREo7O1FBR0EsSUFBTyxjQUFQO1lBQ0ksTUFBQSxHQUFTLElBQUEsQ0FBSyxJQUFDLENBQUEsSUFBSSxDQUFDLHFCQUFOLENBQUEsQ0FBNkIsQ0FBQyxJQUFuQyxFQUF5QyxJQUFDLENBQUEsSUFBSSxDQUFDLHFCQUFOLENBQUEsQ0FBNkIsQ0FBQyxHQUF2RSxFQURiOztRQUdBLEdBQUEsR0FBTTtZQUFBLEtBQUEsRUFBTztnQkFDVDtvQkFBQSxJQUFBLEVBQVEsa0JBQVI7b0JBQ0EsS0FBQSxFQUFRLGNBRFI7aUJBRFM7YUFBUDs7UUFRTixHQUFHLENBQUMsQ0FBSixHQUFRLE1BQU0sQ0FBQztRQUNmLEdBQUcsQ0FBQyxDQUFKLEdBQVEsTUFBTSxDQUFDO2VBQ2YsS0FBSyxDQUFDLElBQU4sQ0FBVyxHQUFYO0lBbEJhOzs7Ozs7QUFvQnJCLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgICAgMDAwMDAwMFxuICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICBcbiAgIDAwMCAgICAgMDAwMDAwMDAwICAwMDAwMDAwICAgIDAwMDAwMDAgXG4gICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgIDAwMFxuICAgMDAwICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMCBcbiMjI1xuXG57ICQsIF8sIGRyYWcsIGVsZW0sIGVtcHR5LCBrcG9zLCBwb3B1cCwgcG9zdCwgc2xhc2gsIHN0b3BFdmVudCB9ID0gcmVxdWlyZSAna3hrJ1xuXG5UYWIgID0gcmVxdWlyZSAnLi90YWInXG5UZXJtID0gcmVxdWlyZSAnLi90ZXJtJ1xuXG5jbGFzcyBUYWJzXG4gICAgXG4gICAgQDogKHRpdGxlYmFyKSAtPlxuICAgICAgICBcbiAgICAgICAgQHRhYnMgPSBbXVxuICAgICAgICBAZGl2ID0gZWxlbSBjbGFzczondGFicydcbiAgICAgICAgXG4gICAgICAgIHRpdGxlYmFyLmluc2VydEJlZm9yZSBAZGl2LCAkICcubWluaW1pemUnXG4gICAgICAgIFxuICAgICAgICBAZGl2LmFkZEV2ZW50TGlzdGVuZXIgJ2NsaWNrJyAgICAgICBAb25DbGlja1xuICAgICAgICBAZGl2LmFkZEV2ZW50TGlzdGVuZXIgJ2NvbnRleHRtZW51JyBAb25Db250ZXh0TWVudVxuICAgICAgICBcbiAgICAgICAgcG9zdC5vbiAnc3Rhc2gnICAgQHN0YXNoXG4gICAgICAgIHBvc3Qub24gJ3Jlc3RvcmUnIEByZXN0b3JlXG4gICAgICAgIFxuICAgICAgICBAZHJhZyA9IG5ldyBkcmFnXG4gICAgICAgICAgICB0YXJnZXQ6ICBAZGl2XG4gICAgICAgICAgICBvblN0YXJ0OiBAb25EcmFnU3RhcnRcbiAgICAgICAgICAgIG9uTW92ZTogIEBvbkRyYWdNb3ZlXG4gICAgICAgICAgICBvblN0b3A6ICBAb25EcmFnU3RvcFxuXG4gICAgIyAwMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMDAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwMDAwMCAgICAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICBcblxuICAgIHN0YXNoOiA9PiBcblxuICAgICAgICBwYXRocyA9ICggdGFiLnRleHQgZm9yIHRhYiBpbiBAdGFicyApXG4gICAgICAgIFxuICAgICAgICB3aW5kb3cuc3Rhc2guc2V0ICd0YWJzJywgXG4gICAgICAgICAgICBwYXRoczogIHBhdGhzXG4gICAgICAgICAgICBhY3RpdmU6IE1hdGgubWluIEBhY3RpdmVUYWIoKT8uaW5kZXgoKSwgcGF0aHMubGVuZ3RoLTFcbiAgICBcbiAgICByZXN0b3JlOiA9PlxuICAgICAgICBcbiAgICAgICAgYWN0aXZlID0gd2luZG93LnN0YXNoLmdldCAndGFiczphY3RpdmUnIDBcbiAgICAgICAgcGF0aHMgID0gd2luZG93LnN0YXNoLmdldCAndGFiczpwYXRocydcbiAgICAgICAgXG4gICAgICAgIGlmIGVtcHR5IHBhdGhzICMgaGFwcGVucyB3aGVuIGZpcnN0IHdpbmRvdyBvcGVuc1xuICAgICAgICAgICAgQGFkZFRhYiBzbGFzaC50aWxkZSBwcm9jZXNzLmN3ZCgpXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgXG4gICAgICAgIHdoaWxlIHBhdGhzLmxlbmd0aFxuICAgICAgICAgICAgQGFkZFRhYiBwYXRocy5zaGlmdCgpXG4gICAgICAgIFxuICAgICAgICBAdGFic1thY3RpdmVdPy5hY3RpdmF0ZSgpXG4gICAgICAgICAgICBcbiAgICAjICAwMDAwMDAwICAwMDAgICAgICAwMDAgICAwMDAwMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwICAwMDAgICAgICAgMDAwMDAwMCAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgIFxuICAgICMgIDAwMDAwMDAgIDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4gICAgXG4gICAgb25DbGljazogKGV2ZW50KSA9PlxuICAgICAgICBcbiAgICAgICAgaWYgdGFiID0gQHRhYiBldmVudC50YXJnZXRcbiAgICAgICAgICAgIGlmIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMgJ2RvdCdcbiAgICAgICAgICAgICAgICBAY2xvc2VUYWIgdGFiXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdGFiLmFjdGl2YXRlKClcbiAgICAgICAgdHJ1ZVxuXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMCAgMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICBcbiAgICBcbiAgICBvbkRyYWdTdGFydDogKGQsIGUpID0+IFxuICAgICAgICBcbiAgICAgICAgIyBpZiBlLmJ1dHRvbiA9PSAyXG4gICAgICAgICAgICAjIEBjbG9zZVRhYiBAdGFiIGUudGFyZ2V0XG4gICAgICAgICAgICAjIHJldHVybiAnc2tpcCdcbiAgICAgICAgICAgIFxuICAgICAgICBAZHJhZ1RhYiA9IEB0YWIgZS50YXJnZXRcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAnc2tpcCcgaWYgbm90IEBkcmFnVGFiXG4gICAgICAgIHJldHVybiAnc2tpcCcgaWYgZXZlbnQuYnV0dG9uICE9IDFcbiAgICAgICAgXG4gICAgICAgIEBkcmFnRGl2ID0gQGRyYWdUYWIuZGl2LmNsb25lTm9kZSB0cnVlXG4gICAgICAgIEBkcmFnVGFiLmRpdi5zdHlsZS5vcGFjaXR5ID0gJzAnXG4gICAgICAgIGJyID0gQGRyYWdUYWIuZGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgICAgIEBkcmFnRGl2LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJ1xuICAgICAgICBAZHJhZ0Rpdi5zdHlsZS50b3AgID0gXCIje2JyLnRvcH1weFwiXG4gICAgICAgIEBkcmFnRGl2LnN0eWxlLmxlZnQgPSBcIiN7YnIubGVmdH1weFwiXG4gICAgICAgIEBkcmFnRGl2LnN0eWxlLndpZHRoID0gXCIje2JyLndpZHRoLTEyfXB4XCJcbiAgICAgICAgQGRyYWdEaXYuc3R5bGUuaGVpZ2h0ID0gXCIje2JyLmhlaWdodC0zfXB4XCJcbiAgICAgICAgQGRyYWdEaXYuc3R5bGUuZmxleCA9ICd1bnNldCdcbiAgICAgICAgQGRyYWdEaXYuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJ1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkIEBkcmFnRGl2XG5cbiAgICBvbkRyYWdNb3ZlOiAoZCxlKSA9PlxuICAgICAgICBcbiAgICAgICAgQGRyYWdEaXYuc3R5bGUudHJhbnNmb3JtID0gXCJ0cmFuc2xhdGVYKCN7ZC5kZWx0YVN1bS54fXB4KVwiXG4gICAgICAgIGlmIHRhYiA9IEB0YWJBdFggZC5wb3MueFxuICAgICAgICAgICAgaWYgdGFiLmluZGV4KCkgIT0gQGRyYWdUYWIuaW5kZXgoKVxuICAgICAgICAgICAgICAgIEBzd2FwIHRhYiwgQGRyYWdUYWJcbiAgICAgICAgXG4gICAgb25EcmFnU3RvcDogKGQsZSkgPT5cbiAgICAgICAgXG4gICAgICAgIEBkcmFnVGFiLmRpdi5zdHlsZS5vcGFjaXR5ID0gJydcbiAgICAgICAgQGRyYWdEaXYucmVtb3ZlKClcblxuICAgICMgMDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgXG4gICAgIyAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjICAgIDAwMCAgICAgMDAwMDAwMDAwICAwMDAwMDAwICAgIFxuICAgICMgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICBcbiAgICBcbiAgICB0YWI6IChpZCkgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIF8uaXNOdW1iZXIgIGlkIHRoZW4gcmV0dXJuIEB0YWJzW2lkXVxuICAgICAgICBpZiBfLmlzRWxlbWVudCBpZCB0aGVuIHJldHVybiBfLmZpbmQgQHRhYnMsICh0KSAtPiB0LmRpdi5jb250YWlucyBpZFxuICAgICAgICBpZiBfLmlzU3RyaW5nICBpZCB0aGVuIHJldHVybiBfLmZpbmQgQHRhYnMsICh0KSAtPiB0LmluZm8udGV4dCA9PSBpZFxuXG4gICAgYWN0aXZlVGFiOiAtPiBfLmZpbmQgQHRhYnMsICh0KSAtPiB0LmlzQWN0aXZlKClcbiAgICBudW1UYWJzOiAgIC0+IEB0YWJzLmxlbmd0aFxuICAgIFxuICAgIHRhYkF0WDogKHgpIC0+IFxuICAgICAgICBcbiAgICAgICAgXy5maW5kIEB0YWJzLCAodCkgLT4gXG4gICAgICAgICAgICBiciA9IHQuZGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgICAgICAgICBici5sZWZ0IDw9IHggPD0gYnIubGVmdCArIGJyLndpZHRoXG5cbiAgICByZXNpemVkOiAtPiBmb3IgdGFiIGluIEB0YWJzIHRoZW4gdGFiLnRlcm0ucmVzaXplZCgpXG4gICAgICAgICAgXG4gICAgIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4gICAgIyAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMCAgXG4gICAgXG4gICAgYWRkVGFiOiAodGV4dCkgLT5cbiAgICAgICAgXG4gICAgICAgIHRhYiA9IG5ldyBUYWIgQCwgbmV3IFRlcm1cbiAgICAgICAgdGFiLnRlcm0udGFiID0gdGFiXG4gICAgICAgIFxuICAgICAgICBpZiB0ZXh0IHRoZW4gdGFiLnVwZGF0ZSB0ZXh0XG4gICAgICAgICAgICBcbiAgICAgICAgQHRhYnMucHVzaCB0YWJcbiAgICAgICAgdGFiLmFjdGl2YXRlKClcbiAgICAgICAgcG9zdC5lbWl0ICdtZW51QWN0aW9uJyAnQ2xlYXInXG4gICAgICAgIHRhYlxuICAgICAgICBcbiAgICAjICAwMDAwMDAwICAwMDAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAwMDAwMCAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAwMDAgICAgICAgMDAwICAwMDAgICAgICAgXG4gICAgIyAgMDAwMDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgIFxuICAgIFxuICAgIGNsb3NlVGFiOiAodGFiID0gQGFjdGl2ZVRhYigpKSAtPlxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGlmIG5vdCB0YWI/XG4gICAgICAgICAgICAgICAgICAgXG4gICAgICAgIGlmIEB0YWJzLmxlbmd0aCA+IDFcbiAgICAgICAgICAgIGlmIHRhYiA9PSBAYWN0aXZlVGFiKClcbiAgICAgICAgICAgICAgICB0YWIubmV4dE9yUHJldigpPy5hY3RpdmF0ZSgpXG4gICAgICAgICAgICBcbiAgICAgICAgdGFiLmNsb3NlKClcbiAgICAgICAgXG4gICAgICAgIF8ucHVsbCBAdGFicywgdGFiXG4gICAgICAgIFxuICAgICAgICBpZiBlbXB0eSBAdGFicyAjIGNsb3NlIHRoZSB3aW5kb3cgd2hlbiBsYXN0IHRhYiB3YXMgY2xvc2VkXG4gICAgICAgICAgICBwb3N0LmVtaXQgJ21lbnVBY3Rpb24nICdDbG9zZScgXG4gICAgICAgIFxuICAgICAgICBAXG4gIFxuICAgIGNsb3NlT3RoZXJUYWJzOiAtPiBcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBub3QgQGFjdGl2ZVRhYigpXG4gICAgICAgIGtlZXAgPSBfLnB1bGxBdCBAdGFicywgQGFjdGl2ZVRhYigpLmluZGV4KClcbiAgICAgICAgd2hpbGUgQG51bVRhYnMoKVxuICAgICAgICAgICAgQHRhYnMucG9wKCkuY2xvc2UoKVxuICAgICAgICBAdGFicyA9IGtlZXBcbiAgICBcbiAgICBjbG9zZVRhYnM6ID0+XG4gICAgICAgIFxuICAgICAgICB3aGlsZSBAbnVtVGFicygpXG4gICAgICAgICAgICBAdGFicy5wb3AoKS5jbG9zZSgpXG4gICAgICAgIFxuICAgICMgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwMCAgXG4gICAgIyAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAwIDAwMCAgMDAwMDAwMDAwICAgMDAwIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwMDAgICAgIDAwMCAgICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAwMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgIDAgICAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMDAwMDAwICBcbiAgICBcbiAgICBuYXZpZ2F0ZTogKGtleSkgLT5cbiAgICAgICAgXG4gICAgICAgIGluZGV4ID0gQGFjdGl2ZVRhYigpLmluZGV4KClcbiAgICAgICAgaW5kZXggKz0gc3dpdGNoIGtleVxuICAgICAgICAgICAgd2hlbiAnbGVmdCcgdGhlbiAtMVxuICAgICAgICAgICAgd2hlbiAncmlnaHQnIHRoZW4gKzFcbiAgICAgICAgaW5kZXggPSAoQG51bVRhYnMoKSArIGluZGV4KSAlIEBudW1UYWJzKClcbiAgICAgICAgQHRhYnNbaW5kZXhdLmFjdGl2YXRlKClcblxuICAgIHN3YXA6ICh0YSwgdGIpIC0+XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gaWYgbm90IHRhPyBvciBub3QgdGI/XG4gICAgICAgIFt0YSwgdGJdID0gW3RiLCB0YV0gaWYgdGEuaW5kZXgoKSA+IHRiLmluZGV4KClcbiAgICAgICAgQHRhYnNbdGEuaW5kZXgoKV0gICA9IHRiXG4gICAgICAgIEB0YWJzW3RiLmluZGV4KCkrMV0gPSB0YVxuICAgICAgICBAZGl2Lmluc2VydEJlZm9yZSB0Yi5kaXYsIHRhLmRpdlxuICAgIFxuICAgIG1vdmU6IChrZXkpIC0+XG4gICAgICAgIFxuICAgICAgICB0YWIgPSBAYWN0aXZlVGFiKClcbiAgICAgICAgc3dpdGNoIGtleVxuICAgICAgICAgICAgd2hlbiAnbGVmdCcgIHRoZW4gQHN3YXAgdGFiLCB0YWIucHJldigpIFxuICAgICAgICAgICAgd2hlbiAncmlnaHQnIHRoZW4gQHN3YXAgdGFiLCB0YWIubmV4dCgpXG4gICAgICAgIFxuICAgICMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAwICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgICAwMDAgMDAwICAgICAgMDAwICAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAwIDAwMCAgICAgMDAwICAgICAwMDAwMDAwICAgICAwMDAwMCAgICAgICAwMDAgICAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAgMDAwIDAwMCAgICAgIDAwMCAgICAgXG4gICAgIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiAgICBcbiAgICBvbkNvbnRleHRNZW51OiAoZXZlbnQpID0+IHN0b3BFdmVudCBldmVudCwgQHNob3dDb250ZXh0TWVudSBrcG9zIGV2ZW50XG4gICAgICAgICAgICAgIFxuICAgIHNob3dDb250ZXh0TWVudTogKGFic1BvcykgPT5cbiAgICAgICAgXG4gICAgICAgIGlmIHRhYiA9IEB0YWIgZXZlbnQudGFyZ2V0XG4gICAgICAgICAgICB0YWIuYWN0aXZhdGUoKVxuICAgICAgICAgICAgXG4gICAgICAgIGlmIG5vdCBhYnNQb3M/XG4gICAgICAgICAgICBhYnNQb3MgPSBrcG9zIEB2aWV3LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQsIEB2aWV3LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcFxuICAgICAgICBcbiAgICAgICAgb3B0ID0gaXRlbXM6IFsgXG4gICAgICAgICAgICB0ZXh0OiAgICdDbG9zZSBPdGhlciBUYWJzJ1xuICAgICAgICAgICAgY29tYm86ICAnY3RybCtzaGlmdCt3JyBcbiAgICAgICAgIyAsXG4gICAgICAgICAgICAjIHRleHQ6ICAgJ05ldyBXaW5kb3cnXG4gICAgICAgICAgICAjIGNvbWJvOiAgJ2N0cmwrc2hpZnQrbicgXG4gICAgICAgIF1cbiAgICAgICAgXG4gICAgICAgIG9wdC54ID0gYWJzUG9zLnhcbiAgICAgICAgb3B0LnkgPSBhYnNQb3MueVxuICAgICAgICBwb3B1cC5tZW51IG9wdCAgICAgICAgXG4gICAgICAgICAgICBcbm1vZHVsZS5leHBvcnRzID0gVGFic1xuIl19
//# sourceURL=../coffee/tabs.coffee