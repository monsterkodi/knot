// koffee 1.4.0

/*
000000000   0000000   0000000     0000000
   000     000   000  000   000  000     
   000     000000000  0000000    0000000 
   000     000   000  000   000       000
   000     000   000  0000000    0000000
 */
var $, Tab, Tabs, Term, _, drag, elem, empty, kpos, popup, post, ref, slash, stopEvent,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), post = ref.post, stopEvent = ref.stopEvent, empty = ref.empty, slash = ref.slash, popup = ref.popup, elem = ref.elem, drag = ref.drag, kpos = ref.kpos, $ = ref.$, _ = ref._;

Tab = require('./tab');

Term = require('./term');

Tabs = (function() {
    function Tabs(titlebar) {
        this.showContextMenu = bind(this.showContextMenu, this);
        this.onContextMenu = bind(this.onContextMenu, this);
        this.closeTabs = bind(this.closeTabs, this);
        this.onDragStop = bind(this.onDragStop, this);
        this.onDragMove = bind(this.onDragMove, this);
        this.onDragStart = bind(this.onDragStart, this);
        this.onClick = bind(this.onClick, this);
        this.restore = bind(this.restore, this);
        this.stash = bind(this.stash, this);
        this.tabs = [];
        this.div = elem({
            "class": 'tabs'
        });
        titlebar.insertBefore(this.div, $('.minimize'));
        this.div.addEventListener('click', this.onClick);
        this.div.addEventListener('contextmenu', this.onContextMenu);
        post.on('stash', this.stash);
        post.on('restore', this.restore);
        this.drag = new drag({
            target: this.div,
            onStart: this.onDragStart,
            onMove: this.onDragMove,
            onStop: this.onDragStop
        });
    }

    Tabs.prototype.stash = function() {
        var paths, ref1, tab;
        paths = (function() {
            var i, len, ref1, results;
            ref1 = this.tabs;
            results = [];
            for (i = 0, len = ref1.length; i < len; i++) {
                tab = ref1[i];
                results.push(tab.text);
            }
            return results;
        }).call(this);
        return window.stash.set('tabs', {
            paths: paths,
            active: Math.min((ref1 = this.activeTab()) != null ? ref1.index() : void 0, paths.length - 1)
        });
    };

    Tabs.prototype.restore = function() {
        var active, paths, ref1;
        active = window.stash.get('tabs:active', 0);
        paths = window.stash.get('tabs:paths');
        if (empty(paths)) {
            this.addTab(slash.tilde(process.cwd()));
            return;
        }
        while (paths.length) {
            this.addTab(paths.shift());
        }
        return (ref1 = this.tabs[active]) != null ? ref1.activate() : void 0;
    };

    Tabs.prototype.onClick = function(event) {
        var tab;
        if (tab = this.tab(event.target)) {
            if (event.target.classList.contains('dot')) {
                this.closeTab(tab);
            } else {
                tab.activate();
            }
        }
        return true;
    };

    Tabs.prototype.onDragStart = function(d, e) {
        var br;
        this.dragTab = this.tab(e.target);
        if (!this.dragTab) {
            return 'skip';
        }
        if (event.button !== 1) {
            return 'skip';
        }
        this.dragDiv = this.dragTab.div.cloneNode(true);
        this.dragTab.div.style.opacity = '0';
        br = this.dragTab.div.getBoundingClientRect();
        this.dragDiv.style.position = 'absolute';
        this.dragDiv.style.top = br.top + "px";
        this.dragDiv.style.left = br.left + "px";
        this.dragDiv.style.width = (br.width - 12) + "px";
        this.dragDiv.style.height = (br.height - 3) + "px";
        this.dragDiv.style.flex = 'unset';
        this.dragDiv.style.pointerEvents = 'none';
        return document.body.appendChild(this.dragDiv);
    };

    Tabs.prototype.onDragMove = function(d, e) {
        var tab;
        this.dragDiv.style.transform = "translateX(" + d.deltaSum.x + "px)";
        if (tab = this.tabAtX(d.pos.x)) {
            if (tab.index() !== this.dragTab.index()) {
                return this.swap(tab, this.dragTab);
            }
        }
    };

    Tabs.prototype.onDragStop = function(d, e) {
        this.dragTab.div.style.opacity = '';
        return this.dragDiv.remove();
    };

    Tabs.prototype.tab = function(id) {
        if (_.isNumber(id)) {
            return this.tabs[id];
        }
        if (_.isElement(id)) {
            return _.find(this.tabs, function(t) {
                return t.div.contains(id);
            });
        }
        if (_.isString(id)) {
            return _.find(this.tabs, function(t) {
                return t.info.text === id;
            });
        }
    };

    Tabs.prototype.activeTab = function() {
        return _.find(this.tabs, function(t) {
            return t.isActive();
        });
    };

    Tabs.prototype.numTabs = function() {
        return this.tabs.length;
    };

    Tabs.prototype.tabAtX = function(x) {
        return _.find(this.tabs, function(t) {
            var br;
            br = t.div.getBoundingClientRect();
            return (br.left <= x && x <= br.left + br.width);
        });
    };

    Tabs.prototype.resized = function() {
        var i, len, ref1, results, tab;
        ref1 = this.tabs;
        results = [];
        for (i = 0, len = ref1.length; i < len; i++) {
            tab = ref1[i];
            results.push(tab.term.resized());
        }
        return results;
    };

    Tabs.prototype.addTab = function(text) {
        var tab;
        tab = new Tab(this, new Term);
        tab.term.tab = tab;
        if (text) {
            tab.update(text);
        }
        this.tabs.push(tab);
        tab.activate();
        post.emit('menuAction', 'Clear');
        return tab;
    };

    Tabs.prototype.closeTab = function(tab) {
        var ref1;
        if (tab == null) {
            tab = this.activeTab();
        }
        if (tab == null) {
            return;
        }
        if (this.tabs.length > 1) {
            if (tab === this.activeTab()) {
                if ((ref1 = tab.nextOrPrev()) != null) {
                    ref1.activate();
                }
            }
        }
        tab.close();
        _.pull(this.tabs, tab);
        if (empty(this.tabs)) {
            post.emit('menuAction', 'Close');
        }
        return this;
    };

    Tabs.prototype.closeOtherTabs = function() {
        var keep;
        if (!this.activeTab()) {
            return;
        }
        keep = _.pullAt(this.tabs, this.activeTab().index());
        while (this.numTabs()) {
            this.tabs.pop().close();
        }
        return this.tabs = keep;
    };

    Tabs.prototype.closeTabs = function() {
        var results;
        results = [];
        while (this.numTabs()) {
            results.push(this.tabs.pop().close());
        }
        return results;
    };

    Tabs.prototype.navigate = function(key) {
        var index;
        index = this.activeTab().index();
        index += (function() {
            switch (key) {
                case 'left':
                    return -1;
                case 'right':
                    return +1;
            }
        })();
        index = (this.numTabs() + index) % this.numTabs();
        return this.tabs[index].activate();
    };

    Tabs.prototype.swap = function(ta, tb) {
        var ref1;
        if ((ta == null) || (tb == null)) {
            return;
        }
        if (ta.index() > tb.index()) {
            ref1 = [tb, ta], ta = ref1[0], tb = ref1[1];
        }
        this.tabs[ta.index()] = tb;
        this.tabs[tb.index() + 1] = ta;
        return this.div.insertBefore(tb.div, ta.div);
    };

    Tabs.prototype.move = function(key) {
        var tab;
        tab = this.activeTab();
        switch (key) {
            case 'left':
                return this.swap(tab, tab.prev());
            case 'right':
                return this.swap(tab, tab.next());
        }
    };

    Tabs.prototype.onContextMenu = function(event) {
        return stopEvent(event, this.showContextMenu(pos(event)));
    };

    Tabs.prototype.showContextMenu = function(absPos) {
        var opt, tab;
        if (tab = this.tab(event.target)) {
            tab.activate();
        }
        if (absPos == null) {
            absPos = kpos(this.view.getBoundingClientRect().left, this.view.getBoundingClientRect().top);
        }
        opt = {
            items: [
                {
                    text: 'Close Other Tabs',
                    combo: 'ctrl+shift+w'
                }
            ]
        };
        opt.x = absPos.x;
        opt.y = absPos.y;
        return popup.menu(opt);
    };

    return Tabs;

})();

module.exports = Tabs;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFicy5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUEsa0ZBQUE7SUFBQTs7QUFRQSxNQUFtRSxPQUFBLENBQVEsS0FBUixDQUFuRSxFQUFFLGVBQUYsRUFBUSx5QkFBUixFQUFtQixpQkFBbkIsRUFBMEIsaUJBQTFCLEVBQWlDLGlCQUFqQyxFQUF3QyxlQUF4QyxFQUE4QyxlQUE5QyxFQUFvRCxlQUFwRCxFQUEwRCxTQUExRCxFQUE2RDs7QUFFN0QsR0FBQSxHQUFPLE9BQUEsQ0FBUSxPQUFSOztBQUNQLElBQUEsR0FBTyxPQUFBLENBQVEsUUFBUjs7QUFFRDtJQUVDLGNBQUMsUUFBRDs7Ozs7Ozs7OztRQUVDLElBQUMsQ0FBQSxJQUFELEdBQVE7UUFDUixJQUFDLENBQUEsR0FBRCxHQUFPLElBQUEsQ0FBSztZQUFBLENBQUEsS0FBQSxDQUFBLEVBQU0sTUFBTjtTQUFMO1FBRVAsUUFBUSxDQUFDLFlBQVQsQ0FBc0IsSUFBQyxDQUFBLEdBQXZCLEVBQTRCLENBQUEsQ0FBRSxXQUFGLENBQTVCO1FBRUEsSUFBQyxDQUFBLEdBQUcsQ0FBQyxnQkFBTCxDQUFzQixPQUF0QixFQUFvQyxJQUFDLENBQUEsT0FBckM7UUFDQSxJQUFDLENBQUEsR0FBRyxDQUFDLGdCQUFMLENBQXNCLGFBQXRCLEVBQW9DLElBQUMsQ0FBQSxhQUFyQztRQUVBLElBQUksQ0FBQyxFQUFMLENBQVEsT0FBUixFQUFrQixJQUFDLENBQUEsS0FBbkI7UUFDQSxJQUFJLENBQUMsRUFBTCxDQUFRLFNBQVIsRUFBa0IsSUFBQyxDQUFBLE9BQW5CO1FBRUEsSUFBQyxDQUFBLElBQUQsR0FBUSxJQUFJLElBQUosQ0FDSjtZQUFBLE1BQUEsRUFBUyxJQUFDLENBQUEsR0FBVjtZQUNBLE9BQUEsRUFBUyxJQUFDLENBQUEsV0FEVjtZQUVBLE1BQUEsRUFBUyxJQUFDLENBQUEsVUFGVjtZQUdBLE1BQUEsRUFB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QWUsU0FBQyxLQUFEO2VBQVcsU0FBQSxDQUFVLEtBQVYsRUFBaUIsSUFBQyxDQUFBLGVBQUQsQ0FBaUIsR0FBQSxDQUFJLEtBQUosQ0FBakIsQ0FBakI7SUFBWDs7bUJBRWYsZUFBQSxHQUFpQixTQUFDLE1BQUQ7QUFFYixZQUFBO1FBQUEsSUFBRyxHQUFBLEdBQU0sSUFBQyxDQUFBLEdBQUQsQ0FBSyxLQUFLLENBQUMsTUFBWCxDQUFUO1lBQ0ksR0FBRyxDQUFDLFFBQUosQ0FBQSxFQURKOztRQUdBLElBQU8sY0FBUDtZQUNJLE1BQUEsR0FBUyxJQUFBLENBQUssSUFBQyxDQUFBLElBQUksQ0FBQyxxQkFBTixDQUFBLENBQTZCLENBQUMsSUFBbkMsRUFBeUMsSUFBQyxDQUFBLElBQUksQ0FBQyxxQkFBTixDQUFBLENBQTZCLENBQUMsR0FBdkUsRUFEYjs7UUFHQSxHQUFBLEdBQU07WUFBQSxLQUFBLEVBQU87Z0JBQ1Q7b0JBQUEsSUFBQSxFQUFRLGtCQUFSO29CQUNBLEtBQUEsRUFBUSxjQURSO2lCQURTO2FBQVA7O1FBUU4sR0FBRyxDQUFDLENBQUosR0FBUSxNQUFNLENBQUM7UUFDZixHQUFHLENBQUMsQ0FBSixHQUFRLE1BQU0sQ0FBQztlQUNmLEtBQUssQ0FBQyxJQUFOLENBQVcsR0FBWDtJQWxCYTs7Ozs7O0FBb0JyQixNQUFNLENBQUMsT0FBUCxHQUFpQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuMDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgIDAwMDAwMDBcbiAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgXG4gICAwMDAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwIFxuICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgICAwMDBcbiAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAgXG4jIyNcblxueyBwb3N0LCBzdG9wRXZlbnQsIGVtcHR5LCBzbGFzaCwgcG9wdXAsIGVsZW0sIGRyYWcsIGtwb3MsICQsIF8gfSA9IHJlcXVpcmUgJ2t4aydcblxuVGFiICA9IHJlcXVpcmUgJy4vdGFiJ1xuVGVybSA9IHJlcXVpcmUgJy4vdGVybSdcblxuY2xhc3MgVGFic1xuICAgIFxuICAgIEA6ICh0aXRsZWJhcikgLT5cbiAgICAgICAgXG4gICAgICAgIEB0YWJzID0gW11cbiAgICAgICAgQGRpdiA9IGVsZW0gY2xhc3M6J3RhYnMnXG4gICAgICAgIFxuICAgICAgICB0aXRsZWJhci5pbnNlcnRCZWZvcmUgQGRpdiwgJCAnLm1pbmltaXplJ1xuICAgICAgICBcbiAgICAgICAgQGRpdi5hZGRFdmVudExpc3RlbmVyICdjbGljaycgICAgICAgQG9uQ2xpY2tcbiAgICAgICAgQGRpdi5hZGRFdmVudExpc3RlbmVyICdjb250ZXh0bWVudScgQG9uQ29udGV4dE1lbnVcbiAgICAgICAgXG4gICAgICAgIHBvc3Qub24gJ3N0YXNoJyAgIEBzdGFzaFxuICAgICAgICBwb3N0Lm9uICdyZXN0b3JlJyBAcmVzdG9yZVxuICAgICAgICBcbiAgICAgICAgQGRyYWcgPSBuZXcgZHJhZ1xuICAgICAgICAgICAgdGFyZ2V0OiAgQGRpdlxuICAgICAgICAgICAgb25TdGFydDogQG9uRHJhZ1N0YXJ0XG4gICAgICAgICAgICBvbk1vdmU6ICBAb25EcmFnTW92ZVxuICAgICAgICAgICAgb25TdG9wOiAgQG9uRHJhZ1N0b3BcblxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgICAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgICAgICAwMDAgICAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMCAgXG5cbiAgICBzdGFzaDogPT4gXG5cbiAgICAgICAgcGF0aHMgPSAoIHRhYi50ZXh0IGZvciB0YWIgaW4gQHRhYnMgKVxuICAgICAgICBcbiAgICAgICAgd2luZG93LnN0YXNoLnNldCAndGFicycsIFxuICAgICAgICAgICAgcGF0aHM6ICBwYXRoc1xuICAgICAgICAgICAgYWN0aXZlOiBNYXRoLm1pbiBAYWN0aXZlVGFiKCk/LmluZGV4KCksIHBhdGhzLmxlbmd0aC0xXG4gICAgXG4gICAgcmVzdG9yZTogPT5cbiAgICAgICAgXG4gICAgICAgIGFjdGl2ZSA9IHdpbmRvdy5zdGFzaC5nZXQgJ3RhYnM6YWN0aXZlJyAwXG4gICAgICAgIHBhdGhzICA9IHdpbmRvdy5zdGFzaC5nZXQgJ3RhYnM6cGF0aHMnXG4gICAgICAgIFxuICAgICAgICBpZiBlbXB0eSBwYXRocyAjIGhhcHBlbnMgd2hlbiBmaXJzdCB3aW5kb3cgb3BlbnNcbiAgICAgICAgICAgIEBhZGRUYWIgc2xhc2gudGlsZGUgcHJvY2Vzcy5jd2QoKVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIFxuICAgICAgICB3aGlsZSBwYXRocy5sZW5ndGhcbiAgICAgICAgICAgIEBhZGRUYWIgcGF0aHMuc2hpZnQoKVxuICAgICAgICBcbiAgICAgICAgQHRhYnNbYWN0aXZlXT8uYWN0aXZhdGUoKVxuICAgICAgICAgICAgXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgICAgMDAwICAgMDAwMDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgMDAwICAgICAgIDAwMDAwMDAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwICAwMDAgICAgICAgMDAwICAwMDAgICBcbiAgICAjICAwMDAwMDAwICAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAwMDAgICAwMDAgIFxuICAgIFxuICAgIG9uQ2xpY2s6IChldmVudCkgPT5cbiAgICAgICAgXG4gICAgICAgIGlmIHRhYiA9IEB0YWIgZXZlbnQudGFyZ2V0XG4gICAgICAgICAgICBpZiBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zICdkb3QnXG4gICAgICAgICAgICAgICAgQGNsb3NlVGFiIHRhYlxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHRhYi5hY3RpdmF0ZSgpXG4gICAgICAgIHRydWVcblxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwMCAgICAwMDAwMDAwICAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMDAwICAwMDAgIDAwMDAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgXG4gICAgXG4gICAgb25EcmFnU3RhcnQ6IChkLCBlKSA9PiBcbiAgICAgICAgXG4gICAgICAgICMgaWYgZS5idXR0b24gPT0gMlxuICAgICAgICAgICAgIyBAY2xvc2VUYWIgQHRhYiBlLnRhcmdldFxuICAgICAgICAgICAgIyByZXR1cm4gJ3NraXAnXG4gICAgICAgICAgICBcbiAgICAgICAgQGRyYWdUYWIgPSBAdGFiIGUudGFyZ2V0XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gJ3NraXAnIGlmIG5vdCBAZHJhZ1RhYlxuICAgICAgICByZXR1cm4gJ3NraXAnIGlmIGV2ZW50LmJ1dHRvbiAhPSAxXG4gICAgICAgIFxuICAgICAgICBAZHJhZ0RpdiA9IEBkcmFnVGFiLmRpdi5jbG9uZU5vZGUgdHJ1ZVxuICAgICAgICBAZHJhZ1RhYi5kaXYuc3R5bGUub3BhY2l0eSA9ICcwJ1xuICAgICAgICBiciA9IEBkcmFnVGFiLmRpdi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgICBAZHJhZ0Rpdi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSdcbiAgICAgICAgQGRyYWdEaXYuc3R5bGUudG9wICA9IFwiI3tici50b3B9cHhcIlxuICAgICAgICBAZHJhZ0Rpdi5zdHlsZS5sZWZ0ID0gXCIje2JyLmxlZnR9cHhcIlxuICAgICAgICBAZHJhZ0Rpdi5zdHlsZS53aWR0aCA9IFwiI3tici53aWR0aC0xMn1weFwiXG4gICAgICAgIEBkcmFnRGl2LnN0eWxlLmhlaWdodCA9IFwiI3tici5oZWlnaHQtM31weFwiXG4gICAgICAgIEBkcmFnRGl2LnN0eWxlLmZsZXggPSAndW5zZXQnXG4gICAgICAgIEBkcmFnRGl2LnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSdcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCBAZHJhZ0RpdlxuXG4gICAgb25EcmFnTW92ZTogKGQsZSkgPT5cbiAgICAgICAgXG4gICAgICAgIEBkcmFnRGl2LnN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlWCgje2QuZGVsdGFTdW0ueH1weClcIlxuICAgICAgICBpZiB0YWIgPSBAdGFiQXRYIGQucG9zLnhcbiAgICAgICAgICAgIGlmIHRhYi5pbmRleCgpICE9IEBkcmFnVGFiLmluZGV4KClcbiAgICAgICAgICAgICAgICBAc3dhcCB0YWIsIEBkcmFnVGFiXG4gICAgICAgIFxuICAgIG9uRHJhZ1N0b3A6IChkLGUpID0+XG4gICAgICAgIFxuICAgICAgICBAZHJhZ1RhYi5kaXYuc3R5bGUub3BhY2l0eSA9ICcnXG4gICAgICAgIEBkcmFnRGl2LnJlbW92ZSgpXG5cbiAgICAjIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgIFxuICAgICMgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAgICAwMDAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgICBcbiAgICAjICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgXG4gICAgXG4gICAgdGFiOiAoaWQpIC0+XG4gICAgICAgIFxuICAgICAgICBpZiBfLmlzTnVtYmVyICBpZCB0aGVuIHJldHVybiBAdGFic1tpZF1cbiAgICAgICAgaWYgXy5pc0VsZW1lbnQgaWQgdGhlbiByZXR1cm4gXy5maW5kIEB0YWJzLCAodCkgLT4gdC5kaXYuY29udGFpbnMgaWRcbiAgICAgICAgaWYgXy5pc1N0cmluZyAgaWQgdGhlbiByZXR1cm4gXy5maW5kIEB0YWJzLCAodCkgLT4gdC5pbmZvLnRleHQgPT0gaWRcblxuICAgIGFjdGl2ZVRhYjogLT4gXy5maW5kIEB0YWJzLCAodCkgLT4gdC5pc0FjdGl2ZSgpXG4gICAgbnVtVGFiczogICAtPiBAdGFicy5sZW5ndGhcbiAgICBcbiAgICB0YWJBdFg6ICh4KSAtPiBcbiAgICAgICAgXG4gICAgICAgIF8uZmluZCBAdGFicywgKHQpIC0+IFxuICAgICAgICAgICAgYnIgPSB0LmRpdi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgICAgICAgYnIubGVmdCA8PSB4IDw9IGJyLmxlZnQgKyBici53aWR0aFxuXG4gICAgcmVzaXplZDogLT4gZm9yIHRhYiBpbiBAdGFicyB0aGVuIHRhYi50ZXJtLnJlc2l6ZWQoKVxuICAgICAgICAgIFxuICAgICMgIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuICAgICMgMDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAgIFxuICAgIFxuICAgIGFkZFRhYjogKHRleHQpIC0+XG4gICAgICAgIFxuICAgICAgICB0YWIgPSBuZXcgVGFiIEAsIG5ldyBUZXJtXG4gICAgICAgIHRhYi50ZXJtLnRhYiA9IHRhYlxuICAgICAgICBcbiAgICAgICAgaWYgdGV4dCB0aGVuIHRhYi51cGRhdGUgdGV4dFxuICAgICAgICAgICAgXG4gICAgICAgIEB0YWJzLnB1c2ggdGFiXG4gICAgICAgIHRhYi5hY3RpdmF0ZSgpXG4gICAgICAgIHBvc3QuZW1pdCAnbWVudUFjdGlvbicgJ0NsZWFyJ1xuICAgICAgICB0YWJcbiAgICAgICAgXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwICAgMDAwICAgICAgIDAwMCAgMDAwICAgICAgIFxuICAgICMgIDAwMDAwMDAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICBcbiAgICBcbiAgICBjbG9zZVRhYjogKHRhYiA9IEBhY3RpdmVUYWIoKSkgLT5cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBub3QgdGFiP1xuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICBpZiBAdGFicy5sZW5ndGggPiAxXG4gICAgICAgICAgICBpZiB0YWIgPT0gQGFjdGl2ZVRhYigpXG4gICAgICAgICAgICAgICAgdGFiLm5leHRPclByZXYoKT8uYWN0aXZhdGUoKVxuICAgICAgICAgICAgXG4gICAgICAgIHRhYi5jbG9zZSgpXG4gICAgICAgIFxuICAgICAgICBfLnB1bGwgQHRhYnMsIHRhYlxuICAgICAgICBcbiAgICAgICAgaWYgZW1wdHkgQHRhYnMgIyBjbG9zZSB0aGUgd2luZG93IHdoZW4gbGFzdCB0YWIgd2FzIGNsb3NlZFxuICAgICAgICAgICAgcG9zdC5lbWl0ICdtZW51QWN0aW9uJyAnQ2xvc2UnIFxuICAgICAgICBcbiAgICAgICAgQFxuICBcbiAgICBjbG9zZU90aGVyVGFiczogLT4gXG4gICAgICAgIFxuICAgICAgICByZXR1cm4gaWYgbm90IEBhY3RpdmVUYWIoKVxuICAgICAgICBrZWVwID0gXy5wdWxsQXQgQHRhYnMsIEBhY3RpdmVUYWIoKS5pbmRleCgpXG4gICAgICAgIHdoaWxlIEBudW1UYWJzKClcbiAgICAgICAgICAgIEB0YWJzLnBvcCgpLmNsb3NlKClcbiAgICAgICAgQHRhYnMgPSBrZWVwXG4gICAgXG4gICAgY2xvc2VUYWJzOiA9PlxuICAgICAgICBcbiAgICAgICAgd2hpbGUgQG51bVRhYnMoKVxuICAgICAgICAgICAgQHRhYnMucG9wKCkuY2xvc2UoKVxuICAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgIFxuICAgICMgMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgMCAwMDAgIDAwMDAwMDAwMCAgIDAwMCAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwMDAwMDAwICAgICAwMDAgICAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgMDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgICAgICAwICAgICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMCAgXG4gICAgXG4gICAgbmF2aWdhdGU6IChrZXkpIC0+XG4gICAgICAgIFxuICAgICAgICBpbmRleCA9IEBhY3RpdmVUYWIoKS5pbmRleCgpXG4gICAgICAgIGluZGV4ICs9IHN3aXRjaCBrZXlcbiAgICAgICAgICAgIHdoZW4gJ2xlZnQnIHRoZW4gLTFcbiAgICAgICAgICAgIHdoZW4gJ3JpZ2h0JyB0aGVuICsxXG4gICAgICAgIGluZGV4ID0gKEBudW1UYWJzKCkgKyBpbmRleCkgJSBAbnVtVGFicygpXG4gICAgICAgIEB0YWJzW2luZGV4XS5hY3RpdmF0ZSgpXG5cbiAgICBzd2FwOiAodGEsIHRiKSAtPlxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGlmIG5vdCB0YT8gb3Igbm90IHRiP1xuICAgICAgICBbdGEsIHRiXSA9IFt0YiwgdGFdIGlmIHRhLmluZGV4KCkgPiB0Yi5pbmRleCgpXG4gICAgICAgIEB0YWJzW3RhLmluZGV4KCldICAgPSB0YlxuICAgICAgICBAdGFic1t0Yi5pbmRleCgpKzFdID0gdGFcbiAgICAgICAgQGRpdi5pbnNlcnRCZWZvcmUgdGIuZGl2LCB0YS5kaXZcbiAgICBcbiAgICBtb3ZlOiAoa2V5KSAtPlxuICAgICAgICBcbiAgICAgICAgdGFiID0gQGFjdGl2ZVRhYigpXG4gICAgICAgIHN3aXRjaCBrZXlcbiAgICAgICAgICAgIHdoZW4gJ2xlZnQnICB0aGVuIEBzd2FwIHRhYiwgdGFiLnByZXYoKSBcbiAgICAgICAgICAgIHdoZW4gJ3JpZ2h0JyB0aGVuIEBzd2FwIHRhYiwgdGFiLm5leHQoKVxuICAgICAgICBcbiAgICAjICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAgMDAwIDAwMCAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgMCAwMDAgICAgIDAwMCAgICAgMDAwMDAwMCAgICAgMDAwMDAgICAgICAgMDAwICAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgIDAwMCAwMDAgICAgICAwMDAgICAgIFxuICAgICMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMDAwMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgXG4gICAgXG4gICAgb25Db250ZXh0TWVudTogKGV2ZW50KSA9PiBzdG9wRXZlbnQgZXZlbnQsIEBzaG93Q29udGV4dE1lbnUgcG9zIGV2ZW50XG4gICAgICAgICAgICAgIFxuICAgIHNob3dDb250ZXh0TWVudTogKGFic1BvcykgPT5cbiAgICAgICAgXG4gICAgICAgIGlmIHRhYiA9IEB0YWIgZXZlbnQudGFyZ2V0XG4gICAgICAgICAgICB0YWIuYWN0aXZhdGUoKVxuICAgICAgICAgICAgXG4gICAgICAgIGlmIG5vdCBhYnNQb3M/XG4gICAgICAgICAgICBhYnNQb3MgPSBrcG9zIEB2aWV3LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQsIEB2aWV3LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcFxuICAgICAgICBcbiAgICAgICAgb3B0ID0gaXRlbXM6IFsgXG4gICAgICAgICAgICB0ZXh0OiAgICdDbG9zZSBPdGhlciBUYWJzJ1xuICAgICAgICAgICAgY29tYm86ICAnY3RybCtzaGlmdCt3JyBcbiAgICAgICAgIyAsXG4gICAgICAgICAgICAjIHRleHQ6ICAgJ05ldyBXaW5kb3cnXG4gICAgICAgICAgICAjIGNvbWJvOiAgJ2N0cmwrc2hpZnQrbicgXG4gICAgICAgIF1cbiAgICAgICAgXG4gICAgICAgIG9wdC54ID0gYWJzUG9zLnhcbiAgICAgICAgb3B0LnkgPSBhYnNQb3MueVxuICAgICAgICBwb3B1cC5tZW51IG9wdCAgICAgICAgXG4gICAgICAgICAgICBcbm1vZHVsZS5leHBvcnRzID0gVGFic1xuIl19
//# sourceURL=../coffee/tabs.coffee