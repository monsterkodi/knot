
/*
00     00   0000000   00000000          0000000   0000000  00000000    0000000   000      000    
000   000  000   000  000   000        000       000       000   000  000   000  000      000    
000000000  000000000  00000000         0000000   000       0000000    000   000  000      000    
000 0 000  000   000  000                   000  000       000   000  000   000  000      000    
000   000  000   000  000              0000000    0000000  000   000   0000000   0000000  0000000
 */
var MapScroll, clamp, events, log,
  bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
  extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
  hasProp = {}.hasOwnProperty;

clamp = require('kxk').clamp;

log = console.log;

events = require('events');

MapScroll = (function(superClass) {
  extend(MapScroll, superClass);

  function MapScroll(cfg) {
    this.setLineHeight = bind(this.setLineHeight, this);
    this.setNumLines = bind(this.setNumLines, this);
    this.setViewHeight = bind(this.setViewHeight, this);
    this.deleteLine = bind(this.deleteLine, this);
    this.insertLine = bind(this.insertLine, this);
    this.setTop = bind(this.setTop, this);
    this.by = bind(this.by, this);
    this.to = bind(this.to, this);
    this.reset = bind(this.reset, this);
    var ref, ref1, ref2, ref3;
    MapScroll.__super__.constructor.call(this);
    this.lineHeight = (ref = cfg.lineHeight) != null ? ref : 0;
    this.viewHeight = (ref1 = cfg.viewHeight) != null ? ref1 : 0;
    this.exposeMax = (ref2 = cfg.exposeMax) != null ? ref2 : -4;
    this.smooth = (ref3 = cfg.smooth) != null ? ref3 : true;
    this.init();
  }

  MapScroll.prototype.init = function() {
    this.scroll = 0;
    this.offsetTop = 0;
    this.offsetSmooth = 0;
    this.fullHeight = 0;
    this.numLines = 0;
    this.top = 0;
    this.bot = 0;
    this.exposed = 0;
    this.exposeTop = 0;
    this.exposeBot = -1;
    this.calc();
    return this.offsetTop = -1;
  };

  MapScroll.prototype.calc = function() {
    this.scrollMax = Math.max(0, this.fullHeight - this.viewHeight);
    this.fullLines = Math.floor(this.viewHeight / this.lineHeight);
    this.viewLines = Math.ceil(this.viewHeight / this.lineHeight);
    this.linesHeight = this.viewLines * this.lineHeight;
    if (this.exposeMax < 0) {
      this.exposeNum = -this.exposeMax * this.viewLines;
    } else {
      this.exposeNum = this.exposeMax;
    }
    return this.exposeHeight = this.exposeNum * this.lineHeight;
  };

  MapScroll.prototype.info = function() {
    return {
      topbot: this.top + " .. " + this.bot + " = " + (this.bot - this.top) + " / " + this.numLines + " lines",
      expose: this.exposeTop + " .. " + this.exposeBot + " = " + (this.exposeBot - this.exposeTop) + " / " + this.exposeNum + " px " + this.exposeHeight,
      scroll: this.scroll + " offsetTop " + this.offsetTop + " scrollMax " + this.scrollMax + " fullLines " + this.fullLines + " viewLines " + this.viewLines + " viewHeight " + this.viewHeight
    };
  };

  MapScroll.prototype.reset = function() {
    this.emit('clearLines');
    return this.init();
  };

  MapScroll.prototype.to = function(p) {
    return this.by(p - this.scroll);
  };

  MapScroll.prototype.by = function(delta) {
    var offset, scroll, top;
    scroll = this.scroll;
    if (Number.isNaN(delta)) {
      delta = 0;
    }
    this.scroll = parseInt(clamp(0, this.scrollMax, this.scroll + delta));
    top = parseInt(this.scroll / this.lineHeight);
    this.offsetSmooth = this.scroll - top * this.lineHeight;
    this.setTop(top);
    offset = 0;
    if (this.smooth) {
      offset += this.offsetSmooth;
    }
    offset += (top - this.exposeTop) * this.lineHeight;
    if (offset !== this.offsetTop || scroll !== this.scroll) {
      this.offsetTop = parseInt(offset);
      return this.emit('scroll', this.scroll, this.offsetTop);
    }
  };

  MapScroll.prototype.resetTop = function() {
    var num;
    this.emit('clearLines');
    this.exposeTop = this.top;
    this.exposeBot = this.bot;
    num = this.bot - this.top + 1;
    if (num > 0) {
      this.emit('exposeLines', {
        top: this.top,
        bot: this.bot,
        num: num
      });
      return this.emit('scroll', this.scroll, this.offsetTop);
    }
  };

  MapScroll.prototype.setTop = function(top) {
    var n, num, oldBot, oldTop;
    if (this.exposeBot < 0 && this.numLines < 1) {
      return;
    }
    oldTop = this.top;
    oldBot = this.bot;
    this.top = top;
    this.bot = Math.min(this.top + this.viewLines, this.numLines - 1);
    if (oldTop === this.top && oldBot === this.bot && this.exposeBot >= this.bot) {
      return;
    }
    if ((this.top >= this.exposeBot) || (this.bot <= this.exposeTop)) {
      this.resetTop();
      return;
    }
    if (this.top < this.exposeTop) {
      oldTop = this.exposeTop;
      this.exposeTop = Math.max(0, this.top - (Math.min(this.viewLines, this.exposeNum - this.viewLines)));
      num = oldTop - this.exposeTop;
      if (num > 0) {
        this.emit('exposeLines', {
          top: this.exposeTop,
          bot: oldTop - 1,
          num: num
        });
      }
    }
    while (this.bot > this.exposeBot) {
      this.exposeBot += 1;
      this.emit('exposeLine', this.exposeBot);
    }
    if (this.exposeBot - this.exposeTop + 1 > this.exposeNum) {
      num = this.exposeBot - this.exposeTop + 1 - this.exposeNum;
      if (this.top > oldTop) {
        return this.resetTop();
      } else {
        n = clamp(0, this.exposeBot - this.bot, num);
        this.exposeBot -= n;
        return this.emit('vanishLines', {
          bot: n
        });
      }
    }
  };

  MapScroll.prototype.insertLine = function(li, oi) {
    if (this.lineIndexIsInExpose(oi)) {
      this.exposeBot += 1;
    }
    if (this.lineIndexIsInView(oi)) {
      this.bot += 1;
    }
    if (oi < this.top) {
      this.top += 1;
    }
    this.numLines += 1;
    this.fullHeight = this.numLines * this.lineHeight;
    return this.calc();
  };

  MapScroll.prototype.deleteLine = function(li, oi) {
    if (this.lineIndexIsInExpose(oi) || this.numLines < this.exposeNum) {
      this.exposeBot -= 1;
    }
    if (this.lineIndexIsInView(oi)) {
      return this.bot -= 1;
    }
  };

  MapScroll.prototype.lineIndexIsInView = function(li) {
    if ((this.top <= li && li <= this.bot)) {
      return true;
    }
    return this.bot - this.top + 1 < this.fullLines;
  };

  MapScroll.prototype.lineIndexIsInExpose = function(li) {
    if ((this.exposeTop <= li && li <= this.exposeBot)) {
      return true;
    }
    return this.exposeBot - this.exposeTop + 1 < this.exposeNum;
  };

  MapScroll.prototype.setViewHeight = function(h) {
    if (Number.isNaN(h)) {
      return;
    }
    if (this.viewHeight !== h) {
      this.viewHeight = h;
      this.calc();
      return this.by(0);
    }
  };

  MapScroll.prototype.setNumLines = function(n) {
    if (Number.isNaN(n)) {
      return;
    }
    if (this.numLines !== n) {
      this.numLines = n;
      this.fullHeight = this.numLines * this.lineHeight;
      if (this.numLines) {
        this.calc();
        return this.by(0);
      } else {
        this.init();
        return this.emit('clearLines');
      }
    }
  };

  MapScroll.prototype.setLineHeight = function(h) {
    if (Number.isNaN(h)) {
      return;
    }
    if (this.lineHeight !== h) {
      this.lineHeight = h;
      this.fullHeight = this.numLines * this.lineHeight;
      this.calc();
      return this.by(0);
    }
  };

  return MapScroll;

})(events);

module.exports = MapScroll;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFwc2Nyb2xsLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7QUFBQSxJQUFBLDZCQUFBO0VBQUE7Ozs7QUFRRSxRQUFVLE9BQUEsQ0FBUSxLQUFSOztBQUVaLEdBQUEsR0FBUyxPQUFPLENBQUM7O0FBQ2pCLE1BQUEsR0FBUyxPQUFBLENBQVEsUUFBUjs7QUFFSDs7O0VBRVcsbUJBQUMsR0FBRDs7Ozs7Ozs7OztBQUVULFFBQUE7SUFBQSx5Q0FBQTtJQUNBLElBQUMsQ0FBQSxVQUFELDBDQUErQjtJQUMvQixJQUFDLENBQUEsVUFBRCw0Q0FBK0I7SUFDL0IsSUFBQyxDQUFBLFNBQUQsMkNBQThCLENBQUM7SUFDL0IsSUFBQyxDQUFBLE1BQUQsd0NBQTJCO0lBQzNCLElBQUMsQ0FBQSxJQUFELENBQUE7RUFQUzs7c0JBZWIsSUFBQSxHQUFNLFNBQUE7SUFDRixJQUFDLENBQUEsTUFBRCxHQUFpQjtJQUNqQixJQUFDLENBQUEsU0FBRCxHQUFpQjtJQUNqQixJQUFDLENBQUEsWUFBRCxHQUFpQjtJQUNqQixJQUFDLENBQUEsVUFBRCxHQUFpQjtJQUNqQixJQUFDLENBQUEsUUFBRCxHQUFpQjtJQUNqQixJQUFDLENBQUEsR0FBRCxHQUFpQjtJQUNqQixJQUFDLENBQUEsR0FBRCxHQUFpQjtJQUNqQixJQUFDLENBQUEsT0FBRCxHQUFpQjtJQUNqQixJQUFDLENBQUEsU0FBRCxHQUFpQjtJQUNqQixJQUFDLENBQUEsU0FBRCxHQUFnQixDQUFDO0lBQ2pCLElBQUMsQ0FBQSxJQUFELENBQUE7V0FDQSxJQUFDLENBQUEsU0FBRCxHQUFnQixDQUFDO0VBWmY7O3NCQWNOLElBQUEsR0FBTSxTQUFBO0lBQ0YsSUFBQyxDQUFBLFNBQUQsR0FBZSxJQUFJLENBQUMsR0FBTCxDQUFTLENBQVQsRUFBVyxJQUFDLENBQUEsVUFBRCxHQUFjLElBQUMsQ0FBQSxVQUExQjtJQUNmLElBQUMsQ0FBQSxTQUFE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QUFBLElBQUQsQ0FBTSxZQUFOLEVBTEo7T0FISjs7RUFIUzs7c0JBbUJiLGFBQUEsR0FBZSxTQUFDLENBQUQ7SUFFWCxJQUFVLE1BQU0sQ0FBQyxLQUFQLENBQWEsQ0FBYixDQUFWO0FBQUEsYUFBQTs7SUFDQSxJQUFHLElBQUMsQ0FBQSxVQUFELEtBQWUsQ0FBbEI7TUFDSSxJQUFDLENBQUEsVUFBRCxHQUFjO01BQ2QsSUFBQyxDQUFBLFVBQUQsR0FBYyxJQUFDLENBQUEsUUFBRCxHQUFZLElBQUMsQ0FBQTtNQUMzQixJQUFDLENBQUEsSUFBRCxDQUFBO2FBQ0EsSUFBQyxDQUFBLEVBQUQsQ0FBSSxDQUFKLEVBSko7O0VBSFc7Ozs7R0ExTks7O0FBbU94QixNQUFNLENBQUMsT0FBUCxHQUFpQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgICAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgICAgMDAwICAgIFxuMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgICAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgIFxuMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwICAgICAgICAgMDAwMDAwMCAgIDAwMCAgICAgICAwMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgIFxuMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAgICAgICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgIFxuMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgMDAwMDAwMFxuIyMjXG5cbnsgY2xhbXAgfSA9IHJlcXVpcmUgJ2t4aydcblxubG9nICAgID0gY29uc29sZS5sb2cgXG5ldmVudHMgPSByZXF1aXJlICdldmVudHMnXG5cbmNsYXNzIE1hcFNjcm9sbCBleHRlbmRzIGV2ZW50c1xuXG4gICAgY29uc3RydWN0b3I6IChjZmcpIC0+XG5cbiAgICAgICAgc3VwZXIoKVxuICAgICAgICBAbGluZUhlaWdodCA9IGNmZy5saW5lSGVpZ2h0ID8gMFxuICAgICAgICBAdmlld0hlaWdodCA9IGNmZy52aWV3SGVpZ2h0ID8gMFxuICAgICAgICBAZXhwb3NlTWF4ICA9IGNmZy5leHBvc2VNYXggPyAtNCAjIDwwOiAtdiAqIHZpZXdMaW5lcyB8IDA6IHVubGltaXRlZCB8ID4wOiB2ICogMVxuICAgICAgICBAc21vb3RoICAgICA9IGNmZy5zbW9vdGggPyB0cnVlXG4gICAgICAgIEBpbml0KClcbiAgICAgICAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwMDBcbiAgICAjIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwICAwMDAgMCAwMDAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAwMDAgICAgIDAwMCAgIFxuXG4gICAgaW5pdDogLT5cbiAgICAgICAgQHNjcm9sbCAgICAgICA9ICAwICMgY3VycmVudCBzY3JvbGwgdmFsdWUgZnJvbSBkb2N1bWVudCBzdGFydCAocGl4ZWxzKVxuICAgICAgICBAb2Zmc2V0VG9wICAgID0gIDAgIyBoZWlnaHQgb2YgdmlldyBhYm92ZSBmaXJzdCB2aXNpYmxlIGxpbmUgKHBpeGVscylcbiAgICAgICAgQG9mZnNldFNtb290aCA9ICAwICMgc21vb3RoIHNjcm9sbGluZyBvZmZzZXQgLyBwYXJ0IG9mIHRvcCBsaW5lIHRoYXQgaXMgaGlkZGVuIChwaXhlbHMpXG4gICAgICAgIEBmdWxsSGVpZ2h0ICAgPSAgMCAjIHRvdGFsIGhlaWdodCBvZiBidWZmZXIgKHBpeGVscylcbiAgICAgICAgQG51bUxpbmVzICAgICA9ICAwICMgdG90YWwgbnVtYmVyIG9mIGxpbmVzIGluIGJ1ZmZlclxuICAgICAgICBAdG9wICAgICAgICAgID0gIDAgIyBpbmRleCBvZiBmaXJzdCB2aXNpYmxlIGxpbmUgaW4gdmlld1xuICAgICAgICBAYm90ICAgICAgICAgID0gIDAgIyBpbmRleCBvZiBsYXN0ICB2aXNpYmxlIGxpbmUgaW4gdmlld1xuICAgICAgICBAZXhwb3NlZCAgICAgID0gIDAgIyBudW1iZXIgb2YgY3VycmVudGx5IGV4cG9zZWQgbGluZXNcbiAgICAgICAgQGV4cG9zZVRvcCAgICA9ICAwICMgaW5kZXggb2YgdG9wbW9zdCBsaW5lIGluIHZpZXcgKGFsd2F5cyA8PSBAdG9wKVxuICAgICAgICBAZXhwb3NlQm90ICAgID0gLTEgIyBpbmRleCBvZiBib3R0b20gbGluZSBpbiB2aWV3IChhbHdheXMgPj0gQGJvdClcbiAgICAgICAgQGNhbGMoKVxuICAgICAgICBAb2Zmc2V0VG9wICAgID0gLTEgIyBoYWNrIHRvIGVtaXQgaW5pdGlhbCBzY3JvbGxcblxuICAgIGNhbGM6IC0+XG4gICAgICAgIEBzY3JvbGxNYXggICA9IE1hdGgubWF4KDAsQGZ1bGxIZWlnaHQgLSBAdmlld0hlaWdodCkgICMgbWF4aW11bSBzY3JvbGwgb2Zmc2V0IChwaXhlbHMpXG4gICAgICAgIEBmdWxsTGluZXMgICA9IE1hdGguZmxvb3IoQHZpZXdIZWlnaHQgLyBAbGluZUhlaWdodCkgICMgbnVtYmVyIG9mIGxpbmVzIGluIHZpZXcgKGV4Y2x1ZGluZyBwYXJ0aWFscylcbiAgICAgICAgQHZpZXdMaW5lcyAgID0gTWF0aC5jZWlsKEB2aWV3SGVpZ2h0IC8gQGxpbmVIZWlnaHQpICAgIyBudW1iZXIgb2YgbGluZXMgaW4gdmlldyAoaW5jbHVkaW5nIHBhcnRpYWxzKVxuICAgICAgICBAbGluZXNIZWlnaHQgPSBAdmlld0xpbmVzICogQGxpbmVIZWlnaHQgICAgICAgICAgICAgICAjIGhlaWdodCBvZiB2aXNpYmxlIGxpbmVzIChwaXhlbHMpXG5cbiAgICAgICAgaWYgQGV4cG9zZU1heCA8IDBcbiAgICAgICAgICAgIEBleHBvc2VOdW0gPSAtQGV4cG9zZU1heCAqIEB2aWV3TGluZXMgIyBtYXhpbXVtIHNpemUgb2YgZXhwb3NlIHJhbmdlIGlzIHZpZXdIZWlnaHQgZGVwZW5kZW50XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIEBleHBvc2VOdW0gPSBAZXhwb3NlTWF4XG4gICAgICAgICAgICBcbiAgICAgICAgQGV4cG9zZUhlaWdodCA9IEBleHBvc2VOdW0gKiBAbGluZUhlaWdodFxuXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwIFxuICAgICMgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDBcbiAgICAjIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwMDAwMCBcbiAgICBcbiAgICBpbmZvOiAtPlxuICAgICAgICB0b3Bib3Q6IFwiI3tAdG9wfSAuLiAje0Bib3R9ID0gI3tAYm90LUB0b3B9IC8gI3tAbnVtTGluZXN9IGxpbmVzXCJcbiAgICAgICAgZXhwb3NlOiBcIiN7QGV4cG9zZVRvcH0gLi4gI3tAZXhwb3NlQm90fSA9ICN7QGV4cG9zZUJvdC1AZXhwb3NlVG9wfSAvICN7QGV4cG9zZU51bX0gcHggI3tAZXhwb3NlSGVpZ2h0fVwiXG4gICAgICAgIHNjcm9sbDogXCIje0BzY3JvbGx9IG9mZnNldFRvcCAje0BvZmZzZXRUb3B9IHNjcm9sbE1heCAje0BzY3JvbGxNYXh9IGZ1bGxMaW5lcyAje0BmdWxsTGluZXN9IHZpZXdMaW5lcyAje0B2aWV3TGluZXN9IHZpZXdIZWlnaHQgI3tAdmlld0hlaWdodH1cIlxuICAgICAgICBcbiAgICAjIDAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgICAgICAgIDAwMCAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgICAwMDAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgICAgICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwICAgMDAwMDAwMDAgICAgIDAwMCAgIFxuICAgIFxuICAgIHJlc2V0OiA9PlxuICAgICAgICBAZW1pdCAnY2xlYXJMaW5lcydcbiAgICAgICAgQGluaXQoKVxuXG4gICAgIyAwMDAwMDAwMDAgICAwMDAwMDAwIFxuICAgICMgICAgMDAwICAgICAwMDAgICAwMDBcbiAgICAjICAgIDAwMCAgICAgMDAwICAgMDAwXG4gICAgIyAgICAwMDAgICAgIDAwMCAgIDAwMFxuICAgICMgICAgMDAwICAgICAgMDAwMDAwMCBcbiAgICBcbiAgICB0bzogKHApID0+IEBieSBwLUBzY3JvbGxcbiAgICAgICAgXG4gICAgIyAwMDAwMDAwICAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAgMDAwICAgMDAwIDAwMCBcbiAgICAjIDAwMDAwMDAgICAgICAwMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwMDAwMCAgICAgICAwMDAgICBcbiAgICAgICAgXG4gICAgYnk6IChkZWx0YSkgPT5cblxuICAgICAgICBzY3JvbGwgPSBAc2Nyb2xsXG4gICAgICAgIGRlbHRhID0gMCBpZiBOdW1iZXIuaXNOYU4gZGVsdGFcbiAgICAgICAgQHNjcm9sbCA9IHBhcnNlSW50IGNsYW1wIDAsIEBzY3JvbGxNYXgsIEBzY3JvbGwrZGVsdGFcbiAgICAgICAgdG9wID0gcGFyc2VJbnQgQHNjcm9sbCAvIEBsaW5lSGVpZ2h0XG4gICAgICAgIEBvZmZzZXRTbW9vdGggPSBAc2Nyb2xsIC0gdG9wICogQGxpbmVIZWlnaHQgXG4gICAgICAgIFxuICAgICAgICBAc2V0VG9wIHRvcFxuXG4gICAgICAgIG9mZnNldCA9IDBcbiAgICAgICAgb2Zmc2V0ICs9IEBvZmZzZXRTbW9vdGggaWYgQHNtb290aFxuICAgICAgICBvZmZzZXQgKz0gKHRvcCAtIEBleHBvc2VUb3ApICogQGxpbmVIZWlnaHRcbiAgICAgICAgXG4gICAgICAgIGlmIG9mZnNldCAhPSBAb2Zmc2V0VG9wIG9yIHNjcm9sbCAhPSBAc2Nyb2xsXG4gICAgICAgICAgICBAb2Zmc2V0VG9wID0gcGFyc2VJbnQgb2Zmc2V0XG4gICAgICAgICAgICBAZW1pdCAnc2Nyb2xsJywgQHNjcm9sbCwgQG9mZnNldFRvcFxuXG4gICAgIyAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwICAgICAgMDAwICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgXG4gICAgIyAgICAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgIFxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAwICAgICAwMDAgICAgICAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAgICAgICBcbiAgICAgICAgICAgIFxuICAgIHJlc2V0VG9wOiAtPlxuICAgICAgICBcbiAgICAgICAgQGVtaXQgJ2NsZWFyTGluZXMnXG4gICAgICAgIEBleHBvc2VUb3AgPSBAdG9wXG4gICAgICAgIEBleHBvc2VCb3QgPSBAYm90XG4gICAgICAgIG51bSA9IEBib3QgLSBAdG9wICsgMVxuICAgICAgICBpZiBudW0gPiAwXG4gICAgICAgICAgICBAZW1pdCAnZXhwb3NlTGluZXMnLCB0b3A6QHRvcCwgYm90OkBib3QsIG51bTogbnVtXG4gICAgICAgICAgICBAZW1pdCAnc2Nyb2xsJywgQHNjcm9sbCwgQG9mZnNldFRvcFxuICAgIFxuICAgIHNldFRvcDogKHRvcCkgPT5cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBAZXhwb3NlQm90IDwgMCBhbmQgQG51bUxpbmVzIDwgMVxuICAgICAgICBcbiAgICAgICAgb2xkVG9wID0gQHRvcFxuICAgICAgICBvbGRCb3QgPSBAYm90XG4gICAgICAgIEB0b3AgPSB0b3BcbiAgICAgICAgQGJvdCA9IE1hdGgubWluIEB0b3ArQHZpZXdMaW5lcywgQG51bUxpbmVzLTFcbiAgICAgICAgcmV0dXJuIGlmIG9sZFRvcCA9PSBAdG9wIGFuZCBvbGRCb3QgPT0gQGJvdCBhbmQgQGV4cG9zZUJvdCA+PSBAYm90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICBpZiAoQHRvcCA+PSBAZXhwb3NlQm90KSBvciAoQGJvdCA8PSBAZXhwb3NlVG9wKSAjIG5ldyByYW5nZSBvdXRzaWRlLCBzdGFydCBmcm9tIHNjcmF0Y2hcbiAgICAgICAgICAgIEByZXNldFRvcCgpXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgXG4gICAgICAgIGlmIEB0b3AgPCBAZXhwb3NlVG9wXG4gICAgICAgICAgICBvbGRUb3AgPSBAZXhwb3NlVG9wXG4gICAgICAgICAgICBAZXhwb3NlVG9wID0gTWF0aC5tYXggMCwgQHRvcCAtIChNYXRoLm1pbiBAdmlld0xpbmVzLCBAZXhwb3NlTnVtIC0gQHZpZXdMaW5lcylcbiAgICAgICAgICAgIG51bSA9IG9sZFRvcCAtIEBleHBvc2VUb3BcbiAgICAgICAgICAgIGlmIG51bSA+IDBcbiAgICAgICAgICAgICAgICBAZW1pdCAnZXhwb3NlTGluZXMnLCB0b3A6QGV4cG9zZVRvcCwgYm90Om9sZFRvcC0xLCBudW06IG51bVxuICAgICAgICAgICAgICAgIFxuICAgICAgICB3aGlsZSBAYm90ID4gQGV4cG9zZUJvdFxuICAgICAgICAgICAgQGV4cG9zZUJvdCArPSAxXG4gICAgICAgICAgICBAZW1pdCAnZXhwb3NlTGluZScsIEBleHBvc2VCb3RcbiAgICAgICAgICAgIFxuICAgICAgICBpZiBAZXhwb3NlQm90LUBleHBvc2VUb3ArMSA+IEBleHBvc2VOdW0gXG4gICAgICAgICAgICBudW0gID0gQGV4cG9zZUJvdC1AZXhwb3NlVG9wKzEgLSBAZXhwb3NlTnVtXG4gICAgICAgICAgICBpZiBAdG9wPm9sZFRvcFxuICAgICAgICAgICAgICAgIEByZXNldFRvcCgpXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgbiA9IGNsYW1wIDAsIEBleHBvc2VCb3QtQGJvdCwgbnVtXG4gICAgICAgICAgICAgICAgQGV4cG9zZUJvdCAtPSBuXG4gICAgICAgICAgICAgICAgQGVtaXQgJ3ZhbmlzaExpbmVzJywgYm90OiBuXG4gICAgICAgICAgICAgICAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAwMFxuICAgICMgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgICAgMDAwICAgXG4gICAgIyAwMDAgIDAwMCAgMDAwMCAgICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwICAgMDAwICAgICAwMDAgICBcbiAgICBcbiAgICBpbnNlcnRMaW5lOiAobGksb2kpID0+XG4gICAgICAgIEBleHBvc2VCb3QgKz0gMSBpZiBAbGluZUluZGV4SXNJbkV4cG9zZSBvaVxuICAgICAgICBAYm90ICAgICAgICs9IDEgaWYgQGxpbmVJbmRleElzSW5WaWV3IG9pXG4gICAgICAgIEB0b3AgICAgICAgKz0gMSBpZiBvaSA8IEB0b3BcbiAgICAgICAgQG51bUxpbmVzICArPSAxXG4gICAgICAgIEBmdWxsSGVpZ2h0ID0gQG51bUxpbmVzICogQGxpbmVIZWlnaHRcbiAgICAgICAgQGNhbGMoKVxuICAgICAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMCAgICAgIDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwICAgMDAwICAgICAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMCBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwMFxuXG4gICAgZGVsZXRlTGluZTogKGxpLG9pKSA9PlxuICAgICAgICBAZXhwb3NlQm90IC09IDEgaWYgQGxpbmVJbmRleElzSW5FeHBvc2Uob2kpIG9yIEBudW1MaW5lcyA8IEBleHBvc2VOdW1cbiAgICAgICAgQGJvdCAgICAgICAtPSAxIGlmIEBsaW5lSW5kZXhJc0luVmlldyBvaVxuICAgIFxuICAgIGxpbmVJbmRleElzSW5WaWV3OiAobGkpIC0+IFxuICAgICAgICByZXR1cm4gdHJ1ZSBpZiBAdG9wIDw9IGxpIDw9IEBib3RcbiAgICAgICAgcmV0dXJuIEBib3QtQHRvcCsxIDwgQGZ1bGxMaW5lc1xuICAgICAgICBcbiAgICBsaW5lSW5kZXhJc0luRXhwb3NlOiAobGkpIC0+XG4gICAgICAgIHJldHVybiB0cnVlIGlmIEBleHBvc2VUb3AgPD0gbGkgPD0gQGV4cG9zZUJvdCBcbiAgICAgICAgcmV0dXJuIEBleHBvc2VCb3QtQGV4cG9zZVRvcCsxIDwgQGV4cG9zZU51bVxuICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgICAgICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgIDAwMCAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwMDAgICAgIDAwMCAgIFxuICAgICMgICAgMDAwICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgICAgIDAgICAgICAwMDAgIDAwMDAwMDAwICAwMCAgICAgMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAgIDAwMCAgIFxuXG4gICAgc2V0Vmlld0hlaWdodDogKGgpID0+XG5cbiAgICAgICAgcmV0dXJuIGlmIE51bWJlci5pc05hTiBoXG4gICAgICAgIGlmIEB2aWV3SGVpZ2h0ICE9IGhcbiAgICAgICAgICAgIEB2aWV3SGVpZ2h0ID0gaFxuICAgICAgICAgICAgQGNhbGMoKVxuICAgICAgICAgICAgQGJ5IDBcbiAgICAgICAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwICAgICAwMCAgMDAwICAgICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMFxuICAgICMgMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAgIFxuICAgICMgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgMDAwICAgICAgMDAwICAwMDAgMCAwMDAgIDAwMDAwMDAgICAwMDAwMDAwIFxuICAgICMgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAwIDAwMCAgMDAwICAgICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgICAgICAgIDAwMFxuICAgICMgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwIFxuICAgICAgICBcbiAgICBzZXROdW1MaW5lczogKG4pID0+XG5cbiAgICAgICAgcmV0dXJuIGlmIE51bWJlci5pc05hTiBuXG4gICAgICAgIGlmIEBudW1MaW5lcyAhPSBuXG4gICAgICAgICAgICBAbnVtTGluZXMgPSBuXG4gICAgICAgICAgICBAZnVsbEhlaWdodCA9IEBudW1MaW5lcyAqIEBsaW5lSGVpZ2h0ICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBAbnVtTGluZXNcbiAgICAgICAgICAgICAgICBAY2FsYygpXG4gICAgICAgICAgICAgICAgQGJ5IDBcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBAaW5pdCgpXG4gICAgICAgICAgICAgICAgQGVtaXQgJ2NsZWFyTGluZXMnICAgICAgICAgICAgIFxuXG4gICAgIyAwMDAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMFxuICAgICMgMDAwICAgICAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgICAgIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMDAwMDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgICAwMDAgICBcblxuICAgIHNldExpbmVIZWlnaHQ6IChoKSA9PlxuXG4gICAgICAgIHJldHVybiBpZiBOdW1iZXIuaXNOYU4gaFxuICAgICAgICBpZiBAbGluZUhlaWdodCAhPSBoXG4gICAgICAgICAgICBAbGluZUhlaWdodCA9IGhcbiAgICAgICAgICAgIEBmdWxsSGVpZ2h0ID0gQG51bUxpbmVzICogQGxpbmVIZWlnaHRcbiAgICAgICAgICAgIEBjYWxjKClcbiAgICAgICAgICAgIEBieSAwXG5cbm1vZHVsZS5leHBvcnRzID0gTWFwU2Nyb2xsXG4iXX0=
//# sourceURL=../coffee/mapscroll.coffee