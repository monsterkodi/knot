// koffee 1.4.0

/*
000000000  00000000  00000000   00     00  
   000     000       000   000  000   000  
   000     0000000   0000000    000000000  
   000     000       000   000  000 0 000  
   000     00000000  000   000  000   000
 */
var $, BaseEditor, History, PTY, Shell, Term, TextEditor, elem, klog, kpos, post, ref, render, slash,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), post = ref.post, slash = ref.slash, elem = ref.elem, kpos = ref.kpos, klog = ref.klog, $ = ref.$;

BaseEditor = require('./editor/editor');

TextEditor = require('./editor/texteditor');

render = require('./editor/render');

History = require('./history');

Shell = require('./shell');

PTY = require('./pty');

Term = (function() {
    function Term() {
        this.scrollBy = bind(this.scrollBy, this);
        this.resized = bind(this.resized, this);
        this.onFontSize = bind(this.onFontSize, this);
        this.onChanged = bind(this.onChanged, this);
        var main;
        main = $('#main');
        this.div = elem({
            "class": 'term'
        });
        main.appendChild(this.div);
        this.num = 0;
        this.rows = 0;
        this.cols = 0;
        this.size = {
            charWidth: 0,
            lineHeight: 0
        };
        this.editor = new TextEditor(this, {
            features: ['Scrollbar', 'Minimap', 'Meta', 'Numbers', 'Autocomplete', 'Brackets', 'Strings', 'CursorLine']
        });
        this.editor.setText('');
        this.editor.on('changed', this.onChanged);
        this.shell = new Shell(this);
        this.pty = new PTY(this);
        this.history = new History(this);
        this.autocomplete = this.editor.autocomplete;
        post.on('fontSize', this.onFontSize);
    }

    Term.prototype.addDirMeta = function(dir) {
        return this.editor.meta.add({
            line: Math.max(0, this.editor.numLines() - 2),
            clss: 'pwd',
            number: {
                text: ' ',
                clss: 'pwd'
            },
            end: dir.length + 1,
            click: (function(_this) {
                return function(meta, event) {
                    var i, index, j, next, pos, ref1, ref2;
                    pos = kpos(event);
                    if (pos.x < 40) {
                        index = _this.editor.meta.metas.indexOf(meta);
                        if (index < _this.editor.meta.metas.length - 1) {
                            _this.editor.singleCursorAtPos([0, meta[0]]);
                            if (next = _this.editor.meta.nextMetaOfSameClass(meta)) {
                                for (i = j = ref1 = meta[0], ref2 = next[0]; ref1 <= ref2 ? j < ref2 : j > ref2; i = ref1 <= ref2 ? ++j : --j) {
                                    _this.editor.deleteSelectionOrCursorLines();
                                }
                            }
                            return _this.editor.moveCursorsDown();
                        }
                    } else {
                        _this.editor.singleCursorAtEnd();
                        return _this.shell.cd(_this.editor.line(meta[0]));
                    }
                };
            })(this)
        });
    };

    Term.prototype.addInputMeta = function() {
        this.inputMeta = this.editor.meta.add({
            line: 0,
            clss: 'input',
            number: {
                text: '▶',
                clss: 'input'
            },
            click: (function(_this) {
                return function(meta, event) {
                    var pos;
                    pos = kpos(event);
                    if (pos.x < 40) {
                        return klog('input number');
                    } else {
                        return klog('input text?');
                    }
                };
            })(this)
        });
        if (this.shell.child) {
            return this.busyInput();
        }
    };

    Term.prototype.busyInput = function() {
        var ref1, ref2;
        if ((ref1 = this.inputMeta[2]) != null) {
            ref1.number.text = '\uf013';
        }
        if ((ref2 = this.inputMeta[2]) != null) {
            ref2.number.clss = 'input busy';
        }
        return this.editor.meta.update(this.inputMeta);
    };

    Term.prototype.resetInput = function() {
        var ref1, ref2;
        if ((ref1 = this.inputMeta[2]) != null) {
            ref1.number.text = '▶';
        }
        if ((ref2 = this.inputMeta[2]) != null) {
            ref2.number.clss = 'input';
        }
        return this.editor.meta.update(this.inputMeta);
    };

    Term.prototype.failMeta = function(meta) {
        this.resetInput();
        meta[2].number = {
            text: '✖',
            clss: 'fail'
        };
        meta[2].clss = 'fail';
        this.editor.minimap.drawLines(meta[0], meta[0]);
        return this.editor.meta.update(meta);
    };

    Term.prototype.succMeta = function(meta) {
        this.resetInput();
        meta[2].number = {
            text: '▶',
            clss: 'succ'
        };
        meta[2].clss = 'succ';
        this.editor.minimap.drawLines(meta[0], meta[0]);
        return this.editor.meta.update(meta);
    };

    Term.prototype.insertCmdMeta = function(li, cmd) {
        this.busyInput();
        return this.editor.meta.add({
            line: li,
            clss: 'cmd',
            number: {
                text: '\uf013',
                clss: 'cmd'
            },
            end: cmd.length + 1,
            click: (function(_this) {
                return function(meta, event) {
                    _this.editor.singleCursorAtEnd();
                    _this.editor.setInputText(_this.editor.line(meta[0]));
                    return _this.shell.execute({
                        cmd: _this.editor.line(meta[0])
                    });
                };
            })(this)
        });
    };

    Term.prototype.moveInputMeta = function() {
        var oldLine;
        if (this.editor.numLines() - 1 !== this.inputMeta[0]) {
            oldLine = this.inputMeta[0];
            this.editor.meta.moveLineMeta(this.inputMeta, this.editor.numLines() - 1 - this.inputMeta[0]);
            return this.editor.numbers.updateColor(oldLine);
        }
    };

    Term.prototype.onChanged = function(changeInfo) {
        if (changeInfo.changes.length) {
            return this.moveInputMeta();
        }
    };

    Term.prototype.clear = function() {
        var ref1;
        if ((ref1 = this.shell.last) != null) {
            delete ref1.meta;
        }
        this.editor.clear();
        this.addInputMeta();
        return true;
    };

    Term.prototype.onFontSize = function(size) {
        this.editor.setFontSize(size);
        return this.editor.singleCursorAtEnd();
    };

    Term.prototype.resized = function() {
        return this.editor.resized();
    };

    Term.prototype.scrollBy = function(delta) {
        var ref1;
        if (this.autocomplete.list) {
            this.autocomplete.close();
        }
        this.editor.scroll.by(delta);
        if (!((0 < (ref1 = this.editor.scroll.scroll) && ref1 < this.editor.scroll.scrollMax - 1))) {
            return post.emit('stopWheel');
        }
    };

    Term.prototype.pwd = function() {
        var dir;
        dir = slash.tilde(process.cwd());
        this.editor.appendOutput(dir);
        this.addDirMeta(dir);
        return true;
    };

    Term.prototype.onEnter = function() {
        if (this.editor.isInputCursor()) {
            if (this.autocomplete.isListItemSelected()) {
                this.autocomplete.complete({});
            } else if (this.autocomplete.selectedCompletion()) {
                return this.shell.execute({
                    fallback: this.editor.lastLine() + this.autocomplete.selectedCompletion()
                });
            }
            return this.shell.execute({});
        } else {
            return this.editor.singleCursorAtEnd();
        }
    };

    Term.prototype.handleKey = function(mod, key, combo, char, event) {
        this.pty.handleKey(mod, key, combo, char, event);
        return;
        switch (combo) {
            case 'enter':
                return this.onEnter();
            case 'alt+up':
                return this.editor.moveCursorsUp();
            case 'alt+down':
                return this.editor.moveCursorsDown();
            case 'ctrl+c':
                return this.shell.handleCancel();
        }
        if (0) {

        } else {
            if ('unhandled' !== this.autocomplete.handleModKeyComboEvent(mod, key, combo, event)) {
                return;
            }
            if (this.editor.isInputCursor()) {
                switch (combo) {
                    case 'up':
                        return this.history.prev();
                    case 'down':
                        return this.history.next();
                }
            }
        }
        return 'unhandled';
    };

    return Term;

})();

module.exports = Term;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVybS5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUEsZ0dBQUE7SUFBQTs7QUFRQSxNQUF1QyxPQUFBLENBQVEsS0FBUixDQUF2QyxFQUFFLGVBQUYsRUFBUSxpQkFBUixFQUFlLGVBQWYsRUFBcUIsZUFBckIsRUFBMkIsZUFBM0IsRUFBaUM7O0FBRWpDLFVBQUEsR0FBYSxPQUFBLENBQVEsaUJBQVI7O0FBQ2IsVUFBQSxHQUFhLE9BQUEsQ0FBUSxxQkFBUjs7QUFDYixNQUFBLEdBQWEsT0FBQSxDQUFRLGlCQUFSOztBQUNiLE9BQUEsR0FBYSxPQUFBLENBQVEsV0FBUjs7QUFDYixLQUFBLEdBQWEsT0FBQSxDQUFRLFNBQVI7O0FBQ2IsR0FBQSxHQUFhLE9BQUEsQ0FBUSxPQUFSOztBQUVQO0lBRUMsY0FBQTs7Ozs7QUFFQyxZQUFBO1FBQUEsSUFBQSxHQUFNLENBQUEsQ0FBRSxPQUFGO1FBQ04sSUFBQyxDQUFBLEdBQUQsR0FBTyxJQUFBLENBQUs7WUFBQSxDQUFBLEtBQUEsQ0FBQSxFQUFNLE1BQU47U0FBTDtRQUNQLElBQUksQ0FBQyxXQUFMLENBQWlCLElBQUMsQ0FBQSxHQUFsQjtRQUVBLElBQUMsQ0FBQSxHQUFELEdBQVE7UUFDUixJQUFDLENBQUEsSUFBRCxHQUFRO1FBQ1IsSUFBQyxDQUFBLElBQUQsR0FBUTtRQUNSLElBQUMsQ0FBQSxJQUFELEdBQ0k7WUFBQSxTQUFBLEVBQVksQ0FBWjtZQUNBLFVBQUEsRUFBWSxDQURaOztRQUdKLElBQUMsQ0FBQSxNQUFELEdBQVUsSUFBSSxVQUFKLENBQWUsSUFBZixFQUFrQjtZQUFBLFFBQUEsRUFBUyxDQUNqQyxXQURpQyxFQUVqQyxTQUZpQyxFQUdqQyxNQUhpQyxFQUlqQyxTQUppQyxFQUtqQyxjQUxpQyxFQU1qQyxVQU5pQyxFQU9qQyxTQVBpQyxFQVFqQyxZQVJpQyxDQUFUO1NBQWxCO1FBV1YsSUFBQyxD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QUFPLEtBQVA7QUFBQSxpQkFDUyxPQURUO0FBQ3lCLHVCQUFPLElBQUMsQ0FBQSxPQUFELENBQUE7QUFEaEMsaUJBRVMsUUFGVDtBQUV5Qix1QkFBTyxJQUFDLENBQUEsTUFBTSxDQUFDLGFBQVIsQ0FBQTtBQUZoQyxpQkFHUyxVQUhUO0FBR3lCLHVCQUFPLElBQUMsQ0FBQSxNQUFNLENBQUMsZUFBUixDQUFBO0FBSGhDLGlCQUlTLFFBSlQ7QUFJeUIsdUJBQU8sSUFBQyxDQUFBLEtBQUssQ0FBQyxZQUFQLENBQUE7QUFKaEM7UUFNQSxJQUFHLENBQUg7QUFBQTtTQUFBLE1BQUE7WUFLSSxJQUFVLFdBQUEsS0FBZSxJQUFDLENBQUEsWUFBWSxDQUFDLHNCQUFkLENBQXFDLEdBQXJDLEVBQTBDLEdBQTFDLEVBQStDLEtBQS9DLEVBQXNELEtBQXRELENBQXpCO0FBQUEsdUJBQUE7O1lBRUEsSUFBRyxJQUFDLENBQUEsTUFBTSxDQUFDLGFBQVIsQ0FBQSxDQUFIO0FBQ0ksd0JBQU8sS0FBUDtBQUFBLHlCQUNTLElBRFQ7QUFDdUIsK0JBQU8sSUFBQyxDQUFBLE9BQU8sQ0FBQyxJQUFULENBQUE7QUFEOUIseUJBRVMsTUFGVDtBQUV1QiwrQkFBTyxJQUFDLENBQUEsT0FBTyxDQUFDLElBQVQsQ0FBQTtBQUY5QixpQkFESjthQVBKOztlQVlBO0lBekJPOzs7Ozs7QUEyQmYsTUFBTSxDQUFDLE9BQVAsR0FBaUIiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwICAgMDAgICAgIDAwICBcbiAgIDAwMCAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgIDAwMCAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMDAwICBcbiAgIDAwMCAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICBcbiAgIDAwMCAgICAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiMjI1xuXG57IHBvc3QsIHNsYXNoLCBlbGVtLCBrcG9zLCBrbG9nLCAkIH0gPSByZXF1aXJlICdreGsnXG5cbkJhc2VFZGl0b3IgPSByZXF1aXJlICcuL2VkaXRvci9lZGl0b3InXG5UZXh0RWRpdG9yID0gcmVxdWlyZSAnLi9lZGl0b3IvdGV4dGVkaXRvcidcbnJlbmRlciAgICAgPSByZXF1aXJlICcuL2VkaXRvci9yZW5kZXInXG5IaXN0b3J5ICAgID0gcmVxdWlyZSAnLi9oaXN0b3J5J1xuU2hlbGwgICAgICA9IHJlcXVpcmUgJy4vc2hlbGwnXG5QVFkgICAgICAgID0gcmVxdWlyZSAnLi9wdHknXG5cbmNsYXNzIFRlcm1cblxuICAgIEA6IC0+XG4gICAgICAgIFxuICAgICAgICBtYWluID0kICcjbWFpbidcbiAgICAgICAgQGRpdiA9IGVsZW0gY2xhc3M6J3Rlcm0nIFxuICAgICAgICBtYWluLmFwcGVuZENoaWxkIEBkaXZcblxuICAgICAgICBAbnVtICA9IDAgICBcbiAgICAgICAgQHJvd3MgPSAwXG4gICAgICAgIEBjb2xzID0gMFxuICAgICAgICBAc2l6ZSA9XG4gICAgICAgICAgICBjaGFyV2lkdGg6ICAwXG4gICAgICAgICAgICBsaW5lSGVpZ2h0OiAwXG4gICAgICAgICAgICAgICAgXG4gICAgICAgIEBlZGl0b3IgPSBuZXcgVGV4dEVkaXRvciBALCBmZWF0dXJlczpbXG4gICAgICAgICAgICAnU2Nyb2xsYmFyJ1xuICAgICAgICAgICAgJ01pbmltYXAnXG4gICAgICAgICAgICAnTWV0YSdcbiAgICAgICAgICAgICdOdW1iZXJzJ1xuICAgICAgICAgICAgJ0F1dG9jb21wbGV0ZSdcbiAgICAgICAgICAgICdCcmFja2V0cydcbiAgICAgICAgICAgICdTdHJpbmdzJ1xuICAgICAgICAgICAgJ0N1cnNvckxpbmUnXG4gICAgICAgIF1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgQGVkaXRvci5zZXRUZXh0ICcnXG4gICAgICAgIFxuICAgICAgICBAZWRpdG9yLm9uICdjaGFuZ2VkJyBAb25DaGFuZ2VkXG4gICAgICAgIFxuICAgICAgICBAc2hlbGwgICA9IG5ldyBTaGVsbCBAXG4gICAgICAgIEBwdHkgICAgID0gbmV3IFBUWSBAXG4gICAgICAgIEBoaXN0b3J5ID0gbmV3IEhpc3RvcnkgQFxuICAgICAgICBAYXV0b2NvbXBsZXRlID0gQGVkaXRvci5hdXRvY29tcGxldGVcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICBwb3N0Lm9uICdmb250U2l6ZScgQG9uRm9udFNpemVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgIyAwMCAgICAgMDAgIDAwMDAwMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAwMDAwMDAgIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMDAwMDAwMCAgXG4gICAgIyAwMDAgMCAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgXG5cbiAgICBhZGREaXJNZXRhOiAoZGlyKSAtPlxuICAgICAgICBcbiAgICAgICAgQGVkaXRvci5tZXRhLmFkZFxuICAgICAgICAgICAgbGluZTogTWF0aC5tYXggMCwgQGVkaXRvci5udW1MaW5lcygpLTJcbiAgICAgICAgICAgIGNsc3M6ICdwd2QnXG4gICAgICAgICAgICBudW1iZXI6IFxuICAgICAgICAgICAgICAgIHRleHQ6ICcgJ1xuICAgICAgICAgICAgICAgIGNsc3M6ICdwd2QnXG4gICAgICAgICAgICBlbmQ6IGRpci5sZW5ndGgrMVxuICAgICAgICAgICAgY2xpY2s6IChtZXRhLCBldmVudCkgPT5cbiAgICAgICAgICAgICAgICBwb3MgPSBrcG9zIGV2ZW50XG4gICAgICAgICAgICAgICAgaWYgcG9zLnggPCA0MFxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IEBlZGl0b3IubWV0YS5tZXRhcy5pbmRleE9mIG1ldGFcbiAgICAgICAgICAgICAgICAgICAgaWYgaW5kZXggPCBAZWRpdG9yLm1ldGEubWV0YXMubGVuZ3RoLTFcbiAgICAgICAgICAgICAgICAgICAgICAgIEBlZGl0b3Iuc2luZ2xlQ3Vyc29yQXRQb3MgWzAsbWV0YVswXV1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5leHQgPSBAZWRpdG9yLm1ldGEubmV4dE1ldGFPZlNhbWVDbGFzcyBtZXRhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gW21ldGFbMF0uLi5uZXh0WzBdXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAZWRpdG9yLmRlbGV0ZVNlbGVjdGlvbk9yQ3Vyc29yTGluZXMoKVxuICAgICAgICAgICAgICAgICAgICAgICAgQGVkaXRvci5tb3ZlQ3Vyc29yc0Rvd24oKVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgQGVkaXRvci5zaW5nbGVDdXJzb3JBdEVuZCgpXG4gICAgICAgICAgICAgICAgICAgIEBzaGVsbC5jZCBAZWRpdG9yLmxpbmUgbWV0YVswXVxuXG4gICAgYWRkSW5wdXRNZXRhOiAtPlxuICAgICAgICBcbiAgICAgICAgQGlucHV0TWV0YSA9IEBlZGl0b3IubWV0YS5hZGRcbiAgICAgICAgICAgIGxpbmU6IDBcbiAgICAgICAgICAgIGNsc3M6ICdpbnB1dCdcbiAgICAgICAgICAgIG51bWJlcjogXG4gICAgICAgICAgICAgICAgdGV4dDogJ+KWtidcbiAgICAgICAgICAgICAgICBjbHNzOiAnaW5wdXQnXG4gICAgICAgICAgICBjbGljazogKG1ldGEsIGV2ZW50KSA9PlxuICAgICAgICAgICAgICAgIHBvcyA9IGtwb3MgZXZlbnRcbiAgICAgICAgICAgICAgICBpZiBwb3MueCA8IDQwXG4gICAgICAgICAgICAgICAgICAgIGtsb2cgJ2lucHV0IG51bWJlcidcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGtsb2cgJ2lucHV0IHRleHQ/J1xuICBcbiAgICAgICAgaWYgQHNoZWxsLmNoaWxkXG4gICAgICAgICAgICBAYnVzeUlucHV0KClcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgYnVzeUlucHV0OiAtPlxuXG4gICAgICAgIEBpbnB1dE1ldGFbMl0/Lm51bWJlci50ZXh0ID0gJ1xcdWYwMTMnXG4gICAgICAgIEBpbnB1dE1ldGFbMl0/Lm51bWJlci5jbHNzID0gJ2lucHV0IGJ1c3knXG4gICAgICAgIEBlZGl0b3IubWV0YS51cGRhdGUgQGlucHV0TWV0YVxuICAgICAgICBcbiAgICByZXNldElucHV0OiAtPlxuICAgICAgICBcbiAgICAgICAgQGlucHV0TWV0YVsyXT8ubnVtYmVyLnRleHQgPSAn4pa2J1xuICAgICAgICBAaW5wdXRNZXRhWzJdPy5udW1iZXIuY2xzcyA9ICdpbnB1dCdcbiAgICAgICAgQGVkaXRvci5tZXRhLnVwZGF0ZSBAaW5wdXRNZXRhXG4gICAgXG4gICAgZmFpbE1ldGE6IChtZXRhKSAtPlxuXG4gICAgICAgIEByZXNldElucHV0KClcbiAgICAgICAgXG4gICAgICAgIG1ldGFbMl0ubnVtYmVyID0gdGV4dDon4pyWJyBjbHNzOidmYWlsJ1xuICAgICAgICBtZXRhWzJdLmNsc3MgPSAnZmFpbCdcbiAgICAgICAgQGVkaXRvci5taW5pbWFwLmRyYXdMaW5lcyBtZXRhWzBdLCBtZXRhWzBdXG4gICAgICAgIEBlZGl0b3IubWV0YS51cGRhdGUgbWV0YVxuICAgICAgICBcbiAgICBzdWNjTWV0YTogKG1ldGEpIC0+XG5cbiAgICAgICAgQHJlc2V0SW5wdXQoKVxuICAgICAgICBcbiAgICAgICAgbWV0YVsyXS5udW1iZXIgPSB0ZXh0OifilrYnIGNsc3M6J3N1Y2MnXG4gICAgICAgIG1ldGFbMl0uY2xzcyA9ICdzdWNjJ1xuICAgICAgICBAZWRpdG9yLm1pbmltYXAuZHJhd0xpbmVzIG1ldGFbMF0sIG1ldGFbMF1cbiAgICAgICAgQGVkaXRvci5tZXRhLnVwZGF0ZSBtZXRhXG4gICAgICAgIFxuICAgIGluc2VydENtZE1ldGE6IChsaSwgY21kKSAtPlxuXG4gICAgICAgIEBidXN5SW5wdXQoKVxuICAgICAgICBcbiAgICAgICAgQGVkaXRvci5tZXRhLmFkZCBcbiAgICAgICAgICAgIGxpbmU6IGxpXG4gICAgICAgICAgICBjbHNzOiAnY21kJ1xuICAgICAgICAgICAgbnVtYmVyOiBcbiAgICAgICAgICAgICAgICB0ZXh0OiAnXFx1ZjAxMydcbiAgICAgICAgICAgICAgICBjbHNzOiAnY21kJ1xuICAgICAgICAgICAgZW5kOiBjbWQubGVuZ3RoKzFcbiAgICAgICAgICAgIGNsaWNrOiAobWV0YSwgZXZlbnQpID0+XG4gICAgICAgICAgICAgICAgQGVkaXRvci5zaW5nbGVDdXJzb3JBdEVuZCgpXG4gICAgICAgICAgICAgICAgQGVkaXRvci5zZXRJbnB1dFRleHQgQGVkaXRvci5saW5lIG1ldGFbMF1cbiAgICAgICAgICAgICAgICBAc2hlbGwuZXhlY3V0ZSBjbWQ6QGVkaXRvci5saW5lIG1ldGFbMF1cbiAgICBcbiAgICBtb3ZlSW5wdXRNZXRhOiAtPlxuICAgICAgICBcbiAgICAgICAgaWYgQGVkaXRvci5udW1MaW5lcygpLTEgIT0gQGlucHV0TWV0YVswXVxuICAgICAgICAgICAgb2xkTGluZSA9IEBpbnB1dE1ldGFbMF1cbiAgICAgICAgICAgIEBlZGl0b3IubWV0YS5tb3ZlTGluZU1ldGEgQGlucHV0TWV0YSwgQGVkaXRvci5udW1MaW5lcygpLTEtQGlucHV0TWV0YVswXSAgICAgICAgICAgIFxuICAgICAgICAgICAgQGVkaXRvci5udW1iZXJzLnVwZGF0ZUNvbG9yIG9sZExpbmVcbiAgICAgICAgICAgIFxuICAgIG9uQ2hhbmdlZDogKGNoYW5nZUluZm8pID0+XG4gICAgICAgIFxuICAgICAgICBpZiBjaGFuZ2VJbmZvLmNoYW5nZXMubGVuZ3RoXG4gICAgICAgICAgICBAbW92ZUlucHV0TWV0YSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICMgIDAwMDAwMDAgIDAwMCAgICAgIDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwICAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAgMDAwMDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICBcbiAgICBjbGVhcjogLT4gXG4gICAgXG4gICAgICAgIGRlbGV0ZSBAc2hlbGwubGFzdD8ubWV0YVxuICAgICAgICBAZWRpdG9yLmNsZWFyKClcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgIEBhZGRJbnB1dE1ldGEoKVxuICAgICAgICB0cnVlXG4gICAgICAgICAgICAgICAgXG4gICAgIyAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgICAgICAwMDAwMDAwICAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMDAgIDAwMCAgICAgMDAwICAgICAgICAgMDAwICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAgIFxuICAgICMgMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAgICAwMDAgICAgICAgICAwMDAwMDAwICAgMDAwICAgIDAwMCAgICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgIDAwMDAgICAgIDAwMCAgICAgICAgICAgICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgICAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAgICAgMDAwMDAwMCAgIDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgIFxuXG4gICAgb25Gb250U2l6ZTogKHNpemUpID0+XG4gICAgICAgIFxuICAgICAgICBAZWRpdG9yLnNldEZvbnRTaXplIHNpemVcbiAgICAgICAgQGVkaXRvci5zaW5nbGVDdXJzb3JBdEVuZCgpXG4gICAgICAgIFxuICAgIHJlc2l6ZWQ6ID0+IEBlZGl0b3IucmVzaXplZCgpXG4gICAgXG4gICAgc2Nyb2xsQnk6IChkZWx0YSkgPT5cbiAgICAgICAgXG4gICAgICAgIGlmIEBhdXRvY29tcGxldGUubGlzdFxuICAgICAgICAgICAgQGF1dG9jb21wbGV0ZS5jbG9zZSgpXG4gICAgICAgIEBlZGl0b3Iuc2Nyb2xsLmJ5IGRlbHRhXG4gICAgICAgIGlmIG5vdCAoMCA8IEBlZGl0b3Iuc2Nyb2xsLnNjcm9sbCA8IEBlZGl0b3Iuc2Nyb2xsLnNjcm9sbE1heC0xKVxuICAgICAgICAgICAgcG9zdC5lbWl0ICdzdG9wV2hlZWwnXG4gICAgXG4gICAgIyAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMCAgICAgICAgMDAgICAgIDAwICAwMDAwMDAwICAgIFxuICAgIFxuICAgIHB3ZDogLT5cbiAgICAgICAgXG4gICAgICAgIGRpciA9IHNsYXNoLnRpbGRlIHByb2Nlc3MuY3dkKClcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgQGVkaXRvci5hcHBlbmRPdXRwdXQgZGlyXG4gICAgICAgIEBhZGREaXJNZXRhIGRpclxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgdHJ1ZVxuICAgICAgICAgICAgICAgXG4gICAgIyAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMCAgIFxuICAgICMgMDAwICAgICAgIDAwMDAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgMDAwICAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAwMDAgMCAwMDAgICAgIDAwMCAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAwMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIFxuICAgICMgMDAwMDAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMCAgMDAwICAgMDAwICBcbiAgICBcbiAgICBvbkVudGVyOiAtPlxuICAgICAgICBcbiAgICAgICAgaWYgQGVkaXRvci5pc0lucHV0Q3Vyc29yKClcbiAgICAgICAgICAgICMgaWYgQHNoZWxsLmNoaWxkICNhbmQgQHNoZWxsLmxhc3QuY21kID09ICdrb2ZmZWUnXG4gICAgICAgICAgICAgICAgIyBrbG9nICdlbnRlcidcbiAgICAgICAgICAgICAgICAjICMgQHNoZWxsLmNoaWxkLnN0ZGluLndyaXRlICdcXG4nXG4gICAgICAgICAgICAgICAgIyBAc2hlbGwuY2hpbGQud3JpdGUgJ1xccidcbiAgICAgICAgICAgICAgICAjICMgaWYgQHNoZWxsLmxhc3QuY21kID09ICdrb2ZmZWUnXG4gICAgICAgICAgICAgICAgIyBAZWRpdG9yLnNldElucHV0VGV4dCAnJ1xuICAgICAgICAgICAgICAgICMgcmV0dXJuXG4gICAgICAgICAgICBpZiBAYXV0b2NvbXBsZXRlLmlzTGlzdEl0ZW1TZWxlY3RlZCgpXG4gICAgICAgICAgICAgICAgQGF1dG9jb21wbGV0ZS5jb21wbGV0ZSB7fVxuICAgICAgICAgICAgZWxzZSBpZiBAYXV0b2NvbXBsZXRlLnNlbGVjdGVkQ29tcGxldGlvbigpXG4gICAgICAgICAgICAgICAgcmV0dXJuIEBzaGVsbC5leGVjdXRlIGZhbGxiYWNrOkBlZGl0b3IubGFzdExpbmUoKSArIEBhdXRvY29tcGxldGUuc2VsZWN0ZWRDb21wbGV0aW9uKClcbiAgICAgICAgICAgIEBzaGVsbC5leGVjdXRlIHt9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIEBlZGl0b3Iuc2luZ2xlQ3Vyc29yQXRFbmQoKVxuICAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgICAgICAgMDAwIDAwMCAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwICAgICAwMDAwMCAgICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAgICAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAgICAwMDAgICAgIFxuICAgIFxuICAgIGhhbmRsZUtleTogKG1vZCwga2V5LCBjb21ibywgY2hhciwgZXZlbnQpIC0+ICAgICAgICBcbiAgICAgICAgXG4gICAgICAgICMga2xvZyAndGVybS5oYW5kbGVLZXknIG1vZCwga2V5LCBjb21ib1xuICAgICAgICBcbiAgICAgICAgQHB0eS5oYW5kbGVLZXkgbW9kLCBrZXksIGNvbWJvLCBjaGFyLCBldmVudFxuICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgc3dpdGNoIGNvbWJvXG4gICAgICAgICAgICB3aGVuICdlbnRlcicgICAgdGhlbiByZXR1cm4gQG9uRW50ZXIoKVxuICAgICAgICAgICAgd2hlbiAnYWx0K3VwJyAgIHRoZW4gcmV0dXJuIEBlZGl0b3IubW92ZUN1cnNvcnNVcCgpXG4gICAgICAgICAgICB3aGVuICdhbHQrZG93bicgdGhlbiByZXR1cm4gQGVkaXRvci5tb3ZlQ3Vyc29yc0Rvd24oKVxuICAgICAgICAgICAgd2hlbiAnY3RybCtjJyAgIHRoZW4gcmV0dXJuIEBzaGVsbC5oYW5kbGVDYW5jZWwoKVxuICAgICAgICBcbiAgICAgICAgaWYgMCAjIEBzaGVsbC5jaGlsZCAjIGFuZCBAc2hlbGwubGFzdC5jbWQgPT0gJ2tvZmZlZSdcbiAgICAgICAgICAgICAgICAjIHJldHVyblxuICAgICAgICAgICAgIyBlbHNlXG4gICAgICAgICAgICAgICAgIyBrbG9nICdwaXBlIGtleScga2V5LCBjb21ib1xuICAgICAgICBlbHNlICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gaWYgJ3VuaGFuZGxlZCcgIT0gQGF1dG9jb21wbGV0ZS5oYW5kbGVNb2RLZXlDb21ib0V2ZW50IG1vZCwga2V5LCBjb21ibywgZXZlbnRcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgQGVkaXRvci5pc0lucHV0Q3Vyc29yKClcbiAgICAgICAgICAgICAgICBzd2l0Y2ggY29tYm9cbiAgICAgICAgICAgICAgICAgICAgd2hlbiAndXAnICAgICB0aGVuIHJldHVybiBAaGlzdG9yeS5wcmV2KClcbiAgICAgICAgICAgICAgICAgICAgd2hlbiAnZG93bicgICB0aGVuIHJldHVybiBAaGlzdG9yeS5uZXh0KClcbiAgICAgICAgXG4gICAgICAgICd1bmhhbmRsZWQnXG4gICAgICAgIFxubW9kdWxlLmV4cG9ydHMgPSBUZXJtXG4iXX0=
//# sourceURL=../coffee/term.coffee