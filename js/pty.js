// koffee 1.14.0

/*
00000000   000000000  000   000  
000   000     000      000 000   
00000000      000       00000    
000           000        000     
000           000        000
 */
var PTY, klog, ref, title,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), klog = ref.klog, title = ref.title;

PTY = (function() {
    function PTY(term) {
        this.term = term;
        this.onData = bind(this.onData, this);
        this.editor = this.term.editor;
        this.spawn();
    }

    PTY.prototype.spawn = function() {};

    PTY.prototype.handleKey = function(mod, key, combo, char, event) {
        switch (key) {
            case 'enter':
                return this.pty.write('\r');
            case 'backspace':
                return this.pty.write('\x08');
            default:
                if (char) {
                    return this.pty.write(char);
                } else {
                    return klog('key', mod, key, combo);
                }
        }
    };

    PTY.prototype.onData = function(data) {
        var ch, ci, code, col, crazyNewlines, imeds, line, next, param, ref1, row;
        line = '';
        code = 0;
        ci = -1;
        ch = null;
        crazyNewlines = 0;
        next = function() {
            ci += 1;
            ch = data[ci];
            return code = ch.charCodeAt(0);
        };
        while (ci < data.length - 1) {
            next();
            switch (code) {
                case 7:
                    klog('ðŸ””');
                    break;
                case 8:
                    this.editor.deleteBackward({
                        singleCharacter: true
                    });
                    if (data[ci + 1] === ' ' && data[ci + 2].charCodeAt(0) === 8) {
                        next();
                        next();
                    }
                    break;
                case 27:
                    next();
                    if ((0x40 <= code && code <= 0x5f)) {
                        switch (ch) {
                            case '[':
                                param = '';
                                imeds = '';
                                next();
                                while ((0x30 <= code && code <= 0x3F)) {
                                    param += ch;
                                    next();
                                }
                                while ((0x20 <= code && code <= 0x2F)) {
                                    imeds += ch;
                                    next();
                                }
                                if ((0x40 <= code && code <= 0x7E)) {
                                    klog("    esc[" + param + imeds + ch);
                                    switch (ch) {
                                        case 'm':
                                            line += "\x1B[" + param + imeds + ch;
                                            break;
                                        case 'X':
                                            if (data.slice(ci + 1) === ("\x1b[" + param + "C\x0d")) {
                                                ci += 3 + param.length;
                                                klog('skipped crazy newline', data[ci + 1]);
                                            }
                                            break;
                                        case 'C':
                                            if (data[ci + 1] === '\r' && data[ci + 2] === '\n') {
                                                if (parseInt(param) === this.pty.cols) {
                                                    ci += 2;
                                                    crazyNewlines += 1;
                                                }
                                            }
                                            break;
                                        case 'J':
                                            switch (param) {
                                                case '0':
                                                case '':
                                                    klog('erase below');
                                                    break;
                                                case '1':
                                                    klog('erase above');
                                                    break;
                                                case '2':
                                                    klog('erase all');
                                                    break;
                                                case '3':
                                                    klog('erase saved');
                                                    break;
                                                default:
                                                    console.log('erase ???');
                                            }
                                            break;
                                        case 'H':
                                            if (param.length) {
                                                ref1 = param.split(';'), row = ref1[0], col = ref1[1];
                                                if (col != null) {
                                                    col;
                                                } else {
                                                    col = 1;
                                                }
                                            } else {
                                                row = col = 1;
                                                crazyNewlines = 0;
                                                while (data[ci + 1] === '\r' && data[ci + 2] === '\n') {
                                                    ci += 2;
                                                }
                                            }
                                            klog("    move cursor row " + row + " col " + col);
                                    }
                                }
                                break;
                            case ']':
                                if (data[ci + 1] === '0' && data[ci + 2] === ';') {
                                    next();
                                    next();
                                    next();
                                    title = '';
                                    while (code !== 7) {
                                        title += ch;
                                        next();
                                    }
                                }
                        }
                    }
                    break;
                case 10:
                    while (crazyNewlines > 0) {
                        this.editor.appendText('');
                        this.editor.singleCursorAtEnd();
                        crazyNewlines -= 1;
                    }
                    klog(">>>|" + line + "|");
                    this.editor.appendInputText(line);
                    this.editor.appendText('');
                    this.editor.singleCursorAtEnd();
                    line = '';
                    break;
                default:
                    line += ch;
            }
        }
        if (line.trim().length) {
            klog("!!!|" + line + "|");
            return this.editor.appendInputText(line);
        } else if (data === ' ') {
            return this.editor.appendInputText(' ');
        }
    };

    return PTY;

})();

module.exports = PTY;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHR5LmpzIiwic291cmNlUm9vdCI6Ii4uL2NvZmZlZSIsInNvdXJjZXMiOlsicHR5LmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSxxQkFBQTtJQUFBOztBQVFBLE1BQWtCLE9BQUEsQ0FBUSxLQUFSLENBQWxCLEVBQUUsZUFBRixFQUFROztBQUlGO0lBRUMsYUFBQyxJQUFEO1FBQUMsSUFBQyxDQUFBLE9BQUQ7O1FBRUEsSUFBQyxDQUFBLE1BQUQsR0FBVSxJQUFDLENBQUEsSUFBSSxDQUFDO1FBQ2hCLElBQUMsQ0FBQSxLQUFELENBQUE7SUFIRDs7a0JBV0gsS0FBQSxHQUFPLFNBQUEsR0FBQTs7a0JBb0JQLFNBQUEsR0FBVyxTQUFDLEdBQUQsRUFBTSxHQUFOLEVBQVcsS0FBWCxFQUFrQixJQUFsQixFQUF3QixLQUF4QjtBQUVQLGdCQUFPLEdBQVA7QUFBQSxpQkFDUyxPQURUO3VCQUMwQixJQUFDLENBQUEsR0FBRyxDQUFDLEtBQUwsQ0FBVyxJQUFYO0FBRDFCLGlCQUVTLFdBRlQ7dUJBRTBCLElBQUMsQ0FBQSxHQUFHLENBQUMsS0FBTCxDQUFXLE1BQVg7QUFGMUI7Z0JBSVEsSUFBRyxJQUFIOzJCQUNJLElBQUMsQ0FBQSxHQUFHLENBQUMsS0FBTCxDQUFXLElBQVgsRUFESjtpQkFBQSxNQUFBOzJCQUdJLElBQUEsQ0FBSyxLQUFMLEVBQVcsR0FBWCxFQUFnQixHQUFoQixFQUFxQixLQUFyQixFQUhKOztBQUpSO0lBRk87O2tCQWlCWCxNQUFBLEdBQVEsU0FBQyxJQUFEO0FBS0osWUFBQTtRQUFBLElBQUEsR0FBTztRQUNQLElBQUEsR0FBTztRQUNQLEVBQUEsR0FBTyxDQUFDO1FBQ1IsRUFBQSxHQUFPO1FBRVAsYUFBQSxHQUFnQjtRQUVoQixJQUFBLEdBQU8sU0FBQTtZQUNILEVBQUEsSUFBTTtZQUNOLEVBQUEsR0FBSyxJQUFLLENBQUEsRUFBQTttQkFDVixJQUFBLEdBQU8sRUFBRSxDQUFDLFVBQUgsQ0FBYyxDQUFkO1FBSEo7QUFNUCxlQUFNLEVBQUEsR0FBSyxJQUFJLENBQUMsTUFBTCxHQUFZLENBQXZCO1lBRUksSUFBQSxDQUFBO0FBRUEsb0JBQU8sSUFBUDtBQUFBLHFCQUNTLENBRFQ7b0JBQ2lCLElBQUEsQ0FBSyxJQUFMO0FBQVI7QUFEVCxxQkFFUyxDQUZUO29CQUdRLElBQUMsQ0FBQSxNQUFNLENBQUMsY0FBUixDQUF1Qjt3QkFBQSxlQUFBLEVBQWdCLElBQWhCO3FCQUF2QjtvQkFDQSxJQUFHLElBQUssQ0FBQSxFQUFBLEdBQUcsQ0FBSCxDQUFMLEtBQWMsR0FBZCxJQUFzQixJQUFLLENBQUEsRUFBQSxHQUFHLENBQUgsQ0FBSyxDQUFDLFVBQVgsQ0FBc0IsQ0FBdEIsQ0FBQSxLQUE0QixDQUFyRDt3QkFDSSxJQUFBLENBQUE7d0JBQ0EsSUFBQSxDQUFBLEVBRko7O0FBRkM7QUFGVCxxQkFPUyxFQVBUO29CQVFRLElBQUEsQ0FBQTtvQkFDQSxJQUFHLENBQUEsSUFBQSxJQUFRLElBQVIsSUFBUSxJQUFSLElBQWdCLElBQWhCLENBQUg7QUFDSSxnQ0FBTyxFQUFQO0FBQUEsaUNBUVMsR0FSVDtnQ0FTUSxLQUFBLEdBQVE7Z0NBQ1IsS0FBQSxHQUFRO2dDQUNSLElBQUEsQ0FBQTtBQUNBLHVDQUFNLENBQUEsSUFBQSxJQUFRLElBQVIsSUFBUSxJQUFSLElBQWdCLElBQWhCLENBQU47b0NBQ0ksS0FBQSxJQUFTO29DQUNULElBQUEsQ0FBQTtnQ0FGSjtBQUdBLHVDQUFNLENBQUEsSUFBQSxJQUFRLElBQVIsSUFBUSxJQUFSLElBQWdCLElBQWhCLENBQU47b0NBQ0ksS0FBQSxJQUFTO29DQUNULElBQUEsQ0FBQTtnQ0FGSjtnQ0FHQSxJQUFHLENBQUEsSUFBQSxJQUFRLElBQVIsSUFBUSxJQUFSLElBQWdCLElBQWhCLENBQUg7b0NBQ0ksSUFBQSxDQUFLLFVBQUEsR0FBVyxLQUFYLEdBQW1CLEtBQW5CLEdBQTJCLEVBQWhDO0FBQ0EsNENBQU8sRUFBUDtBQUFBLDZDQUVTLEdBRlQ7NENBR1EsSUFBQSxJQUFRLE9BQUEsR0FBUSxLQUFSLEdBQWdCLEtBQWhCLEdBQXdCO0FBRC9CO0FBRlQsNkNBS1MsR0FMVDs0Q0FPUSxJQUFHLElBQUssY0FBTCxLQUFnQixDQUFBLE9BQUEsR0FBUSxLQUFSLEdBQWMsT0FBZCxDQUFuQjtnREFDSSxFQUFBLElBQU0sQ0FBQSxHQUFFLEtBQUssQ0FBQztnREFDZCxJQUFBLENBQUssdUJBQUwsRUFBNkIsSUFBSyxDQUFBLEVBQUEsR0FBRyxDQUFILENBQWxDLEVBRko7O0FBRkM7QUFMVCw2Q0FXUyxHQVhUOzRDQWFRLElBQUcsSUFBSyxDQUFBLEVBQUEsR0FBRyxDQUFILENBQUwsS0FBYyxJQUFkLElBQXVCLElBQUssQ0FBQSxFQUFBLEdBQUcsQ0FBSCxDQUFMLEtBQWMsSUFBeEM7Z0RBQ0ksSUFBRyxRQUFBLENBQVMsS0FBVCxDQUFBLEtBQW1CLElBQUMsQ0FBQSxHQUFHLENBQUMsSUFBM0I7b0RBQ0ksRUFBQSxJQUFNO29EQUNOLGFBQUEsSUFBaUIsRUFGckI7aURBREo7O0FBRkM7QUFYVCw2Q0FtQlMsR0FuQlQ7QUFxQlEsb0RBQU8sS0FBUDtBQUFBLHFEQUNTLEdBRFQ7QUFBQSxxREFDYSxFQURiO29EQUNxQixJQUFBLENBQUssYUFBTDtBQUFSO0FBRGIscURBRVMsR0FGVDtvREFFcUIsSUFBQSxDQUFLLGFBQUw7QUFBWjtBQUZULHFEQUdTLEdBSFQ7b0RBR3FCLElBQUEsQ0FBSyxXQUFMO0FBQVo7QUFIVCxxREFJUyxHQUpUO29EQUlxQixJQUFBLENBQUssYUFBTDtBQUFaO0FBSlQ7b0RBTU8sT0FBQSxDQUFDLEdBQUQsQ0FBSyxXQUFMO0FBTlA7QUFGQztBQW5CVCw2Q0E0QlMsR0E1QlQ7NENBOEJRLElBQUcsS0FBSyxDQUFDLE1BQVQ7Z0RBQ0ksT0FBWSxLQUFLLENBQUMsS0FBTixDQUFZLEdBQVosQ0FBWixFQUFDLGFBQUQsRUFBSzs7b0RBQ0w7O29EQUFBLE1BQU87aURBRlg7NkNBQUEsTUFBQTtnREFJSSxHQUFBLEdBQU0sR0FBQSxHQUFNO2dEQUNaLGFBQUEsR0FBZ0I7QUFDaEIsdURBQU0sSUFBSyxDQUFBLEVBQUEsR0FBRyxDQUFILENBQUwsS0FBYyxJQUFkLElBQXVCLElBQUssQ0FBQSxFQUFBLEdBQUcsQ0FBSCxDQUFMLEtBQWMsSUFBM0M7b0RBQ0ksRUFBQSxJQUFNO2dEQURWLENBTko7OzRDQVNBLElBQUEsQ0FBSyxzQkFBQSxHQUF1QixHQUF2QixHQUEyQixPQUEzQixHQUFrQyxHQUF2QztBQXZDUixxQ0FGSjs7QUFWQztBQVJULGlDQW9FUyxHQXBFVDtnQ0FxRVEsSUFBRyxJQUFLLENBQUEsRUFBQSxHQUFHLENBQUgsQ0FBTCxLQUFjLEdBQWQsSUFBc0IsSUFBSyxDQUFBLEVBQUEsR0FBRyxDQUFILENBQUwsS0FBYyxHQUF2QztvQ0FDSSxJQUFBLENBQUE7b0NBQ0EsSUFBQSxDQUFBO29DQUNBLElBQUEsQ0FBQTtvQ0FDQSxLQUFBLEdBQVE7QUFDUiwyQ0FBTSxJQUFBLEtBQVEsQ0FBZDt3Q0FDSSxLQUFBLElBQVM7d0NBQ1QsSUFBQSxDQUFBO29DQUZKLENBTEo7O0FBckVSLHlCQURKOztBQUZDO0FBUFQscUJBMEZTLEVBMUZUO0FBNEZRLDJCQUFNLGFBQUEsR0FBZ0IsQ0FBdEI7d0JBRUksSUFBQyxDQUFBLE1BQU0sQ0FBQyxVQUFSLENBQW1CLEVBQW5CO3dCQUNBLElBQUMsQ0FBQSxNQUFNLENBQUMsaUJBQVIsQ0FBQTt3QkFDQSxhQUFBLElBQWlCO29CQUpyQjtvQkFNQSxJQUFBLENBQUssTUFBQSxHQUFPLElBQVAsR0FBWSxHQUFqQjtvQkFDQSxJQUFDLENBQUEsTUFBTSxDQUFDLGVBQVIsQ0FBd0IsSUFBeEI7b0JBQ0EsSUFBQyxDQUFBLE1BQU0sQ0FBQyxVQUFSLENBQW1CLEVBQW5CO29CQUNBLElBQUMsQ0FBQSxNQUFNLENBQUMsaUJBQVIsQ0FBQTtvQkFDQSxJQUFBLEdBQU87QUFaTjtBQTFGVDtvQkF3R1EsSUFBQSxJQUFRO0FBeEdoQjtRQUpKO1FBOEdBLElBQUcsSUFBSSxDQUFDLElBQUwsQ0FBQSxDQUFXLENBQUMsTUFBZjtZQUNJLElBQUEsQ0FBSyxNQUFBLEdBQU8sSUFBUCxHQUFZLEdBQWpCO21CQUNBLElBQUMsQ0FBQSxNQUFNLENBQUMsZUFBUixDQUF3QixJQUF4QixFQUZKO1NBQUEsTUFJSyxJQUFHLElBQUEsS0FBUSxHQUFYO21CQUNELElBQUMsQ0FBQSxNQUFNLENBQUMsZUFBUixDQUF3QixHQUF4QixFQURDOztJQXBJRDs7Ozs7O0FBdUlaLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwICAgMDAwICBcbjAwMCAgIDAwMCAgICAgMDAwICAgICAgMDAwIDAwMCAgIFxuMDAwMDAwMDAgICAgICAwMDAgICAgICAgMDAwMDAgICAgXG4wMDAgICAgICAgICAgIDAwMCAgICAgICAgMDAwICAgICBcbjAwMCAgICAgICAgICAgMDAwICAgICAgICAwMDAgICAgIFxuIyMjXG5cbnsga2xvZywgdGl0bGUgfSA9IHJlcXVpcmUgJ2t4aydcblxuIyBwdHkgPSByZXF1aXJlICdub2RlLXB0eSdcblxuY2xhc3MgUFRZXG5cbiAgICBAOiAoQHRlcm0pIC0+XG4gICAgICAgIFxuICAgICAgICBAZWRpdG9yID0gQHRlcm0uZWRpdG9yXG4gICAgICAgIEBzcGF3bigpICAgICAgICAgICAgIFxuXG4gICAgIyAgMDAwMDAwMCAgMDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAwICAwMDAgIFxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAwIDAwMCAgXG4gICAgIyAgICAgIDAwMCAgMDAwICAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICBcbiAgICAjIDAwMDAwMDAgICAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAgICAgIDAwICAwMDAgICAwMDAgIFxuICAgIFxuICAgIHNwYXduOiAtPlxuICAgICAgICBcbiAgICAgICAgIyBzaGVsbCA9ICdDOi9tc3lzNjQvdXNyL2Jpbi9iYXNoLmV4ZSdcbiAgICAgICAgIyBAcHR5ID0gcHR5LnNwYXduIHNoZWxsLCBbXSxcbiAgICAgICAgICAgICMgdXNlQ29ucHR5OiB0cnVlIFxuICAgICAgICAgICAgIyBuYW1lOiAneHRlcm0tMjU2Y29sb3InXG4gICAgICAgICAgICAjIGNvbHM6IHBhcnNlSW50IChAZWRpdG9yLmxheWVycy5vZmZzZXRXaWR0aCAtIEBlZGl0b3Iuc2l6ZS5udW1iZXJzV2lkdGgpIC8gQGVkaXRvci5zaXplLmNoYXJXaWR0aFxuICAgICAgICAgICAgIyByb3dzOiBAZWRpdG9yLnNjcm9sbC5mdWxsTGluZXNcbiAgICAgICAgICAgICMgY3dkOiBwcm9jZXNzLmN3ZCgpXG4gICAgICAgICAgICAjIGVudjogcHJvY2Vzcy5lbnZcbiMgICAgICAgICAgXG4gICAgICAgICMga2xvZyAnQHB0eSByb3dzJyBAcHR5LnJvd3MsICdjb2xzJyBAcHR5LmNvbHMsIEBlZGl0b3IubGF5ZXJzLm9mZnNldFdpZHRoLCBAZWRpdG9yLnNpemUuY2hhcldpZHRoLCBAZWRpdG9yLmxheWVycy5vZmZzZXRXaWR0aCAvIEBlZGl0b3Iuc2l6ZS5jaGFyV2lkdGhcbiAgICAgICAgIyBAcHR5Lm9uRGF0YSBAb25EYXRhXG4gICAgICAgICAgICAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgICAgICAgMDAwIDAwMCAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwICAgICAwMDAwMCAgICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAgICAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAgICAwMDAgICAgIFxuICAgIFxuICAgIGhhbmRsZUtleTogKG1vZCwga2V5LCBjb21ibywgY2hhciwgZXZlbnQpIC0+XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2gga2V5XG4gICAgICAgICAgICB3aGVuICdlbnRlcicgICAgIHRoZW4gQHB0eS53cml0ZSAnXFxyJ1xuICAgICAgICAgICAgd2hlbiAnYmFja3NwYWNlJyB0aGVuIEBwdHkud3JpdGUgJ1xceDA4J1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGlmIGNoYXJcbiAgICAgICAgICAgICAgICAgICAgQHB0eS53cml0ZSBjaGFyXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBrbG9nICdrZXknIG1vZCwga2V5LCBjb21ib1xuICAgICAgICBcbiAgICAjICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDAgICAgIDAwMCAgICAgMDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIFxuICAgICMgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgXG4gICAgXG4gICAgb25EYXRhOiAoZGF0YSkgPT5cbiAgICAgICAgXG4gICAgICAgICMga2xvZyBcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXCJcbiAgICAgICAgIyBrbG9nIFwifCN7ZGF0YX18XCJcbiAgICAgICAgXG4gICAgICAgIGxpbmUgPSAnJ1xuICAgICAgICBjb2RlID0gMFxuICAgICAgICBjaSAgID0gLTFcbiAgICAgICAgY2ggICA9IG51bGxcbiAgICAgICAgXG4gICAgICAgIGNyYXp5TmV3bGluZXMgPSAwXG4gICAgICAgIFxuICAgICAgICBuZXh0ID0gLT4gXG4gICAgICAgICAgICBjaSArPSAxXG4gICAgICAgICAgICBjaCA9IGRhdGFbY2ldXG4gICAgICAgICAgICBjb2RlID0gY2guY2hhckNvZGVBdCgwKVxuICAgICAgICAgICAgIyBrbG9nIFwiI3trc3RyLnBhZCBjb2RlLCAzfSAweCN7Y29kZS50b1N0cmluZygxNil9ICN7Y2h9XCJcbiAgICAgICAgXG4gICAgICAgIHdoaWxlIGNpIDwgZGF0YS5sZW5ndGgtMVxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBuZXh0KClcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgc3dpdGNoIGNvZGVcbiAgICAgICAgICAgICAgICB3aGVuIDcgIHRoZW4ga2xvZyAn8J+UlCdcbiAgICAgICAgICAgICAgICB3aGVuIDggIFxuICAgICAgICAgICAgICAgICAgICBAZWRpdG9yLmRlbGV0ZUJhY2t3YXJkIHNpbmdsZUNoYXJhY3Rlcjp0cnVlXG4gICAgICAgICAgICAgICAgICAgIGlmIGRhdGFbY2krMV0gPT0gJyAnIGFuZCBkYXRhW2NpKzJdLmNoYXJDb2RlQXQoMCkgPT0gOFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCgpXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0KClcbiAgICAgICAgICAgICAgICB3aGVuIDI3ICMgRVNDXG4gICAgICAgICAgICAgICAgICAgIG5leHQoKVxuICAgICAgICAgICAgICAgICAgICBpZiAweDQwIDw9IGNvZGUgPD0gMHg1ZiAjIEBB4oCTWltcXF1eX1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIGNoIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgIDAwMDAwMDAgICAwMDAwMDAwICAwMDAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgMDAwICAgICAgIDAwMCAgICAgICAwMDAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgMDAwICAgICAgIDAwMDAwMDAgICAwMDAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgMDAwICAgICAgICAgICAgMDAwICAwMDAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgIDAwMDAwMDAgIDAwMDAwMDAgICAwMDAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gJ1snICMgQ1NJIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbSA9ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZWRzID0gJydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIDB4MzAgPD0gY29kZSA8PSAweDNGICMgMOKAkzk6Ozw9Pj9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtICs9IGNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0KClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgMHgyMCA8PSBjb2RlIDw9IDB4MkYgIyAhXCIjJCUmJygpKissLS4vXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWVkcyArPSBjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIDB4NDAgPD0gY29kZSA8PSAweDdFICMgQEHigJNaW1xcXV5fYGHigJN6e3x9flxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2xvZyBcIiAgICBlc2NbI3twYXJhbX0je2ltZWRzfSN7Y2h9XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCBjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gJ20nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUgKz0gXCJcXHgxQlsje3BhcmFtfSN7aW1lZHN9I3tjaH1cIiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gJ1gnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkYXRhW2NpKzEuLl0gPT0gXCJcXHgxYlsje3BhcmFtfUNcXHgwZFwiICMgY3JhenkgY21kLmV4ZSBuZXdsaW5lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaSArPSAzK3BhcmFtLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2xvZyAnc2tpcHBlZCBjcmF6eSBuZXdsaW5lJyBkYXRhW2NpKzFdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gJ0MnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkYXRhW2NpKzFdID09ICdcXHInIGFuZCBkYXRhW2NpKzJdID09ICdcXG4nICMgbW9yZSBjcmF6eW5lc3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHBhcnNlSW50KHBhcmFtKSA9PSBAcHR5LmNvbHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaSArPSAyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JhenlOZXdsaW5lcyArPSAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBrbG9nIFwiY3JhenkgbmV3bGluZSAje2NyYXp5TmV3bGluZXN9XCIgZGF0YVtjaSsxXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuICdKJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIHBhcmFtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuICcwJyAnJyB0aGVuIGtsb2cgJ2VyYXNlIGJlbG93J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAnMScgICAgdGhlbiBrbG9nICdlcmFzZSBhYm92ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gJzInICAgIHRoZW4ga2xvZyAnZXJhc2UgYWxsJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAnMycgICAgdGhlbiBrbG9nICdlcmFzZSBzYXZlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2cgJ2VyYXNlID8/PydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuICdIJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgcGFyYW0ubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbcm93LGNvbF0gPSBwYXJhbS5zcGxpdCAnOydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbCA/PSAxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdyA9IGNvbCA9IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyYXp5TmV3bGluZXMgPSAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSBkYXRhW2NpKzFdID09ICdcXHInIGFuZCBkYXRhW2NpKzJdID09ICdcXG4nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2kgKz0gMlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtsb2cgXCIgICAgbW92ZSBjdXJzb3Igcm93ICN7cm93fSBjb2wgI3tjb2x9XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB3aGVuICdoJyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBpZiBwYXJhbSA9PSAnPzI1J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBrbG9nICcgICAgc2hvdyBjdXJzb3InXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB3aGVuICdsJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGlmIHBhcmFtID09ICc/MjUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGtsb2cgJyAgICBoaWRlIGN1cnNvcidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAnXSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZGF0YVtjaSsxXSA9PSAnMCcgYW5kIGRhdGFbY2krMl0gPT0gJzsnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0KClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZSA9ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSBjb2RlICE9IDdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZSArPSBjaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBrbG9nIFwidGl0bGU6ICN7dGl0bGV9XCJcbiAgICAgICAgICAgICAgICAjIHdoZW4gMTMgIyBcXHJcbiAgICAgICAgICAgICAgICAgICAgIyBrbG9nICcgICAgXFxyJ1xuICAgICAgICAgICAgICAgIHdoZW4gMTAgIyBcXG4gXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB3aGlsZSBjcmF6eU5ld2xpbmVzID4gMFxuICAgICAgICAgICAgICAgICAgICAgICAgIyBrbG9nICdub3Qgc28gY3JhenknXG4gICAgICAgICAgICAgICAgICAgICAgICBAZWRpdG9yLmFwcGVuZFRleHQgJydcbiAgICAgICAgICAgICAgICAgICAgICAgIEBlZGl0b3Iuc2luZ2xlQ3Vyc29yQXRFbmQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgY3JhenlOZXdsaW5lcyAtPSAxXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBrbG9nIFwiPj4+fCN7bGluZX18XCJcbiAgICAgICAgICAgICAgICAgICAgQGVkaXRvci5hcHBlbmRJbnB1dFRleHQgbGluZVxuICAgICAgICAgICAgICAgICAgICBAZWRpdG9yLmFwcGVuZFRleHQgJydcbiAgICAgICAgICAgICAgICAgICAgQGVkaXRvci5zaW5nbGVDdXJzb3JBdEVuZCgpXG4gICAgICAgICAgICAgICAgICAgIGxpbmUgPSAnJ1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgbGluZSArPSBjaFxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgaWYgbGluZS50cmltKCkubGVuZ3RoXG4gICAgICAgICAgICBrbG9nIFwiISEhfCN7bGluZX18XCJcbiAgICAgICAgICAgIEBlZGl0b3IuYXBwZW5kSW5wdXRUZXh0IGxpbmVcbiAgICAgICAgICAgICMgQGVkaXRvci5zaW5nbGVDdXJzb3JBdEVuZCgpXG4gICAgICAgIGVsc2UgaWYgZGF0YSA9PSAnICdcbiAgICAgICAgICAgIEBlZGl0b3IuYXBwZW5kSW5wdXRUZXh0ICcgJ1xuXG5tb2R1bGUuZXhwb3J0cyA9IFBUWVxuIl19
//# sourceURL=../coffee/pty.coffee