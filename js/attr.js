
/*
 0000000   000000000  000000000  00000000 
000   000     000        000     000   000
000000000     000        000     0000000  
000   000     000        000     000   000
000   000     000        000     000   000
 */
var Attr, cache, colorDistance, colors, defAttr, log, matchColor, ref, valid;

ref = require('kxk'), valid = ref.valid, log = ref.log;

colors = require('./colors');

defAttr = (257 << 9) | 256;

cache = {};

colorDistance = function(r1, g1, b1, r2, g2, b2) {
  return Math.pow(30 * (r1 - r2), 2) + Math.pow(59 * (g1 - g2), 2) + Math.pow(11 * (b1 - b2), 2);
};

matchColor = function(r1, g1, b1) {
  var b2, c, diff, g2, hash, i, j, ldiff, li, r2, ref1;
  hash = (r1 << 16) | (g1 << 8) | b1;
  if (valid(cache[hash])) {
    return cache[hash];
  }
  ldiff = 2e308;
  li = -1;
  for (i = j = 0, ref1 = colors[258].length; 0 <= ref1 ? j < ref1 : j > ref1; i = 0 <= ref1 ? ++j : --j) {
    c = colors[258][i];
    r2 = c[0];
    g2 = c[1];
    b2 = c[2];
    diff = colorDistance(r1, g1, b1, r2, g2, b2);
    if (diff === 0) {
      li = i;
      break;
    }
    if (diff < ldiff) {
      ldiff = diff;
      li = i;
    }
  }
  cache[hash] = li;
  return cache[hash];
};

Attr = (function() {
  function Attr() {}

  Attr.set = function(params, curAttr) {
    var bg, fg, flags, i, p;
    if (params.length === 1 && params[0] === 0) {
      return defAttr;
    }
    flags = curAttr >> 18;
    fg = (curAttr >> 9) & 0x1ff;
    bg = curAttr & 0x1ff;
    i = 0;
    while (i < params.length) {
      p = params[i];
      switch (p) {
        case 0:
          flags = defAttr >> 18;
          fg = (defAttr >> 9) & 0x1ff;
          bg = defAttr & 0x1ff;
          break;
        case 1:
          flags &= ~32;
          flags |= 1;
          break;
        case 2:
          flags &= ~1;
          flags |= 32;
          break;
        case 4:
          flags |= 2;
          break;
        case 5:
          flags |= 4;
          break;
        case 7:
          flags |= 8;
          break;
        case 8:
          flags |= 16;
          break;
        case 22:
          flags &= ~1;
          flags &= ~32;
          break;
        case 24:
          flags &= ~2;
          break;
        case 25:
          flags &= ~4;
          break;
        case 27:
          flags &= ~8;
          break;
        case 28:
          flags &= ~16;
          break;
        case 39:
          fg = (defAttr >> 9) & 0x1ff;
          break;
        case 49:
          bg = defAttr & 0x1ff;
          break;
        case 38:
          if (params[i + 1] === 2) {
            i += 2;
            fg = matchColor(params[i] & 0xff, params[i + 1] & 0xff, params[i + 2] & 0xff);
            if (fg === -1) {
              fg = 0x1ff;
            }
            i += 2;
          } else if (params[i + 1] === 5) {
            fg = params[i + 2] & 0xff;
            i += 2;
          }
          break;
        case 48:
          if (params[i + 1] === 2) {
            i += 2;
            bg = matchColor(params[i] & 0xff, params[i + 1] & 0xff, params[i + 2] & 0xff);
            if (bg === -1) {
              bg = 0x1ff;
            }
            i += 2;
          } else if (params[i + 1] === 5) {
            bg = params[i + 2] & 0xff;
            i += 2;
          }
          break;
        default:
          if (p >= 30 && p <= 37) {
            fg = p - 30;
          } else if (p >= 40 && p <= 47) {
            bg = p - 40;
          } else if (p >= 90 && p <= 97) {
            fg = p - 90 + 8;
          } else if (p >= 100 && p <= 107) {
            bg = p - 100 + 8;
          } else {
            log("unhandled attr " + p);
          }
      }
      i += 1;
    }
    return (flags << 18) | (fg << 9) | bg;
  };

  return Attr;

})();

module.exports = Attr;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXR0ci5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxNQUFpQixPQUFBLENBQVEsS0FBUixDQUFqQixFQUFFLGlCQUFGLEVBQVM7O0FBRVQsTUFBQSxHQUFTLE9BQUEsQ0FBUSxVQUFSOztBQUNULE9BQUEsR0FBVSxDQUFDLEdBQUEsSUFBTyxDQUFSLENBQUEsR0FBYTs7QUFDdkIsS0FBQSxHQUFROztBQUVSLGFBQUEsR0FBZ0IsU0FBQyxFQUFELEVBQUssRUFBTCxFQUFTLEVBQVQsRUFBYSxFQUFiLEVBQWlCLEVBQWpCLEVBQXFCLEVBQXJCO1NBQ1osSUFBSSxDQUFDLEdBQUwsQ0FBUyxFQUFBLEdBQUssQ0FBQyxFQUFBLEdBQUssRUFBTixDQUFkLEVBQXlCLENBQXpCLENBQUEsR0FBOEIsSUFBSSxDQUFDLEdBQUwsQ0FBUyxFQUFBLEdBQUssQ0FBQyxFQUFBLEdBQUssRUFBTixDQUFkLEVBQXlCLENBQXpCLENBQTlCLEdBQTRELElBQUksQ0FBQyxHQUFMLENBQVMsRUFBQSxHQUFLLENBQUMsRUFBQSxHQUFLLEVBQU4sQ0FBZCxFQUF5QixDQUF6QjtBQURoRDs7QUFHaEIsVUFBQSxHQUFhLFNBQUMsRUFBRCxFQUFLLEVBQUwsRUFBUyxFQUFUO0FBRVQsTUFBQTtFQUFBLElBQUEsR0FBTyxDQUFDLEVBQUEsSUFBTSxFQUFQLENBQUEsR0FBYSxDQUFDLEVBQUEsSUFBTSxDQUFQLENBQWIsR0FBeUI7RUFFaEMsSUFBRyxLQUFBLENBQU0sS0FBTSxDQUFBLElBQUEsQ0FBWixDQUFIO0FBQ0ksV0FBTyxLQUFNLENBQUEsSUFBQSxFQURqQjs7RUFHQSxLQUFBLEdBQVE7RUFDUixFQUFBLEdBQUssQ0FBQztBQUVOLE9BQVMsZ0dBQVQ7SUFDSSxDQUFBLEdBQUssTUFBTyxDQUFBLEdBQUEsQ0FBSyxDQUFBLENBQUE7SUFDakIsRUFBQSxHQUFLLENBQUUsQ0FBQSxD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YjtNQXVFQSxDQUFBLElBQUs7SUExRVQ7QUE0RUEsV0FBTyxDQUFDLEtBQUEsSUFBUyxFQUFWLENBQUEsR0FBZ0IsQ0FBQyxFQUFBLElBQU0sQ0FBUCxDQUFoQixHQUE0QjtFQXRGakM7Ozs7OztBQXdGVixNQUFNLENBQUMsT0FBUCxHQUFpQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgXG4wMDAgICAwMDAgICAgIDAwMCAgICAgICAgMDAwICAgICAwMDAgICAwMDBcbjAwMDAwMDAwMCAgICAgMDAwICAgICAgICAwMDAgICAgIDAwMDAwMDAgIFxuMDAwICAgMDAwICAgICAwMDAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwXG4wMDAgICAwMDAgICAgIDAwMCAgICAgICAgMDAwICAgICAwMDAgICAwMDBcbiMjI1xuXG57IHZhbGlkLCBsb2cgfSA9IHJlcXVpcmUgJ2t4aydcbiAgICAgICAgXG5jb2xvcnMgPSByZXF1aXJlICcuL2NvbG9ycydcbmRlZkF0dHIgPSAoMjU3IDw8IDkpIHwgMjU2XG5jYWNoZSA9IHt9XG5cbmNvbG9yRGlzdGFuY2UgPSAocjEsIGcxLCBiMSwgcjIsIGcyLCBiMikgLT5cbiAgICBNYXRoLnBvdygzMCAqIChyMSAtIHIyKSwgMikgKyBNYXRoLnBvdyg1OSAqIChnMSAtIGcyKSwgMikgKyBNYXRoLnBvdygxMSAqIChiMSAtIGIyKSwgMilcblxubWF0Y2hDb2xvciA9IChyMSwgZzEsIGIxKSAtPlxuICAgIFxuICAgIGhhc2ggPSAocjEgPDwgMTYpIHwgKGcxIDw8IDgpIHwgYjFcbiAgICBcbiAgICBpZiB2YWxpZCBjYWNoZVtoYXNoXVxuICAgICAgICByZXR1cm4gY2FjaGVbaGFzaF1cbiAgICBcbiAgICBsZGlmZiA9IEluZmluaXR5XG4gICAgbGkgPSAtMVxuICAgIFxuICAgIGZvciBpIGluIFswLi4uY29sb3JzWzI1OF0ubGVuZ3RoXVxuICAgICAgICBjICA9IGNvbG9yc1syNThdW2ldXG4gICAgICAgIHIyID0gY1swXVxuICAgICAgICBnMiA9IGNbMV1cbiAgICAgICAgYjIgPSBjWzJdXG4gICAgICAgIFxuICAgICAgICBkaWZmID0gY29sb3JEaXN0YW5jZSByMSwgZzEsIGIxLCByMiwgZzIsIGIyXG4gICAgICAgIFxuICAgICAgICBpZiBkaWZmID09IDAgXG4gICAgICAgICAgICBsaSA9IGlcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgIFxuICAgICAgICBpZiBkaWZmIDwgbGRpZmYgXG4gICAgICAgICAgICBsZGlmZiA9IGRpZmZcbiAgICAgICAgICAgIGxpID0gaVxuICAgICAgICBcbiAgICBjYWNoZVtoYXNoXSA9IGxpXG4gICAgY2FjaGVbaGFzaF1cblxuY2xhc3MgQXR0clxuICAgIFxuICAgIEBzZXQ6IChwYXJhbXMsIGN1ckF0dHIpIC0+XG5cbiAgICAgICAgaWYgcGFyYW1zLmxlbmd0aCA9PSAxIGFuZCBwYXJhbXNbMF0gPT0gMFxuICAgICAgICAgICAgcmV0dXJuIGRlZkF0dHJcbiAgICBcbiAgICAgICAgZmxhZ3MgPSBjdXJBdHRyID4+IDE4XG4gICAgICAgIGZnICAgID0gKGN1ckF0dHIgPj4gOSkgJiAweDFmZlxuICAgICAgICBiZyAgICA9IGN1ckF0dHIgJiAweDFmZlxuICAgIFxuICAgICAgICBpID0gMFxuICAgICAgICB3aGlsZSBpIDwgcGFyYW1zLmxlbmd0aFxuICAgICAgICAgICAgcCA9IHBhcmFtc1tpXVxuICAgICAgICAgICAgIyBsb2cgJ3A6JywgcFxuICAgICAgICAgICAgc3dpdGNoIHBcbiAgICAgICAgICAgICAgICB3aGVuIDAgIyBkZWZhdWx0XG4gICAgICAgICAgICAgICAgICAgIGZsYWdzID0gZGVmQXR0ciA+PiAxOFxuICAgICAgICAgICAgICAgICAgICBmZyA9IChkZWZBdHRyID4+IDkpICYgMHgxZmZcbiAgICAgICAgICAgICAgICAgICAgYmcgPSBkZWZBdHRyICYgMHgxZmZcbiAgICAgICAgICAgICAgICB3aGVuIDEgIyBib2xkIHRleHRcbiAgICAgICAgICAgICAgICAgICAgZmxhZ3MgJj0gfjMyXG4gICAgICAgICAgICAgICAgICAgIGZsYWdzIHw9IDFcbiAgICAgICAgICAgICAgICB3aGVuIDIgIyBkaW1cbiAgICAgICAgICAgICAgICAgICAgZmxhZ3MgJj0gfjFcbiAgICAgICAgICAgICAgICAgICAgZmxhZ3MgfD0gMzJcbiAgICAgICAgICAgICAgICB3aGVuIDQgIyB1bmRlcmxpbmVkIHRleHRcbiAgICAgICAgICAgICAgICAgICAgZmxhZ3MgfD0gMlxuICAgICAgICAgICAgICAgIHdoZW4gNSAjIGJsaW5rXG4gICAgICAgICAgICAgICAgICAgIGZsYWdzIHw9IDRcbiAgICAgICAgICAgICAgICB3aGVuIDcgIyBpbnZlcnNlIGFuZCBwb3NpdGl2ZVxuICAgICAgICAgICAgICAgICAgICAjIHRlc3Qgd2l0aDogZWNobyAtZSAnXFxlWzMxbVxcZVs0Mm1oZWxsb1xcZVs3bXdvcmxkXFxlWzI3bWhpXFxlW20nXG4gICAgICAgICAgICAgICAgICAgIGZsYWdzIHw9IDhcbiAgICAgICAgICAgICAgICB3aGVuIDggIyBpbnZpc2libGVcbiAgICAgICAgICAgICAgICAgICAgZmxhZ3MgfD0gMTZcbiAgICAgICAgICAgICAgICB3aGVuIDIyICMgbm90IGJvbGRcbiAgICAgICAgICAgICAgICAgICAgZmxhZ3MgJj0gfjFcbiAgICAgICAgICAgICAgICAgICAgZmxhZ3MgJj0gfjMyXG4gICAgICAgICAgICAgICAgd2hlbiAyNCAjIG5vdCB1bmRlcmxpbmVkXG4gICAgICAgICAgICAgICAgICAgIGZsYWdzICY9IH4yXG4gICAgICAgICAgICAgICAgd2hlbiAyNSAjIG5vdCBibGlua1xuICAgICAgICAgICAgICAgICAgICBmbGFncyAmPSB+NFxuICAgICAgICAgICAgICAgIHdoZW4gMjcgIyBub3QgaW52ZXJzZVxuICAgICAgICAgICAgICAgICAgICBmbGFncyAmPSB+OFxuICAgICAgICAgICAgICAgIHdoZW4gMjggIyBub3QgaW52aXNpYmxlXG4gICAgICAgICAgICAgICAgICAgIGZsYWdzICY9IH4xNlxuICAgICAgICAgICAgICAgIHdoZW4gMzkgIyByZXNldCBmZ1xuICAgICAgICAgICAgICAgICAgICBmZyA9IChkZWZBdHRyID4+IDkpICYgMHgxZmZcbiAgICAgICAgICAgICAgICB3aGVuIDQ5IyByZXNldCBiZ1xuICAgICAgICAgICAgICAgICAgICBiZyA9IGRlZkF0dHIgJiAweDFmZlxuICAgICAgICAgICAgICAgIHdoZW4gMzggIyBmZyBjb2xvciAyNTZcbiAgICAgICAgICAgICAgICAgICAgaWYgcGFyYW1zW2kgKyAxXSA9PSAyXG4gICAgICAgICAgICAgICAgICAgICAgICBpICs9IDJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZnID0gbWF0Y2hDb2xvcihwYXJhbXNbaV0gJiAweGZmLCBwYXJhbXNbaSArIDFdICYgMHhmZiwgcGFyYW1zW2kgKyAyXSAmIDB4ZmYpXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiBmZyA9PSAtMSB0aGVuIGZnID0gMHgxZmZcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gMlxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIHBhcmFtc1tpICsgMV0gPT0gNVxuICAgICAgICAgICAgICAgICAgICAgICAgZmcgPSBwYXJhbXNbaSArIDJdICYgMHhmZlxuICAgICAgICAgICAgICAgICAgICAgICAgaSArPSAyXG4gICAgICAgICAgICAgICAgd2hlbiA0OCAjIGJnIGNvbG9yIDI1NlxuICAgICAgICAgICAgICAgICAgICBpZiBwYXJhbXNbaSArIDFdID09IDJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gMlxuICAgICAgICAgICAgICAgICAgICAgICAgYmcgPSBtYXRjaENvbG9yKHBhcmFtc1tpXSAmIDB4ZmYsIHBhcmFtc1tpICsgMV0gJiAweGZmLCBwYXJhbXNbaSArIDJdICYgMHhmZilcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJnID09IC0xIHRoZW4gYmcgPSAweDFmZlxuICAgICAgICAgICAgICAgICAgICAgICAgaSArPSAyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgcGFyYW1zW2kgKyAxXSA9PSA1XG4gICAgICAgICAgICAgICAgICAgICAgICBiZyA9IHBhcmFtc1tpICsgMl0gJiAweGZmXG4gICAgICAgICAgICAgICAgICAgICAgICBpICs9IDJcblxuICAgICAgICAgICAgICAgICMgd2hlbiAxMDAgIyByZXNldCBmZy9iZ1xuICAgICAgICAgICAgICAgICAgICAjIGZnID0gKGRlZkF0dHIgPj4gOSkgJiAweDFmZlxuICAgICAgICAgICAgICAgICAgICAjIGJnID0gZGVmQXR0ciAmIDB4MWZmXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgaWYgcCA+PSAzMCBhbmQgcCA8PSAzN1xuICAgICAgICAgICAgICAgICAgICAgICAgZmcgPSBwIC0gMzBcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiBwID49IDQwIGFuZCBwIDw9IDQ3XG4gICAgICAgICAgICAgICAgICAgICAgICBiZyA9IHAgLSA0MFxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIHAgPj0gOTAgYW5kIHAgPD0gOTdcbiAgICAgICAgICAgICAgICAgICAgICAgIGZnID0gcCAtIDkwICsgOFxuICAgICAgICAgICAgICAgICAgICAgICAgIyBmbGFncyB8PSAyIGlmIHAgPT0gOTZcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiBwID49IDEwMCBhbmQgcCA8PSAxMDdcbiAgICAgICAgICAgICAgICAgICAgICAgIGJnID0gcCAtIDEwMCArIDhcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nIFwidW5oYW5kbGVkIGF0dHIgI3twfVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIGkgKz0gMVxuICAgIFxuICAgICAgICByZXR1cm4gKGZsYWdzIDw8IDE4KSB8IChmZyA8PCA5KSB8IGJnXG5cbm1vZHVsZS5leHBvcnRzID0gQXR0clxuIl19
//# sourceURL=../coffee/attr.coffee