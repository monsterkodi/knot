// koffee 1.12.0

/*
000   000  00000000   0000000  000   000  000000000  000      0000000     0000000   00000000   
000   000  000   000     000   0000  000     000     000      000   000  000   000  000   000  
000000000  0000000      000    000 0 000     000     000      0000000    000000000  0000000    
000   000  000   000   000     000  0000     000     000      000   000  000   000  000   000  
000   000  000   000  0000000  000   000     000     0000000  0000000    000   000  000   000
 */
var Hrzntlbar, Scroller, clamp, drag, elem, ref,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('kxk'), clamp = ref.clamp, elem = ref.elem, drag = ref.drag;

Scroller = require('../tools/scroller');

Hrzntlbar = (function() {
    function Hrzntlbar(editor) {
        this.editor = editor;
        this.update = bind(this.update, this);
        this.onDrag = bind(this.onDrag, this);
        this.editor.on('linesShown', this.update);
        this.editor.on('linesAppended', this.update);
        this.elem = elem({
            "class": 'scrollbar bottom'
        });
        this.editor.view.appendChild(this.elem);
        this.handle = elem({
            "class": 'scrollhandle bottom'
        });
        this.elem.appendChild(this.handle);
        this.scrollX = 0;
        this.drag = new drag({
            target: this.elem,
            onMove: this.onDrag,
            cursor: 'ew-resize'
        });
    }

    Hrzntlbar.prototype.del = function() {};

    Hrzntlbar.prototype.onDrag = function(drag) {
        var delta;
        delta = (drag.delta.x / this.editor.layersWidth) * this.editor.numColumns() * this.editor.size.charWidth;
        this.editor.scroll.horizontal(delta);
        return this.update();
    };

    Hrzntlbar.prototype.update = function() {
        var bw, cf, cs, longColor, scrollLeft, scrollWidth, shortColor;
        bw = this.editor.numColumns() * this.editor.size.charWidth;
        if (bw <= this.editor.layersWidth) {
            this.elem.style.display = 'none';
            this.handle.style.left = "0";
            this.handle.style.height = "0";
            return this.handle.style.width = "0";
        } else {
            this.elem.style.display = 'initial';
            scrollLeft = this.editor.layersWidth * this.editor.layerScroll.scrollLeft / bw;
            scrollWidth = this.editor.layersWidth * this.editor.layersWidth / bw;
            this.handle.style.left = scrollLeft + "px";
            this.handle.style.width = scrollWidth + "px";
            this.handle.style.height = "2px";
            cf = 1 - clamp(0, 1, (scrollWidth - 10) / 200);
            longColor = Scroller.colorForClass('scroller long');
            shortColor = Scroller.colorForClass('scroller short');
            cs = Scroller.fadeColor(longColor, shortColor, cf);
            return this.handle.style.backgroundColor = cs;
        }
    };

    return Hrzntlbar;

})();

module.exports = Hrzntlbar;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHJ6bnRsYmFyLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uL2NvZmZlZS9lZGl0b3IiLCJzb3VyY2VzIjpbImhyem50bGJhci5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUEsMkNBQUE7SUFBQTs7QUFRQSxNQUF3QixPQUFBLENBQVEsS0FBUixDQUF4QixFQUFFLGlCQUFGLEVBQVMsZUFBVCxFQUFlOztBQUVmLFFBQUEsR0FBVyxPQUFBLENBQVEsbUJBQVI7O0FBRUw7SUFFQyxtQkFBQyxNQUFEO1FBQUMsSUFBQyxDQUFBLFNBQUQ7OztRQUVBLElBQUMsQ0FBQSxNQUFNLENBQUMsRUFBUixDQUFXLFlBQVgsRUFBMkIsSUFBQyxDQUFBLE1BQTVCO1FBQ0EsSUFBQyxDQUFBLE1BQU0sQ0FBQyxFQUFSLENBQVcsZUFBWCxFQUEyQixJQUFDLENBQUEsTUFBNUI7UUFFQSxJQUFDLENBQUEsSUFBRCxHQUFRLElBQUEsQ0FBSztZQUFBLENBQUEsS0FBQSxDQUFBLEVBQU8sa0JBQVA7U0FBTDtRQUNSLElBQUMsQ0FBQSxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQWIsQ0FBeUIsSUFBQyxDQUFBLElBQTFCO1FBRUEsSUFBQyxDQUFBLE1BQUQsR0FBVSxJQUFBLENBQUs7WUFBQSxDQUFBLEtBQUEsQ0FBQSxFQUFPLHFCQUFQO1NBQUw7UUFDVixJQUFDLENBQUEsSUFBSSxDQUFDLFdBQU4sQ0FBa0IsSUFBQyxDQUFBLE1BQW5CO1FBRUEsSUFBQyxDQUFBLE9BQUQsR0FBWTtRQUVaLElBQUMsQ0FBQSxJQUFELEdBQVEsSUFBSSxJQUFKLENBQ0o7WUFBQSxNQUFBLEVBQVMsSUFBQyxDQUFBLElBQVY7WUFDQSxNQUFBLEVBQVMsSUFBQyxDQUFBLE1BRFY7WUFFQSxNQUFBLEVBQVMsV0FGVDtTQURJO0lBYlQ7O3dCQWtCSCxHQUFBLEdBQUssU0FBQSxHQUFBOzt3QkFRTCxNQUFBLEdBQVEsU0FBQyxJQUFEO0FBRUosWUFBQTtRQUFBLEtBQUEsR0FBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBWCxHQUFlLElBQUMsQ0FBQSxNQUFNLENBQUMsV0FBeEIsQ0FBQSxHQUF1QyxJQUFDLENBQUEsTUFBTSxDQUFDLFVBQVIsQ0FBQSxDQUF2QyxHQUE4RCxJQUFDLENBQUEsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNuRixJQUFDLENBQUEsTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFmLENBQTBCLEtBQTFCO2VBQ0EsSUFBQyxDQUFBLE1BQUQsQ0FBQTtJQUpJOzt3QkFZUixNQUFBLEdBQVEsU0FBQTtBQUVKLFlBQUE7UUFBQSxFQUFBLEdBQUssSUFBQyxDQUFBLE1BQU0sQ0FBQyxVQUFSLENBQUEsQ0FBQSxHQUF1QixJQUFDLENBQUEsTUFBTSxDQUFDLElBQUksQ0FBQztRQUV6QyxJQUFHLEVBQUEsSUFBTSxJQUFDLENBQUEsTUFBTSxDQUFDLFdBQWpCO1lBRUksSUFBQyxDQUFBLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBWixHQUF3QjtZQUN4QixJQUFDLENBQUEsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFkLEdBQXdCO1lBQ3hCLElBQUMsQ0FBQSxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQWQsR0FBd0I7bUJBQ3hCLElBQUMsQ0FBQSxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQWQsR0FBd0IsSUFMNUI7U0FBQSxNQUFBO1lBUUksSUFBQyxDQUFBLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBWixHQUF3QjtZQUN4QixVQUFBLEdBQWUsSUFBQyxDQUFBLE1BQU0sQ0FBQyxXQUFSLEdBQXNCLElBQUMsQ0FBQSxNQUFNLENBQUMsV0FBVyxDQUFDLFVBQTFDLEdBQXVEO1lBQ3RFLFdBQUEsR0FBZSxJQUFDLENBQUEsTUFBTSxDQUFDLFdBQVIsR0FBc0IsSUFBQyxDQUFBLE1BQU0sQ0FBQyxXQUE5QixHQUE0QztZQUUzRCxJQUFDLENBQUEsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFkLEdBQTBCLFVBQUQsR0FBWTtZQUNyQyxJQUFDLENBQUEsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFkLEdBQTBCLFdBQUQsR0FBYTtZQUN0QyxJQUFDLENBQUEsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFkLEdBQXVCO1lBRXZCLEVBQUEsR0FBSyxDQUFBLEdBQUksS0FBQSxDQUFNLENBQU4sRUFBUyxDQUFULEVBQVksQ0FBQyxXQUFBLEdBQVksRUFBYixDQUFBLEdBQWlCLEdBQTdCO1lBRVQsU0FBQSxHQUFhLFFBQVEsQ0FBQyxhQUFULENBQXVCLGVBQXZCO1lBQ2IsVUFBQSxHQUFhLFFBQVEsQ0FBQyxhQUFULENBQXVCLGdCQUF2QjtZQUViLEVBQUEsR0FBSyxRQUFRLENBQUMsU0FBVCxDQUFtQixTQUFuQixFQUE4QixVQUE5QixFQUEwQyxFQUExQzttQkFDTCxJQUFDLENBQUEsTUFBTSxDQUFDLEtBQUssQ0FBQyxlQUFkLEdBQWdDLEdBdEJwQzs7SUFKSTs7Ozs7O0FBNEJaLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDAgIDAwMCAgICAgIDAwMDAwMDAgICAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIFxuMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgIDAwMDAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbjAwMDAwMDAwMCAgMDAwMDAwMCAgICAgIDAwMCAgICAwMDAgMCAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgMDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMDAwMDAgICAgXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAwMDAwICAgICAwMDAgICAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAwMDAwICAwMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiMjI1xuXG57IGNsYW1wLCBlbGVtLCBkcmFnIH0gPSByZXF1aXJlICdreGsnXG5cblNjcm9sbGVyID0gcmVxdWlyZSAnLi4vdG9vbHMvc2Nyb2xsZXInXG5cbmNsYXNzIEhyem50bGJhclxuXG4gICAgQDogKEBlZGl0b3IpIC0+XG4gICAgICAgIFxuICAgICAgICBAZWRpdG9yLm9uICdsaW5lc1Nob3duJyAgICBAdXBkYXRlXG4gICAgICAgIEBlZGl0b3Iub24gJ2xpbmVzQXBwZW5kZWQnIEB1cGRhdGVcblxuICAgICAgICBAZWxlbSA9IGVsZW0gY2xhc3M6ICdzY3JvbGxiYXIgYm90dG9tJ1xuICAgICAgICBAZWRpdG9yLnZpZXcuYXBwZW5kQ2hpbGQgQGVsZW1cblxuICAgICAgICBAaGFuZGxlID0gZWxlbSBjbGFzczogJ3Njcm9sbGhhbmRsZSBib3R0b20nXG4gICAgICAgIEBlbGVtLmFwcGVuZENoaWxkIEBoYW5kbGVcblxuICAgICAgICBAc2Nyb2xsWCAgPSAwXG5cbiAgICAgICAgQGRyYWcgPSBuZXcgZHJhZ1xuICAgICAgICAgICAgdGFyZ2V0OiAgQGVsZW1cbiAgICAgICAgICAgIG9uTW92ZTogIEBvbkRyYWdcbiAgICAgICAgICAgIGN1cnNvcjogICdldy1yZXNpemUnXG5cbiAgICBkZWw6IC0+XG5cbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMCAgMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4gICAgIyAwMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMFxuXG4gICAgb25EcmFnOiAoZHJhZykgPT5cblxuICAgICAgICBkZWx0YSA9IChkcmFnLmRlbHRhLnggLyBAZWRpdG9yLmxheWVyc1dpZHRoKSAqIEBlZGl0b3IubnVtQ29sdW1ucygpICogQGVkaXRvci5zaXplLmNoYXJXaWR0aFxuICAgICAgICBAZWRpdG9yLnNjcm9sbC5ob3Jpem9udGFsIGRlbHRhXG4gICAgICAgIEB1cGRhdGUoKVxuXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMCAgICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwXG4gICAgIyAgMDAwMDAwMCAgIDAwMCAgICAgICAgMDAwMDAwMCAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwMDAwMDBcblxuICAgIHVwZGF0ZTogPT5cblxuICAgICAgICBidyA9IEBlZGl0b3IubnVtQ29sdW1ucygpICogQGVkaXRvci5zaXplLmNoYXJXaWR0aFxuICAgICAgICBcbiAgICAgICAgaWYgYncgPD0gQGVkaXRvci5sYXllcnNXaWR0aFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBAZWxlbS5zdHlsZS5kaXNwbGF5ICAgPSAnbm9uZSdcbiAgICAgICAgICAgIEBoYW5kbGUuc3R5bGUubGVmdCAgICA9IFwiMFwiXG4gICAgICAgICAgICBAaGFuZGxlLnN0eWxlLmhlaWdodCAgPSBcIjBcIlxuICAgICAgICAgICAgQGhhbmRsZS5zdHlsZS53aWR0aCAgID0gXCIwXCJcbiAgICAgICAgICAgIFxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBAZWxlbS5zdHlsZS5kaXNwbGF5ICAgPSAnaW5pdGlhbCdcbiAgICAgICAgICAgIHNjcm9sbExlZnQgICA9IEBlZGl0b3IubGF5ZXJzV2lkdGggKiBAZWRpdG9yLmxheWVyU2Nyb2xsLnNjcm9sbExlZnQgLyBid1xuICAgICAgICAgICAgc2Nyb2xsV2lkdGggID0gQGVkaXRvci5sYXllcnNXaWR0aCAqIEBlZGl0b3IubGF5ZXJzV2lkdGggLyBid1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBAaGFuZGxlLnN0eWxlLmxlZnQgICA9IFwiI3tzY3JvbGxMZWZ0fXB4XCJcbiAgICAgICAgICAgIEBoYW5kbGUuc3R5bGUud2lkdGggID0gXCIje3Njcm9sbFdpZHRofXB4XCJcbiAgICAgICAgICAgIEBoYW5kbGUuc3R5bGUuaGVpZ2h0ID0gXCIycHhcIlxuXG4gICAgICAgICAgICBjZiA9IDEgLSBjbGFtcCAwLCAxLCAoc2Nyb2xsV2lkdGgtMTApLzIwMFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBsb25nQ29sb3IgID0gU2Nyb2xsZXIuY29sb3JGb3JDbGFzcyAnc2Nyb2xsZXIgbG9uZydcbiAgICAgICAgICAgIHNob3J0Q29sb3IgPSBTY3JvbGxlci5jb2xvckZvckNsYXNzICdzY3JvbGxlciBzaG9ydCdcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY3MgPSBTY3JvbGxlci5mYWRlQ29sb3IgbG9uZ0NvbG9yLCBzaG9ydENvbG9yLCBjZlxuICAgICAgICAgICAgQGhhbmRsZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjc1xuXG5tb2R1bGUuZXhwb3J0cyA9IEhyem50bGJhclxuIl19
//# sourceURL=../../coffee/editor/hrzntlbar.coffee