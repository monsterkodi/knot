// koffee 1.4.0

/*
00     00   0000000   00000000          0000000   0000000  00000000    0000000   000      000    
000   000  000   000  000   000        000       000       000   000  000   000  000      000    
000000000  000000000  00000000         0000000   000       0000000    000   000  000      000    
000 0 000  000   000  000                   000  000       000   000  000   000  000      000    
000   000  000   000  000              0000000    0000000  000   000   0000000   0000000  0000000
 */
var MapScroll, clamp, events, klog, ref,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

ref = require('kxk'), klog = ref.klog, clamp = ref.clamp;

events = require('events');

MapScroll = (function(superClass) {
    extend(MapScroll, superClass);

    function MapScroll(cfg) {
        this.setLineHeight = bind(this.setLineHeight, this);
        this.setNumLines = bind(this.setNumLines, this);
        this.setViewHeight = bind(this.setViewHeight, this);
        this.deleteLine = bind(this.deleteLine, this);
        this.insertLine = bind(this.insertLine, this);
        this.setTop = bind(this.setTop, this);
        this.by = bind(this.by, this);
        this.to = bind(this.to, this);
        this.reset = bind(this.reset, this);
        var ref1, ref2, ref3, ref4;
        MapScroll.__super__.constructor.call(this);
        this.lineHeight = (ref1 = cfg.lineHeight) != null ? ref1 : 0;
        this.viewHeight = (ref2 = cfg.viewHeight) != null ? ref2 : 0;
        this.exposeMax = (ref3 = cfg.exposeMax) != null ? ref3 : -4;
        this.smooth = (ref4 = cfg.smooth) != null ? ref4 : true;
        this.init();
    }

    MapScroll.prototype.init = function() {
        this.scroll = 0;
        this.offsetTop = 0;
        this.offsetSmooth = 0;
        this.fullHeight = 0;
        this.numLines = 0;
        this.top = 0;
        this.bot = 0;
        this.exposed = 0;
        this.exposeTop = 0;
        this.exposeBot = -1;
        this.calc();
        return this.offsetTop = -1;
    };

    MapScroll.prototype.calc = function() {
        this.scrollMax = Math.max(0, this.fullHeight - this.viewHeight);
        this.fullLines = Math.floor(this.viewHeight / this.lineHeight);
        this.viewLines = Math.ceil(this.viewHeight / this.lineHeight);
        this.linesHeight = this.viewLines * this.lineHeight;
        if (this.exposeMax < 0) {
            this.exposeNum = -this.exposeMax * this.viewLines;
        } else {
            this.exposeNum = this.exposeMax;
        }
        return this.exposeHeight = this.exposeNum * this.lineHeight;
    };

    MapScroll.prototype.info = function() {
        return {
            topbot: this.top + " .. " + this.bot + " = " + (this.bot - this.top) + " / " + this.numLines + " lines",
            expose: this.exposeTop + " .. " + this.exposeBot + " = " + (this.exposeBot - this.exposeTop) + " / " + this.exposeNum + " px " + this.exposeHeight,
            scroll: this.scroll + " offsetTop " + this.offsetTop + " scrollMax " + this.scrollMax + " fullLines " + this.fullLines + " viewLines " + this.viewLines + " viewHeight " + this.viewHeight
        };
    };

    MapScroll.prototype.reset = function() {
        this.emit('clearLines');
        return this.init();
    };

    MapScroll.prototype.to = function(p) {
        return this.by(p - this.scroll);
    };

    MapScroll.prototype.by = function(delta) {
        var offset, scroll, top;
        scroll = this.scroll;
        if (Number.isNaN(delta)) {
            delta = 0;
        }
        this.scroll = parseInt(clamp(0, this.scrollMax, this.scroll + delta));
        top = parseInt(this.scroll / this.lineHeight);
        this.offsetSmooth = this.scroll - top * this.lineHeight;
        this.setTop(top);
        offset = 0;
        if (this.smooth) {
            offset += this.offsetSmooth;
        }
        offset += (top - this.exposeTop) * this.lineHeight;
        if (offset !== this.offsetTop || scroll !== this.scroll) {
            this.offsetTop = parseInt(offset);
            return this.emit('scroll', this.scroll, this.offsetTop);
        }
    };

    MapScroll.prototype.setTop = function(top) {
        var n, num, oldBot, oldTop;
        if (this.exposeBot < 0 && this.numLines < 1) {
            return;
        }
        oldTop = this.top;
        oldBot = this.bot;
        this.top = top;
        this.bot = Math.min(this.top + this.viewLines, this.numLines - 1);
        if (oldTop === this.top && oldBot === this.bot && this.exposeBot >= this.bot) {
            return;
        }
        if ((this.top >= this.exposeBot) || (this.bot <= this.exposeTop)) {
            this.emit('clearLines');
            this.exposeTop = this.top;
            this.exposeBot = this.bot;
            num = this.bot - this.top + 1;
            if (num > 0) {
                this.emit('exposeLines', {
                    top: this.top,
                    bot: this.bot,
                    num: num
                });
                this.emit('scroll', this.scroll, this.offsetTop);
            }
            return;
        }
        if (this.top < this.exposeTop) {
            oldTop = this.exposeTop;
            this.exposeTop = Math.max(0, this.top - (Math.min(this.viewLines, this.exposeNum - this.viewLines)));
            num = oldTop - this.exposeTop;
            if (num > 0) {
                this.emit('exposeLines', {
                    top: this.exposeTop,
                    bot: oldTop - 1,
                    num: num
                });
            }
        }
        while (this.bot > this.exposeBot) {
            this.exposeBot += 1;
            this.emit('exposeLine', this.exposeBot);
        }
        if (this.exposeBot - this.exposeTop + 1 > this.exposeNum) {
            num = this.exposeBot - this.exposeTop + 1 - this.exposeNum;
            if (this.top > oldTop) {
                n = clamp(0, this.top - this.exposeTop, num);
                this.exposeTop += n;
                return this.emit('vanishLines', {
                    top: n
                });
            } else {
                n = clamp(0, this.exposeBot - this.bot, num);
                this.exposeBot -= n;
                return this.emit('vanishLines', {
                    bot: n
                });
            }
        }
    };

    MapScroll.prototype.insertLine = function(li, oi) {
        if (this.lineIndexIsInExpose(oi)) {
            this.exposeBot += 1;
        }
        if (this.lineIndexIsInView(oi)) {
            this.bot += 1;
        }
        if (oi < this.top) {
            this.top += 1;
        }
        this.numLines += 1;
        this.fullHeight = this.numLines * this.lineHeight;
        return this.calc();
    };

    MapScroll.prototype.deleteLine = function(li, oi) {
        if (this.lineIndexIsInExpose(oi) || this.numLines < this.exposeNum) {
            this.exposeBot -= 1;
        }
        if (this.lineIndexIsInView(oi)) {
            return this.bot -= 1;
        }
    };

    MapScroll.prototype.lineIndexIsInView = function(li) {
        if ((this.top <= li && li <= this.bot)) {
            return true;
        }
        return this.bot - this.top + 1 < this.fullLines;
    };

    MapScroll.prototype.lineIndexIsInExpose = function(li) {
        if ((this.exposeTop <= li && li <= this.exposeBot)) {
            return true;
        }
        return this.exposeBot - this.exposeTop + 1 < this.exposeNum;
    };

    MapScroll.prototype.setViewHeight = function(h) {
        if (this.viewHeight !== h) {
            this.viewHeight = h;
            this.calc();
            return this.by(0);
        }
    };

    MapScroll.prototype.setNumLines = function(n) {
        if (this.numLines !== n) {
            this.numLines = n;
            this.fullHeight = this.numLines * this.lineHeight;
            if (this.numLines) {
                this.calc();
                return this.by(0);
            } else {
                this.init();
                return this.emit('clearLines');
            }
        }
    };

    MapScroll.prototype.setLineHeight = function(h) {
        if (this.lineHeight !== h) {
            this.lineHeight = h;
            this.fullHeight = this.numLines * this.lineHeight;
            this.calc();
            return this.by(0);
        }
    };

    return MapScroll;

})(events);

module.exports = MapScroll;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFwc2Nyb2xsLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSxtQ0FBQTtJQUFBOzs7O0FBUUEsTUFBa0IsT0FBQSxDQUFRLEtBQVIsQ0FBbEIsRUFBRSxlQUFGLEVBQVE7O0FBRVIsTUFBQSxHQUFTLE9BQUEsQ0FBUSxRQUFSOztBQUVIOzs7SUFFQyxtQkFBQyxHQUFEOzs7Ozs7Ozs7O0FBRUMsWUFBQTtRQUFBLHlDQUFBO1FBQ0EsSUFBQyxDQUFBLFVBQUQsNENBQStCO1FBQy9CLElBQUMsQ0FBQSxVQUFELDRDQUErQjtRQUMvQixJQUFDLENBQUEsU0FBRCwyQ0FBOEIsQ0FBQztRQUMvQixJQUFDLENBQUEsTUFBRCx3Q0FBMkI7UUFDM0IsSUFBQyxDQUFBLElBQUQsQ0FBQTtJQVBEOzt3QkFlSCxJQUFBLEdBQU0sU0FBQTtRQUNGLElBQUMsQ0FBQSxNQUFELEdBQWlCO1FBQ2pCLElBQUMsQ0FBQSxTQUFELEdBQWlCO1FBQ2pCLElBQUMsQ0FBQSxZQUFELEdBQWlCO1FBQ2pCLElBQUMsQ0FBQSxVQUFELEdBQWlCO1FBQ2pCLElBQUMsQ0FBQSxRQUFELEdBQWlCO1FBQ2pCLElBQUMsQ0FBQSxHQUFELEdBQWlCO1FBQ2pCLElBQUMsQ0FBQSxHQUFELEdBQWlCO1FBQ2pCLElBQUMsQ0FBQSxPQUFELEdBQWlCO1FBQ2pCLElBQUMsQ0FBQSxTQUFELEdBQWlCO1FBQ2pCLElBQUMsQ0FBQSxTQUFELEdBQWdCLENBQUM7UUFDakIsSUFBQyxDQUFBLElBQUQsQ0FBQTtlQUNBLElBQUMsQ0FBQSxTQUFELEdBQWdCLENBQUM7SUFaZjs7d0JBY04sSUFBQSxHQUFNLFNBQUE7UUFDRixJQUFDLENBQUEsU0FBRCxHQUFlLElBQUksQ0FBQyxHQUFMLENBQVMsQ0FBVCxFQUFXLElBQUMsQ0FBQSxVQUFELEdBQWMsSUFBQyxDQUFBLFVBQTFCO1FBQ2YsSUFBQyxDQUFBLFNBQUQsR0FB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LElBQUMsQ0FBQSxJQUFELENBQU0sWUFBTixFQUxKO2FBSEo7O0lBRlM7O3dCQWtCYixhQUFBLEdBQWUsU0FBQyxDQUFEO1FBRVgsSUFBRyxJQUFDLENBQUEsVUFBRCxLQUFlLENBQWxCO1lBQ0ksSUFBQyxDQUFBLFVBQUQsR0FBYztZQUNkLElBQUMsQ0FBQSxVQUFELEdBQWMsSUFBQyxDQUFBLFFBQUQsR0FBWSxJQUFDLENBQUE7WUFDM0IsSUFBQyxDQUFBLElBQUQsQ0FBQTttQkFDQSxJQUFDLENBQUEsRUFBRCxDQUFJLENBQUosRUFKSjs7SUFGVzs7OztHQXZOSzs7QUErTnhCLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMCAgICAgMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAgICAgICAgMDAwMDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAgICAgICAwMDAgICAgXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgICAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAgXG4wMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgICAgICAgICAwMDAwMDAwICAgMDAwICAgICAgIDAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAgXG4wMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgICAgICAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAgXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwXG4jIyNcblxueyBrbG9nLCBjbGFtcCB9ID0gcmVxdWlyZSAna3hrJ1xuXG5ldmVudHMgPSByZXF1aXJlICdldmVudHMnXG5cbmNsYXNzIE1hcFNjcm9sbCBleHRlbmRzIGV2ZW50c1xuXG4gICAgQDogKGNmZykgLT5cblxuICAgICAgICBzdXBlcigpXG4gICAgICAgIEBsaW5lSGVpZ2h0ID0gY2ZnLmxpbmVIZWlnaHQgPyAwXG4gICAgICAgIEB2aWV3SGVpZ2h0ID0gY2ZnLnZpZXdIZWlnaHQgPyAwXG4gICAgICAgIEBleHBvc2VNYXggID0gY2ZnLmV4cG9zZU1heCA/IC00ICMgPDA6IC12ICogdmlld0xpbmVzIHwgMDogdW5saW1pdGVkIHwgPjA6IHYgKiAxXG4gICAgICAgIEBzbW9vdGggICAgID0gY2ZnLnNtb290aCA/IHRydWVcbiAgICAgICAgQGluaXQoKVxuICAgICAgICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAwMDAwMFxuICAgICMgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAgIDAwMCAwIDAwMCAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgMDAwICAwMDAwICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgMDAwICAgXG5cbiAgICBpbml0OiAtPlxuICAgICAgICBAc2Nyb2xsICAgICAgID0gIDAgIyBjdXJyZW50IHNjcm9sbCB2YWx1ZSBmcm9tIGRvY3VtZW50IHN0YXJ0IChwaXhlbHMpXG4gICAgICAgIEBvZmZzZXRUb3AgICAgPSAgMCAjIGhlaWdodCBvZiB2aWV3IGFib3ZlIGZpcnN0IHZpc2libGUgbGluZSAocGl4ZWxzKVxuICAgICAgICBAb2Zmc2V0U21vb3RoID0gIDAgIyBzbW9vdGggc2Nyb2xsaW5nIG9mZnNldCAvIHBhcnQgb2YgdG9wIGxpbmUgdGhhdCBpcyBoaWRkZW4gKHBpeGVscylcbiAgICAgICAgQGZ1bGxIZWlnaHQgICA9ICAwICMgdG90YWwgaGVpZ2h0IG9mIGJ1ZmZlciAocGl4ZWxzKVxuICAgICAgICBAbnVtTGluZXMgICAgID0gIDAgIyB0b3RhbCBudW1iZXIgb2YgbGluZXMgaW4gYnVmZmVyXG4gICAgICAgIEB0b3AgICAgICAgICAgPSAgMCAjIGluZGV4IG9mIGZpcnN0IHZpc2libGUgbGluZSBpbiB2aWV3XG4gICAgICAgIEBib3QgICAgICAgICAgPSAgMCAjIGluZGV4IG9mIGxhc3QgIHZpc2libGUgbGluZSBpbiB2aWV3XG4gICAgICAgIEBleHBvc2VkICAgICAgPSAgMCAjIG51bWJlciBvZiBjdXJyZW50bHkgZXhwb3NlZCBsaW5lc1xuICAgICAgICBAZXhwb3NlVG9wICAgID0gIDAgIyBpbmRleCBvZiB0b3Btb3N0IGxpbmUgaW4gdmlldyAoYWx3YXlzIDw9IEB0b3ApXG4gICAgICAgIEBleHBvc2VCb3QgICAgPSAtMSAjIGluZGV4IG9mIGJvdHRvbSBsaW5lIGluIHZpZXcgKGFsd2F5cyA+PSBAYm90KVxuICAgICAgICBAY2FsYygpXG4gICAgICAgIEBvZmZzZXRUb3AgICAgPSAtMSAjIGhhY2sgdG8gZW1pdCBpbml0aWFsIHNjcm9sbFxuXG4gICAgY2FsYzogLT5cbiAgICAgICAgQHNjcm9sbE1heCAgID0gTWF0aC5tYXgoMCxAZnVsbEhlaWdodCAtIEB2aWV3SGVpZ2h0KSAgIyBtYXhpbXVtIHNjcm9sbCBvZmZzZXQgKHBpeGVscylcbiAgICAgICAgQGZ1bGxMaW5lcyAgID0gTWF0aC5mbG9vcihAdmlld0hlaWdodCAvIEBsaW5lSGVpZ2h0KSAgIyBudW1iZXIgb2YgbGluZXMgaW4gdmlldyAoZXhjbHVkaW5nIHBhcnRpYWxzKVxuICAgICAgICBAdmlld0xpbmVzICAgPSBNYXRoLmNlaWwoQHZpZXdIZWlnaHQgLyBAbGluZUhlaWdodCkgICAjIG51bWJlciBvZiBsaW5lcyBpbiB2aWV3IChpbmNsdWRpbmcgcGFydGlhbHMpXG4gICAgICAgIEBsaW5lc0hlaWdodCA9IEB2aWV3TGluZXMgKiBAbGluZUhlaWdodCAgICAgICAgICAgICAgICMgaGVpZ2h0IG9mIHZpc2libGUgbGluZXMgKHBpeGVscylcblxuICAgICAgICAjIGtsb2cgJ0B2aWV3TGluZXMnIEB2aWV3TGluZXMsIEBsaW5lSGVpZ2h0XG4gICAgICAgIFxuICAgICAgICBpZiBAZXhwb3NlTWF4IDwgMFxuICAgICAgICAgICAgQGV4cG9zZU51bSA9IC1AZXhwb3NlTWF4ICogQHZpZXdMaW5lcyAjIG1heGltdW0gc2l6ZSBvZiBleHBvc2UgcmFuZ2UgaXMgdmlld0hlaWdodCBkZXBlbmRlbnRcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgQGV4cG9zZU51bSA9IEBleHBvc2VNYXhcbiAgICAgICAgICAgIFxuICAgICAgICBAZXhwb3NlSGVpZ2h0ID0gQGV4cG9zZU51bSAqIEBsaW5lSGVpZ2h0XG5cbiAgICAjIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAgXG4gICAgIyAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAwMDAgMCAwMDAgIDAwMDAwMCAgICAwMDAgICAwMDBcbiAgICAjIDAwMCAgMDAwICAwMDAwICAwMDAgICAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAwMDAwIFxuICAgIFxuICAgIGluZm86IC0+XG4gICAgICAgIHRvcGJvdDogXCIje0B0b3B9IC4uICN7QGJvdH0gPSAje0Bib3QtQHRvcH0gLyAje0BudW1MaW5lc30gbGluZXNcIlxuICAgICAgICBleHBvc2U6IFwiI3tAZXhwb3NlVG9wfSAuLiAje0BleHBvc2VCb3R9ID0gI3tAZXhwb3NlQm90LUBleHBvc2VUb3B9IC8gI3tAZXhwb3NlTnVtfSBweCAje0BleHBvc2VIZWlnaHR9XCJcbiAgICAgICAgc2Nyb2xsOiBcIiN7QHNjcm9sbH0gb2Zmc2V0VG9wICN7QG9mZnNldFRvcH0gc2Nyb2xsTWF4ICN7QHNjcm9sbE1heH0gZnVsbExpbmVzICN7QGZ1bGxMaW5lc30gdmlld0xpbmVzICN7QHZpZXdMaW5lc30gdmlld0hlaWdodCAje0B2aWV3SGVpZ2h0fVwiXG4gICAgICAgIFxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgICAgIDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgICAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAwMDAwMCAgICAgMDAwICAgXG4gICAgXG4gICAgcmVzZXQ6ID0+XG4gICAgICAgIEBlbWl0ICdjbGVhckxpbmVzJ1xuICAgICAgICBAaW5pdCgpXG5cbiAgICAjIDAwMDAwMDAwMCAgIDAwMDAwMDAgXG4gICAgIyAgICAwMDAgICAgIDAwMCAgIDAwMFxuICAgICMgICAgMDAwICAgICAwMDAgICAwMDBcbiAgICAjICAgIDAwMCAgICAgMDAwICAgMDAwXG4gICAgIyAgICAwMDAgICAgICAwMDAwMDAwIFxuICAgIFxuICAgIHRvOiAocCkgPT4gQGJ5IHAtQHNjcm9sbFxuICAgICAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAwMDAgICAwMDAgMDAwIFxuICAgICMgMDAwMDAwMCAgICAgIDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAwMDAwICAgICAgIDAwMCAgIFxuICAgICAgICBcbiAgICBieTogKGRlbHRhKSA9PlxuICAgICAgICBcbiAgICAgICAgc2Nyb2xsID0gQHNjcm9sbFxuICAgICAgICBkZWx0YSA9IDAgaWYgTnVtYmVyLmlzTmFOIGRlbHRhXG4gICAgICAgIEBzY3JvbGwgPSBwYXJzZUludCBjbGFtcCAwLCBAc2Nyb2xsTWF4LCBAc2Nyb2xsK2RlbHRhXG4gICAgICAgIHRvcCA9IHBhcnNlSW50IEBzY3JvbGwgLyBAbGluZUhlaWdodFxuICAgICAgICBAb2Zmc2V0U21vb3RoID0gQHNjcm9sbCAtIHRvcCAqIEBsaW5lSGVpZ2h0IFxuICAgICAgICBcbiAgICAgICAgQHNldFRvcCB0b3BcblxuICAgICAgICBvZmZzZXQgPSAwXG4gICAgICAgIG9mZnNldCArPSBAb2Zmc2V0U21vb3RoIGlmIEBzbW9vdGhcbiAgICAgICAgb2Zmc2V0ICs9ICh0b3AgLSBAZXhwb3NlVG9wKSAqIEBsaW5lSGVpZ2h0XG4gICAgICAgIFxuICAgICAgICBpZiBvZmZzZXQgIT0gQG9mZnNldFRvcCBvciBzY3JvbGwgIT0gQHNjcm9sbFxuICAgICAgICAgICAgQG9mZnNldFRvcCA9IHBhcnNlSW50IG9mZnNldFxuICAgICAgICAgICAgQGVtaXQgJ3Njcm9sbCcgQHNjcm9sbCwgQG9mZnNldFRvcFxuXG4gICAgIyAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwICAgICAgMDAwICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgXG4gICAgIyAgICAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgIFxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAwICAgICAwMDAgICAgICAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAgICAgICBcbiAgICAgICAgICAgIFxuICAgIHNldFRvcDogKHRvcCkgPT5cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBAZXhwb3NlQm90IDwgMCBhbmQgQG51bUxpbmVzIDwgMVxuICAgICAgICBcbiAgICAgICAgb2xkVG9wID0gQHRvcFxuICAgICAgICBvbGRCb3QgPSBAYm90XG4gICAgICAgIEB0b3AgPSB0b3BcbiAgICAgICAgQGJvdCA9IE1hdGgubWluIEB0b3ArQHZpZXdMaW5lcywgQG51bUxpbmVzLTFcbiAgICAgICAgcmV0dXJuIGlmIG9sZFRvcCA9PSBAdG9wIGFuZCBvbGRCb3QgPT0gQGJvdCBhbmQgQGV4cG9zZUJvdCA+PSBAYm90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgIGlmIChAdG9wID49IEBleHBvc2VCb3QpIG9yIChAYm90IDw9IEBleHBvc2VUb3ApICMgbmV3IHJhbmdlIG91dHNpZGUsIHN0YXJ0IGZyb20gc2NyYXRjaFxuICAgICAgICAgICAgQGVtaXQgJ2NsZWFyTGluZXMnXG4gICAgICAgICAgICBAZXhwb3NlVG9wID0gQHRvcFxuICAgICAgICAgICAgQGV4cG9zZUJvdCA9IEBib3RcbiAgICAgICAgICAgIG51bSA9IEBib3QgLSBAdG9wICsgMVxuICAgICAgICAgICAgaWYgbnVtID4gMFxuICAgICAgICAgICAgICAgIEBlbWl0ICdleHBvc2VMaW5lcycgdG9wOkB0b3AsIGJvdDpAYm90LCBudW06IG51bVxuICAgICAgICAgICAgICAgIEBlbWl0ICdzY3JvbGwnIEBzY3JvbGwsIEBvZmZzZXRUb3BcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICBcbiAgICAgICAgaWYgQHRvcCA8IEBleHBvc2VUb3BcbiAgICAgICAgICAgIG9sZFRvcCA9IEBleHBvc2VUb3BcbiAgICAgICAgICAgIEBleHBvc2VUb3AgPSBNYXRoLm1heCAwLCBAdG9wIC0gKE1hdGgubWluIEB2aWV3TGluZXMsIEBleHBvc2VOdW0gLSBAdmlld0xpbmVzKVxuICAgICAgICAgICAgbnVtID0gb2xkVG9wIC0gQGV4cG9zZVRvcFxuICAgICAgICAgICAgaWYgbnVtID4gMFxuICAgICAgICAgICAgICAgIEBlbWl0ICdleHBvc2VMaW5lcycgdG9wOkBleHBvc2VUb3AsIGJvdDpvbGRUb3AtMSwgbnVtOiBudW1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgd2hpbGUgQGJvdCA+IEBleHBvc2VCb3RcbiAgICAgICAgICAgIEBleHBvc2VCb3QgKz0gMVxuICAgICAgICAgICAgQGVtaXQgJ2V4cG9zZUxpbmUnIEBleHBvc2VCb3RcbiAgICAgICAgICAgIFxuICAgICAgICBpZiBAZXhwb3NlQm90LUBleHBvc2VUb3ArMSA+IEBleHBvc2VOdW0gXG4gICAgICAgICAgICBudW0gID0gQGV4cG9zZUJvdC1AZXhwb3NlVG9wKzEgLSBAZXhwb3NlTnVtXG4gICAgICAgICAgICBpZiBAdG9wPm9sZFRvcFxuICAgICAgICAgICAgICAgIG4gPSBjbGFtcCAwLCBAdG9wLUBleHBvc2VUb3AsIG51bVxuICAgICAgICAgICAgICAgIEBleHBvc2VUb3AgKz0gblxuICAgICAgICAgICAgICAgIEBlbWl0ICd2YW5pc2hMaW5lcycgdG9wOiBuXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgbiA9IGNsYW1wIDAsIEBleHBvc2VCb3QtQGJvdCwgbnVtXG4gICAgICAgICAgICAgICAgQGV4cG9zZUJvdCAtPSBuXG4gICAgICAgICAgICAgICAgQGVtaXQgJ3ZhbmlzaExpbmVzJyBib3Q6IG5cbiAgICAgICAgICAgICAgICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMDAwXG4gICAgIyAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwICAwMDAgMCAwMDAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgICAgICAwMDAgICBcbiAgICAjIDAwMCAgMDAwICAwMDAwICAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgIFxuICAgIGluc2VydExpbmU6IChsaSxvaSkgPT5cbiAgICAgICAgQGV4cG9zZUJvdCArPSAxIGlmIEBsaW5lSW5kZXhJc0luRXhwb3NlIG9pXG4gICAgICAgIEBib3QgICAgICAgKz0gMSBpZiBAbGluZUluZGV4SXNJblZpZXcgb2lcbiAgICAgICAgQHRvcCAgICAgICArPSAxIGlmIG9pIDwgQHRvcFxuICAgICAgICBAbnVtTGluZXMgICs9IDFcbiAgICAgICAgQGZ1bGxIZWlnaHQgPSBAbnVtTGluZXMgKiBAbGluZUhlaWdodFxuICAgICAgICBAY2FsYygpXG4gICAgICAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwMCAgMDAwICAgICAgMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAgICAgICAwMDAwMDAwICAgICAgMDAwICAgICAwMDAwMDAwIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICAgICAwMDAgICAgIDAwMDAwMDAwXG5cbiAgICBkZWxldGVMaW5lOiAobGksb2kpID0+XG4gICAgICAgIEBleHBvc2VCb3QgLT0gMSBpZiBAbGluZUluZGV4SXNJbkV4cG9zZShvaSkgb3IgQG51bUxpbmVzIDwgQGV4cG9zZU51bVxuICAgICAgICBAYm90ICAgICAgIC09IDEgaWYgQGxpbmVJbmRleElzSW5WaWV3IG9pXG4gICAgXG4gICAgbGluZUluZGV4SXNJblZpZXc6IChsaSkgLT4gXG4gICAgICAgIHJldHVybiB0cnVlIGlmIEB0b3AgPD0gbGkgPD0gQGJvdFxuICAgICAgICByZXR1cm4gQGJvdC1AdG9wKzEgPCBAZnVsbExpbmVzXG4gICAgICAgIFxuICAgIGxpbmVJbmRleElzSW5FeHBvc2U6IChsaSkgLT5cbiAgICAgICAgcmV0dXJuIHRydWUgaWYgQGV4cG9zZVRvcCA8PSBsaSA8PSBAZXhwb3NlQm90IFxuICAgICAgICByZXR1cm4gQGV4cG9zZUJvdC1AZXhwb3NlVG9wKzEgPCBAZXhwb3NlTnVtXG4gICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAgMDAwIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMDAwMDAwMCAgICAgMDAwICAgXG4gICAgIyAgICAwMDAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAgICAgMCAgICAgIDAwMCAgMDAwMDAwMDAgIDAwICAgICAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG5cbiAgICBzZXRWaWV3SGVpZ2h0OiAoaCkgPT5cbiAgICAgICAgaWYgQHZpZXdIZWlnaHQgIT0gaFxuICAgICAgICAgICAgQHZpZXdIZWlnaHQgPSBoXG4gICAgICAgICAgICBAY2FsYygpXG4gICAgICAgICAgICBAYnkgMFxuICAgICAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAgICAgIDAwICAwMDAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwXG4gICAgIyAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAwMDAgICAgICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgXG4gICAgIyAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgICAgICAgMDAwXG4gICAgIyAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgXG4gICAgICAgIFxuICAgIHNldE51bUxpbmVzOiAobikgPT5cblxuICAgICAgICBpZiBAbnVtTGluZXMgIT0gblxuICAgICAgICAgICAgQG51bUxpbmVzID0gblxuICAgICAgICAgICAgQGZ1bGxIZWlnaHQgPSBAbnVtTGluZXMgKiBAbGluZUhlaWdodCAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgQG51bUxpbmVzXG4gICAgICAgICAgICAgICAgQGNhbGMoKVxuICAgICAgICAgICAgICAgIEBieSAwXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgQGluaXQoKVxuICAgICAgICAgICAgICAgIEBlbWl0ICdjbGVhckxpbmVzJyAgICAgICAgICAgIFxuXG4gICAgIyAwMDAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMFxuICAgICMgMDAwICAgICAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgICAgIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMDAwMDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgICAwMDAgICBcblxuICAgIHNldExpbmVIZWlnaHQ6IChoKSA9PlxuICAgICAgICAgICAgXG4gICAgICAgIGlmIEBsaW5lSGVpZ2h0ICE9IGhcbiAgICAgICAgICAgIEBsaW5lSGVpZ2h0ID0gaFxuICAgICAgICAgICAgQGZ1bGxIZWlnaHQgPSBAbnVtTGluZXMgKiBAbGluZUhlaWdodFxuICAgICAgICAgICAgQGNhbGMoKVxuICAgICAgICAgICAgQGJ5IDBcblxubW9kdWxlLmV4cG9ydHMgPSBNYXBTY3JvbGxcbiJdfQ==
//# sourceURL=../../coffee/editor/mapscroll.coffee