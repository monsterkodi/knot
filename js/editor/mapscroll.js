// koffee 1.12.0

/*
00     00   0000000   00000000          0000000   0000000  00000000    0000000   000      000    
000   000  000   000  000   000        000       000       000   000  000   000  000      000    
000000000  000000000  00000000         0000000   000       0000000    000   000  000      000    
000 0 000  000   000  000                   000  000       000   000  000   000  000      000    
000   000  000   000  000              0000000    0000000  000   000   0000000   0000000  0000000
 */
var MapScroll, clamp, events, klog, ref,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

ref = require('kxk'), klog = ref.klog, clamp = ref.clamp;

events = require('events');

MapScroll = (function(superClass) {
    extend(MapScroll, superClass);

    function MapScroll(cfg) {
        this.setLineHeight = bind(this.setLineHeight, this);
        this.setNumLines = bind(this.setNumLines, this);
        this.setViewHeight = bind(this.setViewHeight, this);
        this.deleteLine = bind(this.deleteLine, this);
        this.insertLine = bind(this.insertLine, this);
        this.setTop = bind(this.setTop, this);
        this.by = bind(this.by, this);
        this.to = bind(this.to, this);
        this.reset = bind(this.reset, this);
        var ref1, ref2, ref3, ref4;
        MapScroll.__super__.constructor.call(this);
        this.lineHeight = (ref1 = cfg.lineHeight) != null ? ref1 : 0;
        this.viewHeight = (ref2 = cfg.viewHeight) != null ? ref2 : 0;
        this.exposeMax = (ref3 = cfg.exposeMax) != null ? ref3 : -4;
        this.smooth = (ref4 = cfg.smooth) != null ? ref4 : true;
        this.init();
    }

    MapScroll.prototype.init = function() {
        this.scroll = 0;
        this.offsetTop = 0;
        this.offsetSmooth = 0;
        this.fullHeight = 0;
        this.numLines = 0;
        this.top = 0;
        this.bot = 0;
        this.exposed = 0;
        this.exposeTop = 0;
        this.exposeBot = -1;
        this.calc();
        return this.offsetTop = -1;
    };

    MapScroll.prototype.calc = function() {
        this.scrollMax = Math.max(0, this.fullHeight - this.viewHeight);
        this.fullLines = Math.floor(this.viewHeight / this.lineHeight);
        this.viewLines = Math.ceil(this.viewHeight / this.lineHeight);
        this.linesHeight = this.viewLines * this.lineHeight;
        if (this.exposeMax < 0) {
            this.exposeNum = -this.exposeMax * this.viewLines;
        } else {
            this.exposeNum = this.exposeMax;
        }
        return this.exposeHeight = this.exposeNum * this.lineHeight;
    };

    MapScroll.prototype.info = function() {
        return {
            topbot: this.top + " .. " + this.bot + " = " + (this.bot - this.top) + " / " + this.numLines + " lines",
            expose: this.exposeTop + " .. " + this.exposeBot + " = " + (this.exposeBot - this.exposeTop) + " / " + this.exposeNum + " px " + this.exposeHeight,
            scroll: this.scroll + " offsetTop " + this.offsetTop + " scrollMax " + this.scrollMax + " fullLines " + this.fullLines + " viewLines " + this.viewLines + " viewHeight " + this.viewHeight
        };
    };

    MapScroll.prototype.reset = function() {
        this.emit('clearLines');
        return this.init();
    };

    MapScroll.prototype.to = function(p) {
        return this.by(p - this.scroll);
    };

    MapScroll.prototype.by = function(delta) {
        var offset, scroll, top;
        scroll = this.scroll;
        if (Number.isNaN(delta)) {
            delta = 0;
        }
        this.scroll = parseInt(clamp(0, this.scrollMax, this.scroll + delta));
        top = parseInt(this.scroll / this.lineHeight);
        this.offsetSmooth = this.scroll - top * this.lineHeight;
        this.setTop(top);
        offset = 0;
        if (this.smooth) {
            offset += this.offsetSmooth;
        }
        offset += (top - this.exposeTop) * this.lineHeight;
        if (offset !== this.offsetTop || scroll !== this.scroll) {
            this.offsetTop = parseInt(offset);
            return this.emit('scroll', this.scroll, this.offsetTop);
        }
    };

    MapScroll.prototype.setTop = function(top) {
        var n, num, oldBot, oldTop;
        if (this.exposeBot < 0 && this.numLines < 1) {
            return;
        }
        oldTop = this.top;
        oldBot = this.bot;
        this.top = top;
        this.bot = Math.min(this.top + this.viewLines, this.numLines - 1);
        if (oldTop === this.top && oldBot === this.bot && this.exposeBot >= this.bot) {
            return;
        }
        if ((this.top >= this.exposeBot) || (this.bot <= this.exposeTop)) {
            this.emit('clearLines');
            this.exposeTop = this.top;
            this.exposeBot = this.bot;
            num = this.bot - this.top + 1;
            if (num > 0) {
                this.emit('exposeLines', {
                    top: this.top,
                    bot: this.bot,
                    num: num
                });
                this.emit('scroll', this.scroll, this.offsetTop);
            }
            return;
        }
        if (this.top < this.exposeTop) {
            oldTop = this.exposeTop;
            this.exposeTop = Math.max(0, this.top - (Math.min(this.viewLines, this.exposeNum - this.viewLines)));
            num = oldTop - this.exposeTop;
            if (num > 0) {
                this.emit('exposeLines', {
                    top: this.exposeTop,
                    bot: oldTop - 1,
                    num: num
                });
            }
        }
        while (this.bot > this.exposeBot) {
            this.exposeBot += 1;
            this.emit('exposeLine', this.exposeBot);
        }
        if (this.exposeBot - this.exposeTop + 1 > this.exposeNum) {
            num = this.exposeBot - this.exposeTop + 1 - this.exposeNum;
            if (this.top > oldTop) {
                n = clamp(0, this.top - this.exposeTop, num);
                this.exposeTop += n;
                return this.emit('vanishLines', {
                    top: n
                });
            } else {
                n = clamp(0, this.exposeBot - this.bot, num);
                this.exposeBot -= n;
                return this.emit('vanishLines', {
                    bot: n
                });
            }
        }
    };

    MapScroll.prototype.insertLine = function(li, oi) {
        if (this.lineIndexIsInExpose(oi)) {
            this.exposeBot += 1;
        }
        if (this.lineIndexIsInView(oi)) {
            this.bot += 1;
        }
        if (oi < this.top) {
            this.top += 1;
        }
        this.numLines += 1;
        this.fullHeight = this.numLines * this.lineHeight;
        return this.calc();
    };

    MapScroll.prototype.deleteLine = function(li, oi) {
        if (this.lineIndexIsInExpose(oi) || this.numLines < this.exposeNum) {
            this.exposeBot -= 1;
        }
        if (this.lineIndexIsInView(oi)) {
            return this.bot -= 1;
        }
    };

    MapScroll.prototype.lineIndexIsInView = function(li) {
        if ((this.top <= li && li <= this.bot)) {
            return true;
        }
        return this.bot - this.top + 1 < this.fullLines;
    };

    MapScroll.prototype.lineIndexIsInExpose = function(li) {
        if ((this.exposeTop <= li && li <= this.exposeBot)) {
            return true;
        }
        return this.exposeBot - this.exposeTop + 1 < this.exposeNum;
    };

    MapScroll.prototype.setViewHeight = function(h) {
        if (this.viewHeight !== h) {
            this.viewHeight = h;
            this.calc();
            return this.by(0);
        }
    };

    MapScroll.prototype.setNumLines = function(n) {
        if (this.numLines !== n) {
            this.numLines = n;
            this.fullHeight = this.numLines * this.lineHeight;
            if (this.numLines) {
                this.calc();
                return this.by(0);
            } else {
                this.init();
                return this.emit('clearLines');
            }
        }
    };

    MapScroll.prototype.setLineHeight = function(h) {
        if (this.lineHeight !== h) {
            this.lineHeight = h;
            this.fullHeight = this.numLines * this.lineHeight;
            this.calc();
            return this.by(0);
        }
    };

    return MapScroll;

})(events);

module.exports = MapScroll;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFwc2Nyb2xsLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uL2NvZmZlZS9lZGl0b3IiLCJzb3VyY2VzIjpbIm1hcHNjcm9sbC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUEsbUNBQUE7SUFBQTs7OztBQVFBLE1BQWtCLE9BQUEsQ0FBUSxLQUFSLENBQWxCLEVBQUUsZUFBRixFQUFROztBQUVSLE1BQUEsR0FBUyxPQUFBLENBQVEsUUFBUjs7QUFFSDs7O0lBRUMsbUJBQUMsR0FBRDs7Ozs7Ozs7OztBQUVDLFlBQUE7UUFBQSx5Q0FBQTtRQUNBLElBQUMsQ0FBQSxVQUFELDRDQUErQjtRQUMvQixJQUFDLENBQUEsVUFBRCw0Q0FBK0I7UUFDL0IsSUFBQyxDQUFBLFNBQUQsMkNBQThCLENBQUM7UUFDL0IsSUFBQyxDQUFBLE1BQUQsd0NBQTJCO1FBQzNCLElBQUMsQ0FBQSxJQUFELENBQUE7SUFQRDs7d0JBZUgsSUFBQSxHQUFNLFNBQUE7UUFDRixJQUFDLENBQUEsTUFBRCxHQUFpQjtRQUNqQixJQUFDLENBQUEsU0FBRCxHQUFpQjtRQUNqQixJQUFDLENBQUEsWUFBRCxHQUFpQjtRQUNqQixJQUFDLENBQUEsVUFBRCxHQUFpQjtRQUNqQixJQUFDLENBQUEsUUFBRCxHQUFpQjtRQUNqQixJQUFDLENBQUEsR0FBRCxHQUFpQjtRQUNqQixJQUFDLENBQUEsR0FBRCxHQUFpQjtRQUNqQixJQUFDLENBQUEsT0FBRCxHQUFpQjtRQUNqQixJQUFDLENBQUEsU0FBRCxHQUFpQjtRQUNqQixJQUFDLENBQUEsU0FBRCxHQUFnQixDQUFDO1FBQ2pCLElBQUMsQ0FBQSxJQUFELENBQUE7ZUFDQSxJQUFDLENBQUEsU0FBRCxHQUFnQixDQUFDO0lBWmY7O3dCQWNOLElBQUEsR0FBTSxTQUFBO1FBQ0YsSUFBQyxDQUFBLFNBQUQsR0FBZSxJQUFJLENBQUMsR0FBTCxDQUFTLENBQVQsRUFBVyxJQUFDLENBQUEsVUFBRCxHQUFjLElBQUMs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QUE7Z0JBSUksSUFBQyxDQUFBLElBQUQsQ0FBQTt1QkFDQSxJQUFDLENBQUEsSUFBRCxDQUFNLFlBQU4sRUFMSjthQUhKOztJQUZTOzt3QkFrQmIsYUFBQSxHQUFlLFNBQUMsQ0FBRDtRQUVYLElBQUcsSUFBQyxDQUFBLFVBQUQsS0FBZSxDQUFsQjtZQUNJLElBQUMsQ0FBQSxVQUFELEdBQWM7WUFDZCxJQUFDLENBQUEsVUFBRCxHQUFjLElBQUMsQ0FBQSxRQUFELEdBQVksSUFBQyxDQUFBO1lBQzNCLElBQUMsQ0FBQSxJQUFELENBQUE7bUJBQ0EsSUFBQyxDQUFBLEVBQUQsQ0FBSSxDQUFKLEVBSko7O0lBRlc7Ozs7R0F2Tks7O0FBK054QixNQUFNLENBQUMsT0FBUCxHQUFpQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgICAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgICAgMDAwICAgIFxuMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgICAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgIFxuMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwICAgICAgICAgMDAwMDAwMCAgIDAwMCAgICAgICAwMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgIFxuMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAgICAgICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgIFxuMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgMDAwMDAwMFxuIyMjXG5cbnsga2xvZywgY2xhbXAgfSA9IHJlcXVpcmUgJ2t4aydcblxuZXZlbnRzID0gcmVxdWlyZSAnZXZlbnRzJ1xuXG5jbGFzcyBNYXBTY3JvbGwgZXh0ZW5kcyBldmVudHNcblxuICAgIEA6IChjZmcpIC0+XG5cbiAgICAgICAgc3VwZXIoKVxuICAgICAgICBAbGluZUhlaWdodCA9IGNmZy5saW5lSGVpZ2h0ID8gMFxuICAgICAgICBAdmlld0hlaWdodCA9IGNmZy52aWV3SGVpZ2h0ID8gMFxuICAgICAgICBAZXhwb3NlTWF4ICA9IGNmZy5leHBvc2VNYXggPyAtNCAjIDwwOiAtdiAqIHZpZXdMaW5lcyB8IDA6IHVubGltaXRlZCB8ID4wOiB2ICogMVxuICAgICAgICBAc21vb3RoICAgICA9IGNmZy5zbW9vdGggPyB0cnVlXG4gICAgICAgIEBpbml0KClcbiAgICAgICAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwMDBcbiAgICAjIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwICAwMDAgMCAwMDAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAwMDAgICAgIDAwMCAgIFxuXG4gICAgaW5pdDogLT5cbiAgICAgICAgQHNjcm9sbCAgICAgICA9ICAwICMgY3VycmVudCBzY3JvbGwgdmFsdWUgZnJvbSBkb2N1bWVudCBzdGFydCAocGl4ZWxzKVxuICAgICAgICBAb2Zmc2V0VG9wICAgID0gIDAgIyBoZWlnaHQgb2YgdmlldyBhYm92ZSBmaXJzdCB2aXNpYmxlIGxpbmUgKHBpeGVscylcbiAgICAgICAgQG9mZnNldFNtb290aCA9ICAwICMgc21vb3RoIHNjcm9sbGluZyBvZmZzZXQgLyBwYXJ0IG9mIHRvcCBsaW5lIHRoYXQgaXMgaGlkZGVuIChwaXhlbHMpXG4gICAgICAgIEBmdWxsSGVpZ2h0ICAgPSAgMCAjIHRvdGFsIGhlaWdodCBvZiBidWZmZXIgKHBpeGVscylcbiAgICAgICAgQG51bUxpbmVzICAgICA9ICAwICMgdG90YWwgbnVtYmVyIG9mIGxpbmVzIGluIGJ1ZmZlclxuICAgICAgICBAdG9wICAgICAgICAgID0gIDAgIyBpbmRleCBvZiBmaXJzdCB2aXNpYmxlIGxpbmUgaW4gdmlld1xuICAgICAgICBAYm90ICAgICAgICAgID0gIDAgIyBpbmRleCBvZiBsYXN0ICB2aXNpYmxlIGxpbmUgaW4gdmlld1xuICAgICAgICBAZXhwb3NlZCAgICAgID0gIDAgIyBudW1iZXIgb2YgY3VycmVudGx5IGV4cG9zZWQgbGluZXNcbiAgICAgICAgQGV4cG9zZVRvcCAgICA9ICAwICMgaW5kZXggb2YgdG9wbW9zdCBsaW5lIGluIHZpZXcgKGFsd2F5cyA8PSBAdG9wKVxuICAgICAgICBAZXhwb3NlQm90ICAgID0gLTEgIyBpbmRleCBvZiBib3R0b20gbGluZSBpbiB2aWV3IChhbHdheXMgPj0gQGJvdClcbiAgICAgICAgQGNhbGMoKVxuICAgICAgICBAb2Zmc2V0VG9wICAgID0gLTEgIyBoYWNrIHRvIGVtaXQgaW5pdGlhbCBzY3JvbGxcblxuICAgIGNhbGM6IC0+XG4gICAgICAgIEBzY3JvbGxNYXggICA9IE1hdGgubWF4KDAsQGZ1bGxIZWlnaHQgLSBAdmlld0hlaWdodCkgICMgbWF4aW11bSBzY3JvbGwgb2Zmc2V0IChwaXhlbHMpXG4gICAgICAgIEBmdWxsTGluZXMgICA9IE1hdGguZmxvb3IoQHZpZXdIZWlnaHQgLyBAbGluZUhlaWdodCkgICMgbnVtYmVyIG9mIGxpbmVzIGluIHZpZXcgKGV4Y2x1ZGluZyBwYXJ0aWFscylcbiAgICAgICAgQHZpZXdMaW5lcyAgID0gTWF0aC5jZWlsKEB2aWV3SGVpZ2h0IC8gQGxpbmVIZWlnaHQpICAgIyBudW1iZXIgb2YgbGluZXMgaW4gdmlldyAoaW5jbHVkaW5nIHBhcnRpYWxzKVxuICAgICAgICBAbGluZXNIZWlnaHQgPSBAdmlld0xpbmVzICogQGxpbmVIZWlnaHQgICAgICAgICAgICAgICAjIGhlaWdodCBvZiB2aXNpYmxlIGxpbmVzIChwaXhlbHMpXG5cbiAgICAgICAgIyBrbG9nICdAdmlld0xpbmVzJyBAdmlld0xpbmVzLCBAbGluZUhlaWdodFxuICAgICAgICBcbiAgICAgICAgaWYgQGV4cG9zZU1heCA8IDBcbiAgICAgICAgICAgIEBleHBvc2VOdW0gPSAtQGV4cG9zZU1heCAqIEB2aWV3TGluZXMgIyBtYXhpbXVtIHNpemUgb2YgZXhwb3NlIHJhbmdlIGlzIHZpZXdIZWlnaHQgZGVwZW5kZW50XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIEBleHBvc2VOdW0gPSBAZXhwb3NlTWF4XG4gICAgICAgICAgICBcbiAgICAgICAgQGV4cG9zZUhlaWdodCA9IEBleHBvc2VOdW0gKiBAbGluZUhlaWdodFxuXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwIFxuICAgICMgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDBcbiAgICAjIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwMDAwMCBcbiAgICBcbiAgICBpbmZvOiAtPlxuICAgICAgICB0b3Bib3Q6IFwiI3tAdG9wfSAuLiAje0Bib3R9ID0gI3tAYm90LUB0b3B9IC8gI3tAbnVtTGluZXN9IGxpbmVzXCJcbiAgICAgICAgZXhwb3NlOiBcIiN7QGV4cG9zZVRvcH0gLi4gI3tAZXhwb3NlQm90fSA9ICN7QGV4cG9zZUJvdC1AZXhwb3NlVG9wfSAvICN7QGV4cG9zZU51bX0gcHggI3tAZXhwb3NlSGVpZ2h0fVwiXG4gICAgICAgIHNjcm9sbDogXCIje0BzY3JvbGx9IG9mZnNldFRvcCAje0BvZmZzZXRUb3B9IHNjcm9sbE1heCAje0BzY3JvbGxNYXh9IGZ1bGxMaW5lcyAje0BmdWxsTGluZXN9IHZpZXdMaW5lcyAje0B2aWV3TGluZXN9IHZpZXdIZWlnaHQgI3tAdmlld0hlaWdodH1cIlxuICAgICAgICBcbiAgICAjIDAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgICAgICAgIDAwMCAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgICAwMDAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgICAgICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwICAgMDAwMDAwMDAgICAgIDAwMCAgIFxuICAgIFxuICAgIHJlc2V0OiA9PlxuICAgICAgICBAZW1pdCAnY2xlYXJMaW5lcydcbiAgICAgICAgQGluaXQoKVxuXG4gICAgIyAwMDAwMDAwMDAgICAwMDAwMDAwIFxuICAgICMgICAgMDAwICAgICAwMDAgICAwMDBcbiAgICAjICAgIDAwMCAgICAgMDAwICAgMDAwXG4gICAgIyAgICAwMDAgICAgIDAwMCAgIDAwMFxuICAgICMgICAgMDAwICAgICAgMDAwMDAwMCBcbiAgICBcbiAgICB0bzogKHApID0+IEBieSBwLUBzY3JvbGxcbiAgICAgICAgXG4gICAgIyAwMDAwMDAwICAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAgMDAwICAgMDAwIDAwMCBcbiAgICAjIDAwMDAwMDAgICAgICAwMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwMDAwMCAgICAgICAwMDAgICBcbiAgICAgICAgXG4gICAgYnk6IChkZWx0YSkgPT5cbiAgICAgICAgXG4gICAgICAgIHNjcm9sbCA9IEBzY3JvbGxcbiAgICAgICAgZGVsdGEgPSAwIGlmIE51bWJlci5pc05hTiBkZWx0YVxuICAgICAgICBAc2Nyb2xsID0gcGFyc2VJbnQgY2xhbXAgMCwgQHNjcm9sbE1heCwgQHNjcm9sbCtkZWx0YVxuICAgICAgICB0b3AgPSBwYXJzZUludCBAc2Nyb2xsIC8gQGxpbmVIZWlnaHRcbiAgICAgICAgQG9mZnNldFNtb290aCA9IEBzY3JvbGwgLSB0b3AgKiBAbGluZUhlaWdodCBcbiAgICAgICAgXG4gICAgICAgIEBzZXRUb3AgdG9wXG5cbiAgICAgICAgb2Zmc2V0ID0gMFxuICAgICAgICBvZmZzZXQgKz0gQG9mZnNldFNtb290aCBpZiBAc21vb3RoXG4gICAgICAgIG9mZnNldCArPSAodG9wIC0gQGV4cG9zZVRvcCkgKiBAbGluZUhlaWdodFxuICAgICAgICBcbiAgICAgICAgaWYgb2Zmc2V0ICE9IEBvZmZzZXRUb3Agb3Igc2Nyb2xsICE9IEBzY3JvbGxcbiAgICAgICAgICAgIEBvZmZzZXRUb3AgPSBwYXJzZUludCBvZmZzZXRcbiAgICAgICAgICAgIEBlbWl0ICdzY3JvbGwnIEBzY3JvbGwsIEBvZmZzZXRUb3BcblxuICAgICMgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4gICAgIyAwMDAwMDAwICAgMDAwMDAwMCAgICAgIDAwMCAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMDAwMDAwIFxuICAgICMgICAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAgICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwMCAgICAgMDAwICAgICAgICAwMDAgICAgICAwMDAwMDAwICAgMDAwICAgICAgXG4gICAgICAgICAgICBcbiAgICBzZXRUb3A6ICh0b3ApID0+XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gaWYgQGV4cG9zZUJvdCA8IDAgYW5kIEBudW1MaW5lcyA8IDFcbiAgICAgICAgXG4gICAgICAgIG9sZFRvcCA9IEB0b3BcbiAgICAgICAgb2xkQm90ID0gQGJvdFxuICAgICAgICBAdG9wID0gdG9wXG4gICAgICAgIEBib3QgPSBNYXRoLm1pbiBAdG9wK0B2aWV3TGluZXMsIEBudW1MaW5lcy0xXG4gICAgICAgIHJldHVybiBpZiBvbGRUb3AgPT0gQHRvcCBhbmQgb2xkQm90ID09IEBib3QgYW5kIEBleHBvc2VCb3QgPj0gQGJvdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICBpZiAoQHRvcCA+PSBAZXhwb3NlQm90KSBvciAoQGJvdCA8PSBAZXhwb3NlVG9wKSAjIG5ldyByYW5nZSBvdXRzaWRlLCBzdGFydCBmcm9tIHNjcmF0Y2hcbiAgICAgICAgICAgIEBlbWl0ICdjbGVhckxpbmVzJ1xuICAgICAgICAgICAgQGV4cG9zZVRvcCA9IEB0b3BcbiAgICAgICAgICAgIEBleHBvc2VCb3QgPSBAYm90XG4gICAgICAgICAgICBudW0gPSBAYm90IC0gQHRvcCArIDFcbiAgICAgICAgICAgIGlmIG51bSA+IDBcbiAgICAgICAgICAgICAgICBAZW1pdCAnZXhwb3NlTGluZXMnIHRvcDpAdG9wLCBib3Q6QGJvdCwgbnVtOiBudW1cbiAgICAgICAgICAgICAgICBAZW1pdCAnc2Nyb2xsJyBAc2Nyb2xsLCBAb2Zmc2V0VG9wXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgXG4gICAgICAgIGlmIEB0b3AgPCBAZXhwb3NlVG9wXG4gICAgICAgICAgICBvbGRUb3AgPSBAZXhwb3NlVG9wXG4gICAgICAgICAgICBAZXhwb3NlVG9wID0gTWF0aC5tYXggMCwgQHRvcCAtIChNYXRoLm1pbiBAdmlld0xpbmVzLCBAZXhwb3NlTnVtIC0gQHZpZXdMaW5lcylcbiAgICAgICAgICAgIG51bSA9IG9sZFRvcCAtIEBleHBvc2VUb3BcbiAgICAgICAgICAgIGlmIG51bSA+IDBcbiAgICAgICAgICAgICAgICBAZW1pdCAnZXhwb3NlTGluZXMnIHRvcDpAZXhwb3NlVG9wLCBib3Q6b2xkVG9wLTEsIG51bTogbnVtXG4gICAgICAgICAgICAgICAgXG4gICAgICAgIHdoaWxlIEBib3QgPiBAZXhwb3NlQm90XG4gICAgICAgICAgICBAZXhwb3NlQm90ICs9IDFcbiAgICAgICAgICAgIEBlbWl0ICdleHBvc2VMaW5lJyBAZXhwb3NlQm90XG4gICAgICAgICAgICBcbiAgICAgICAgaWYgQGV4cG9zZUJvdC1AZXhwb3NlVG9wKzEgPiBAZXhwb3NlTnVtIFxuICAgICAgICAgICAgbnVtICA9IEBleHBvc2VCb3QtQGV4cG9zZVRvcCsxIC0gQGV4cG9zZU51bVxuICAgICAgICAgICAgaWYgQHRvcD5vbGRUb3BcbiAgICAgICAgICAgICAgICBuID0gY2xhbXAgMCwgQHRvcC1AZXhwb3NlVG9wLCBudW1cbiAgICAgICAgICAgICAgICBAZXhwb3NlVG9wICs9IG5cbiAgICAgICAgICAgICAgICBAZW1pdCAndmFuaXNoTGluZXMnIHRvcDogblxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIG4gPSBjbGFtcCAwLCBAZXhwb3NlQm90LUBib3QsIG51bVxuICAgICAgICAgICAgICAgIEBleHBvc2VCb3QgLT0gblxuICAgICAgICAgICAgICAgIEBlbWl0ICd2YW5pc2hMaW5lcycgYm90OiBuXG4gICAgICAgICAgICAgICAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAwMFxuICAgICMgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgICAgMDAwICAgXG4gICAgIyAwMDAgIDAwMCAgMDAwMCAgICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwICAgMDAwICAgICAwMDAgICBcbiAgICBcbiAgICBpbnNlcnRMaW5lOiAobGksb2kpID0+XG4gICAgICAgIEBleHBvc2VCb3QgKz0gMSBpZiBAbGluZUluZGV4SXNJbkV4cG9zZSBvaVxuICAgICAgICBAYm90ICAgICAgICs9IDEgaWYgQGxpbmVJbmRleElzSW5WaWV3IG9pXG4gICAgICAgIEB0b3AgICAgICAgKz0gMSBpZiBvaSA8IEB0b3BcbiAgICAgICAgQG51bUxpbmVzICArPSAxXG4gICAgICAgIEBmdWxsSGVpZ2h0ID0gQG51bUxpbmVzICogQGxpbmVIZWlnaHRcbiAgICAgICAgQGNhbGMoKVxuICAgICAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMCAgICAgIDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwICAgMDAwICAgICAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMCBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwMFxuXG4gICAgZGVsZXRlTGluZTogKGxpLG9pKSA9PlxuICAgICAgICBAZXhwb3NlQm90IC09IDEgaWYgQGxpbmVJbmRleElzSW5FeHBvc2Uob2kpIG9yIEBudW1MaW5lcyA8IEBleHBvc2VOdW1cbiAgICAgICAgQGJvdCAgICAgICAtPSAxIGlmIEBsaW5lSW5kZXhJc0luVmlldyBvaVxuICAgIFxuICAgIGxpbmVJbmRleElzSW5WaWV3OiAobGkpIC0+IFxuICAgICAgICByZXR1cm4gdHJ1ZSBpZiBAdG9wIDw9IGxpIDw9IEBib3RcbiAgICAgICAgcmV0dXJuIEBib3QtQHRvcCsxIDwgQGZ1bGxMaW5lc1xuICAgICAgICBcbiAgICBsaW5lSW5kZXhJc0luRXhwb3NlOiAobGkpIC0+XG4gICAgICAgIHJldHVybiB0cnVlIGlmIEBleHBvc2VUb3AgPD0gbGkgPD0gQGV4cG9zZUJvdCBcbiAgICAgICAgcmV0dXJuIEBleHBvc2VCb3QtQGV4cG9zZVRvcCsxIDwgQGV4cG9zZU51bVxuICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgICAgICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgIDAwMCAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwMDAgICAgIDAwMCAgIFxuICAgICMgICAgMDAwICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgIFxuICAgICMgICAgIDAgICAgICAwMDAgIDAwMDAwMDAwICAwMCAgICAgMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAgIDAwMCAgIFxuXG4gICAgc2V0Vmlld0hlaWdodDogKGgpID0+XG4gICAgICAgIGlmIEB2aWV3SGVpZ2h0ICE9IGhcbiAgICAgICAgICAgIEB2aWV3SGVpZ2h0ID0gaFxuICAgICAgICAgICAgQGNhbGMoKVxuICAgICAgICAgICAgQGJ5IDBcbiAgICAgICAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwICAgICAwMCAgMDAwICAgICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMFxuICAgICMgMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAgIFxuICAgICMgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgMDAwICAgICAgMDAwICAwMDAgMCAwMDAgIDAwMDAwMDAgICAwMDAwMDAwIFxuICAgICMgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAwIDAwMCAgMDAwICAgICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgICAgICAgIDAwMFxuICAgICMgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAwMDAwIFxuICAgICAgICBcbiAgICBzZXROdW1MaW5lczogKG4pID0+XG5cbiAgICAgICAgaWYgQG51bUxpbmVzICE9IG5cbiAgICAgICAgICAgIEBudW1MaW5lcyA9IG5cbiAgICAgICAgICAgIEBmdWxsSGVpZ2h0ID0gQG51bUxpbmVzICogQGxpbmVIZWlnaHQgICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIEBudW1MaW5lc1xuICAgICAgICAgICAgICAgIEBjYWxjKClcbiAgICAgICAgICAgICAgICBAYnkgMFxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIEBpbml0KClcbiAgICAgICAgICAgICAgICBAZW1pdCAnY2xlYXJMaW5lcycgICAgICAgICAgICBcblxuICAgICMgMDAwICAgICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMDBcbiAgICAjIDAwMCAgICAgIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG4gICAgIyAwMDAgICAgICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwMDAgICAgIDAwMCAgIFxuICAgICMgMDAwICAgICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICBcbiAgICAjIDAwMDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgXG5cbiAgICBzZXRMaW5lSGVpZ2h0OiAoaCkgPT5cbiAgICAgICAgICAgIFxuICAgICAgICBpZiBAbGluZUhlaWdodCAhPSBoXG4gICAgICAgICAgICBAbGluZUhlaWdodCA9IGhcbiAgICAgICAgICAgIEBmdWxsSGVpZ2h0ID0gQG51bUxpbmVzICogQGxpbmVIZWlnaHRcbiAgICAgICAgICAgIEBjYWxjKClcbiAgICAgICAgICAgIEBieSAwXG5cbm1vZHVsZS5leHBvcnRzID0gTWFwU2Nyb2xsXG4iXX0=
//# sourceURL=../../coffee/editor/mapscroll.coffee