// koffee 1.4.0
var _, empty, kerror, ref,
    indexOf = [].indexOf;

ref = require('kxk'), empty = ref.empty, kerror = ref.kerror, _ = ref._;

module.exports = {
    actions: {
        menu: 'Select',
        highlightWordAndAddToSelection: {
            name: 'Highlight and Select Word',
            text: 'highlights all occurrences of text in selection or word at cursor and selects the first|next highlight.',
            combo: 'command+d',
            accel: 'ctrl+d'
        },
        selectAllWords: {
            name: 'Select All Words',
            combo: 'command+alt+d',
            accel: 'alt+ctrl+d'
        },
        removeSelectedHighlight: {
            name: 'Remove Highlighted Word from Selection',
            text: "does the inverse of 'highlight and select' word",
            combo: 'command+shift+d',
            accel: 'ctrl+shift+d'
        },
        highlightTextOfSelectionOrWordAtCursor: {
            name: 'Highlight and Select Word',
            text: 'highlights all occurrences of text in selection or word at cursor and selects it. expands to the left if already selected.',
            combo: 'command+e',
            accel: 'alt+e'
        }
    },
    highlightText: function(text, opt) {
        var hls, ref1, ref2, ref3;
        hls = this.rangesForText(text, opt);
        if (hls.length) {
            switch (opt != null ? opt.select : void 0) {
                case 'after':
                    this.selectSingleRange((ref1 = rangeAfterPosInRanges(this.cursorPos(), hls)) != null ? ref1 : _.first(hls));
                    break;
                case 'before':
                    this.selectSingleRange((ref2 = rangeBeforePosInRanges(this.cursorPos(), hls)) != null ? ref2 : _.first(hls));
                    break;
                case 'first':
                    this.selectSingleRange(_.first(hls));
            }
            if (!(opt != null ? opt.noScroll : void 0)) {
                if ((ref3 = this.scroll) != null) {
                    ref3.cursorToTop();
                }
            }
        }
        this.setHighlights(hls);
        this.renderHighlights();
        return this.emit('highlight');
    },
    wordHighlights: function() {
        return this.highlights().filter(function(h) {
            var ref1, ref2, ref3, ref4;
            return !((ref1 = h[2]) != null ? (ref2 = ref1.clss) != null ? ref2.startsWith('stringmatch') : void 0 : void 0) && !((ref3 = h[2]) != null ? (ref4 = ref3.clss) != null ? ref4.startsWith('bracketmatch') : void 0 : void 0);
        });
    },
    highlightForFind: function() {
        var cp, cursorInWordHighlight, wordHighlights;
        if (this.numSelections() === 1 && !empty(this.textInRange(this.selection(0)).trim())) {
            this.highlightText(this.textInRange(this.selection(0)));
        } else {
            cp = this.cursorPos();
            wordHighlights = this.wordHighlights();
            cursorInWordHighlight = wordHighlights.length;
            if (!cursorInWordHighlight) {
                this.highlightTextOfSelectionOrWordAtCursor();
            }
        }
        return this.selectNextHighlight();
    },
    highlightWordAndAddToSelection: function() {
        var cp, cursorInWordHighlight, r, ref1, sr, wordHighlights;
        cp = this.cursorPos();
        wordHighlights = this.wordHighlights();
        cursorInWordHighlight = wordHighlights.length && rangeAtPosInRanges(cp, wordHighlights);
        if (!cursorInWordHighlight) {
            return this.highlightTextOfSelectionOrWordAtCursor();
        } else {
            this["do"].start();
            sr = rangeAtPosInRanges(cp, this["do"].selections());
            if (sr) {
                r = rangeAfterPosInRanges(cp, wordHighlights);
            } else {
                r = rangeAtPosInRanges(cp, wordHighlights);
            }
            if (r != null) {
                r;
            } else {
                r = wordHighlights[0];
            }
            this.addRangeToSelection(r);
            if ((ref1 = this.scroll) != null) {
                ref1.cursorToTop();
            }
            return this["do"].end();
        }
    },
    selectAllWords: function() {
        this.highlightWordAndAddToSelection();
        this["do"].start();
        this["do"].select(this["do"].highlights());
        if (this["do"].numSelections()) {
            this["do"].setCursors(endPositionsFromRanges(this["do"].selections()), {
                main: 'closest'
            });
        }
        return this["do"].end();
    },
    highlightTextOfSelectionOrWordAtCursor: function() {
        var largerRange, largerText, nr, nt, ref1, ref2, sel, srange, text;
        if (this.numSelections() === 0) {
            srange = this.rangeForRealWordAtPos(this.cursorPos());
            if (empty(this.textInRange(srange).trim())) {
                this.clearHighlights();
                return;
            }
            this.selectSingleRange(srange);
        }
        sel = this.selection(0);
        text = this.textInRange(sel);
        if (text.length) {
            if (this.numHighlights()) {
                if (text === this.textInRange(this.highlight(0))) {
                    largerRange = [sel[0], [sel[1][0] - 1, sel[1][1]]];
                    largerText = this.textInRange(largerRange);
                    if ((ref1 = largerText[0], indexOf.call("@#$%&*+-!?:.'\"/", ref1) >= 0) || /[A-Za-z]/.test(largerText[0])) {
                        if (ref2 = largerText[0], indexOf.call("'\"", ref2) >= 0) {
                            nr = [sel[0], [sel[1][0] - 1, sel[1][1] + 1]];
                            nt = this.textInRange(nr);
                            if (nt[nt.length - 1] === largerText[0]) {
                                largerText = nt;
                                largerRange = nr;
                            }
                        } else if (/[A-Za-z]/.test(largerText[0])) {
                            while (largerRange[1][0] > 0 && /[A-Za-z]/.test(this.line(largerRange[0])[largerRange[1][0] - 1])) {
                                largerRange[1][0] -= 1;
                                largerText = this.textInRange(largerRange);
                            }
                        }
                        text = largerText;
                        if (this.numSelections() === 1) {
                            this.selectSingleRange(largerRange);
                        }
                    }
                }
            }
            this.setHighlights(this.rangesForText(text, {
                max: 9999
            }));
            if (this.renderHighlights != null) {
                this.renderHighlights();
                this.emit('highlight');
                return this.focus();
            }
        }
    },
    clearHighlights: function() {
        if (this.numHighlights()) {
            this.setHighlights([]);
            return this.emit('highlight');
        }
    },
    removeSelectedHighlight: function() {
        var cp, hr, sel, sr;
        cp = this.cursorPos();
        sel = this.selections();
        sr = rangeAtPosInRanges(cp, sel);
        hr = rangeAtPosInRanges(cp, this.highlights());
        if (sr && hr) {
            return this.removeSelectionAtIndex(sel.indexOf(sr));
        }
    }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlnaGxpZ2h0LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBT0EsSUFBQSxxQkFBQTtJQUFBOztBQUFBLE1BQXVCLE9BQUEsQ0FBUSxLQUFSLENBQXZCLEVBQUUsaUJBQUYsRUFBUyxtQkFBVCxFQUFpQjs7QUFFakIsTUFBTSxDQUFDLE9BQVAsR0FFSTtJQUFBLE9BQUEsRUFDSTtRQUFBLElBQUEsRUFBTSxRQUFOO1FBRUEsOEJBQUEsRUFDSTtZQUFBLElBQUEsRUFBTywyQkFBUDtZQUNBLElBQUEsRUFBTyx5R0FEUDtZQUVBLEtBQUEsRUFBTyxXQUZQO1lBR0EsS0FBQSxFQUFPLFFBSFA7U0FISjtRQVFBLGNBQUEsRUFDSTtZQUFBLElBQUEsRUFBTyxrQkFBUDtZQUNBLEtBQUEsRUFBTyxlQURQO1lBRUEsS0FBQSxFQUFPLFlBRlA7U0FUSjtRQWFBLHVCQUFBLEVBQ0k7WUFBQSxJQUFBLEVBQU0sd0NBQU47WUFDQSxJQUFBLEVBQU8saURBRFA7WUFFQSxLQUFBLEVBQU8saUJBRlA7WUFHQSxLQUFBLEVBQU8sY0FIUDtTQWRKO1FBbUJBLHNDQUFBLEVBQ0k7WUFBQSxJQUFBLEVBQU8sMkJBQVA7WUFDQSxJQUFBLEVBQU8sNEhBRFA7WUFFQSxLQUFBLEVBQU8sV0FGUDtZQUdBLEtBQUEsRUFBTyxPQUhQO1NBcEJKO0tBREo7SUFnQ0EsYUFBQSxFQUFlLFNBQUMsSUFBRCxFQUFPLEdBQVA7QUFFWCxZQUFBO1FBQUEsR0FBQSxHQUFNLElBQUMsQ0FBQSxhQUFELENBQWUsSUFBZixFQUFxQixHQUFyQjtRQUNOLElBQUcsR0FBRyxDQUFDLE1BQVA7QUFDSSxrQ0FBTyxHQUFHLENBQUUsZUFBWjtBQUFBLHFCQUNTLE9BRFQ7b0JBQ3VCLElBQUMsQ0FBQSxpQkFBRCx3RUFBOEQsQ0FBQyxDQUFDLEtBQUYsQ0FBUSxHQUFSLENBQTlEO0FBQWQ7QUFEVCxxQkFFUyxRQUZUO29CQUV1QixJQUFDLENBQUEsaUJB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QUEsYUFBRCxDQUFBLENBQUEsS0FBb0IsQ0FBdEQ7NEJBQUEsSUFBQyxDQUFBLGlCQUFELENBQW1CLFdBQW5CLEVBQUE7eUJBWko7cUJBSEo7aUJBREo7O1lBa0JBLElBQUMsQ0FBQSxhQUFELENBQWUsSUFBQyxDQUFBLGFBQUQsQ0FBZSxJQUFmLEVBQXFCO2dCQUFBLEdBQUEsRUFBSSxJQUFKO2FBQXJCLENBQWY7WUFHQSxJQUFHLDZCQUFIO2dCQUNJLElBQUMsQ0FBQSxnQkFBRCxDQUFBO2dCQUNBLElBQUMsQ0FBQSxJQUFELENBQU0sV0FBTjt1QkFFQSxJQUFDLENBQUEsS0FBRCxDQUFBLEVBSko7YUF2Qko7O0lBWG9DLENBbkd4QztJQWlKQSxlQUFBLEVBQWlCLFNBQUE7UUFFYixJQUFHLElBQUMsQ0FBQSxhQUFELENBQUEsQ0FBSDtZQUNJLElBQUMsQ0FBQSxhQUFELENBQWUsRUFBZjttQkFDQSxJQUFDLENBQUEsSUFBRCxDQUFNLFdBQU4sRUFGSjs7SUFGYSxDQWpKakI7SUE2SkEsdUJBQUEsRUFBeUIsU0FBQTtBQUVyQixZQUFBO1FBQUEsRUFBQSxHQUFLLElBQUMsQ0FBQSxTQUFELENBQUE7UUFDTCxHQUFBLEdBQU0sSUFBQyxDQUFBLFVBQUQsQ0FBQTtRQUNOLEVBQUEsR0FBSyxrQkFBQSxDQUFtQixFQUFuQixFQUF1QixHQUF2QjtRQUNMLEVBQUEsR0FBSyxrQkFBQSxDQUFtQixFQUFuQixFQUF1QixJQUFDLENBQUEsVUFBRCxDQUFBLENBQXZCO1FBQ0wsSUFBRyxFQUFBLElBQU8sRUFBVjttQkFDSSxJQUFDLENBQUEsc0JBQUQsQ0FBd0IsR0FBRyxDQUFDLE9BQUosQ0FBWSxFQUFaLENBQXhCLEVBREo7O0lBTnFCLENBN0p6QiIsInNvdXJjZXNDb250ZW50IjpbIlxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiMgMDAwMDAwMDAwICAwMDAgIDAwMCAgMDAwMCAgMDAwMDAwMDAwICAwMDAgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwMDAwMDAwICAgICAwMDAgICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcblxueyBlbXB0eSwga2Vycm9yLCBfIH0gPSByZXF1aXJlICdreGsnXG5cbm1vZHVsZS5leHBvcnRzID0gXG5cbiAgICBhY3Rpb25zOlxuICAgICAgICBtZW51OiAnU2VsZWN0J1xuICAgICAgICBcbiAgICAgICAgaGlnaGxpZ2h0V29yZEFuZEFkZFRvU2VsZWN0aW9uOlxuICAgICAgICAgICAgbmFtZTogICdIaWdobGlnaHQgYW5kIFNlbGVjdCBXb3JkJ1xuICAgICAgICAgICAgdGV4dDogICdoaWdobGlnaHRzIGFsbCBvY2N1cnJlbmNlcyBvZiB0ZXh0IGluIHNlbGVjdGlvbiBvciB3b3JkIGF0IGN1cnNvciBhbmQgc2VsZWN0cyB0aGUgZmlyc3R8bmV4dCBoaWdobGlnaHQuJ1xuICAgICAgICAgICAgY29tYm86ICdjb21tYW5kK2QnXG4gICAgICAgICAgICBhY2NlbDogJ2N0cmwrZCdcbiAgICAgICAgICAgIFxuICAgICAgICBzZWxlY3RBbGxXb3JkczpcbiAgICAgICAgICAgIG5hbWU6ICAnU2VsZWN0IEFsbCBXb3JkcydcbiAgICAgICAgICAgIGNvbWJvOiAnY29tbWFuZCthbHQrZCdcbiAgICAgICAgICAgIGFjY2VsOiAnYWx0K2N0cmwrZCdcbiAgICAgICAgICAgIFxuICAgICAgICByZW1vdmVTZWxlY3RlZEhpZ2hsaWdodDpcbiAgICAgICAgICAgIG5hbWU6ICdSZW1vdmUgSGlnaGxpZ2h0ZWQgV29yZCBmcm9tIFNlbGVjdGlvbidcbiAgICAgICAgICAgIHRleHQ6ICBcImRvZXMgdGhlIGludmVyc2Ugb2YgJ2hpZ2hsaWdodCBhbmQgc2VsZWN0JyB3b3JkXCJcbiAgICAgICAgICAgIGNvbWJvOiAnY29tbWFuZCtzaGlmdCtkJ1xuICAgICAgICAgICAgYWNjZWw6ICdjdHJsK3NoaWZ0K2QnXG4gICAgICAgICAgICBcbiAgICAgICAgaGlnaGxpZ2h0VGV4dE9mU2VsZWN0aW9uT3JXb3JkQXRDdXJzb3I6XG4gICAgICAgICAgICBuYW1lOiAgJ0hpZ2hsaWdodCBhbmQgU2VsZWN0IFdvcmQnXG4gICAgICAgICAgICB0ZXh0OiAgJ2hpZ2hsaWdodHMgYWxsIG9jY3VycmVuY2VzIG9mIHRleHQgaW4gc2VsZWN0aW9uIG9yIHdvcmQgYXQgY3Vyc29yIGFuZCBzZWxlY3RzIGl0LiBleHBhbmRzIHRvIHRoZSBsZWZ0IGlmIGFscmVhZHkgc2VsZWN0ZWQuJ1xuICAgICAgICAgICAgY29tYm86ICdjb21tYW5kK2UnXG4gICAgICAgICAgICBhY2NlbDogJ2FsdCtlJ1xuXG4gICAgIyAwMDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgXG4gICAgIyAgICAwMDAgICAgIDAwMCAgICAgICAgMDAwIDAwMCAgICAgIDAwMCAgICAgXG4gICAgIyAgICAwMDAgICAgIDAwMDAwMDAgICAgIDAwMDAwICAgICAgIDAwMCAgICAgXG4gICAgIyAgICAwMDAgICAgIDAwMCAgICAgICAgMDAwIDAwMCAgICAgIDAwMCAgICAgXG4gICAgIyAgICAwMDAgICAgIDAwMDAwMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgXG4gICAgXG4gICAgaGlnaGxpZ2h0VGV4dDogKHRleHQsIG9wdCkgLT4gIyBjYWxsZWQgZnJvbSBmaW5kIGNvbW1hbmRcbiAgICAgICAgXG4gICAgICAgIGhscyA9IEByYW5nZXNGb3JUZXh0IHRleHQsIG9wdFxuICAgICAgICBpZiBobHMubGVuZ3RoXG4gICAgICAgICAgICBzd2l0Y2ggb3B0Py5zZWxlY3RcbiAgICAgICAgICAgICAgICB3aGVuICdhZnRlcicgIHRoZW4gQHNlbGVjdFNpbmdsZVJhbmdlIHJhbmdlQWZ0ZXJQb3NJblJhbmdlcyhAY3Vyc29yUG9zKCksIGhscykgPyBfLmZpcnN0IGhsc1xuICAgICAgICAgICAgICAgIHdoZW4gJ2JlZm9yZScgdGhlbiBAc2VsZWN0U2luZ2xlUmFuZ2UgcmFuZ2VCZWZvcmVQb3NJblJhbmdlcyhAY3Vyc29yUG9zKCksIGhscykgPyBfLmZpcnN0IGhsc1xuICAgICAgICAgICAgICAgIHdoZW4gJ2ZpcnN0JyAgdGhlbiBAc2VsZWN0U2luZ2xlUmFuZ2UgXy5maXJzdCBobHNcbiAgICAgICAgICAgIEBzY3JvbGw/LmN1cnNvclRvVG9wKCkgaWYgbm90IG9wdD8ubm9TY3JvbGwgIyA8IHN1Y2tzIVxuICAgICAgICBAc2V0SGlnaGxpZ2h0cyBobHNcbiAgICAgICAgQHJlbmRlckhpZ2hsaWdodHMoKVxuICAgICAgICBAZW1pdCAnaGlnaGxpZ2h0J1xuICAgIFxuICAgICMgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMCAgICAgMDAwMDAwMCAgXG4gICAgIyAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgIDAwMCAgXG4gICAgIyAwMCAgICAgMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAgICBcbiAgICAgICAgXG4gICAgd29yZEhpZ2hsaWdodHM6IC0+IEBoaWdobGlnaHRzKCkuZmlsdGVyIChoKSAtPiBub3QgaFsyXT8uY2xzcz8uc3RhcnRzV2l0aCgnc3RyaW5nbWF0Y2gnKSBhbmQgbm90IGhbMl0/LmNsc3M/LnN0YXJ0c1dpdGgoJ2JyYWNrZXRtYXRjaCcpXG5cbiAgICBoaWdobGlnaHRGb3JGaW5kOiAtPlxuICAgICAgICBcbiAgICAgICAgaWYgQG51bVNlbGVjdGlvbnMoKSA9PSAxIGFuZCBub3QgZW1wdHkgQHRleHRJblJhbmdlKEBzZWxlY3Rpb24gMCkudHJpbSgpXG4gICAgICAgICAgICBAaGlnaGxpZ2h0VGV4dCBAdGV4dEluUmFuZ2UoQHNlbGVjdGlvbiAwKVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBjcCA9IEBjdXJzb3JQb3MoKVxuICAgICAgICAgICAgd29yZEhpZ2hsaWdodHMgPSBAd29yZEhpZ2hsaWdodHMoKVxuICAgICAgICAgICAgY3Vyc29ySW5Xb3JkSGlnaGxpZ2h0ID0gd29yZEhpZ2hsaWdodHMubGVuZ3RoICNhbmQgcmFuZ2VBdFBvc0luUmFuZ2VzIGNwLCB3b3JkSGlnaGxpZ2h0c1xuICAgICAgICAgICAgaWYgbm90IGN1cnNvckluV29yZEhpZ2hsaWdodFxuICAgICAgICAgICAgICAgIEBoaWdobGlnaHRUZXh0T2ZTZWxlY3Rpb25PcldvcmRBdEN1cnNvcigpICMgdGhpcyBhbHNvIHNlbGVjdHNcbiAgICAgICAgQHNlbGVjdE5leHRIaWdobGlnaHQoKVxuICAgIFxuICAgIGhpZ2hsaWdodFdvcmRBbmRBZGRUb1NlbGVjdGlvbjogLT4gIyBjb21tYW5kK2RcbiAgICAgICAgXG4gICAgICAgIGNwID0gQGN1cnNvclBvcygpXG4gICAgICAgIHdvcmRIaWdobGlnaHRzID0gQHdvcmRIaWdobGlnaHRzKClcbiAgICAgICAgY3Vyc29ySW5Xb3JkSGlnaGxpZ2h0ID0gd29yZEhpZ2hsaWdodHMubGVuZ3RoIGFuZCByYW5nZUF0UG9zSW5SYW5nZXMgY3AsIHdvcmRIaWdobGlnaHRzXG4gICAgICAgIGlmIG5vdCBjdXJzb3JJbldvcmRIaWdobGlnaHRcbiAgICAgICAgICAgIEBoaWdobGlnaHRUZXh0T2ZTZWxlY3Rpb25PcldvcmRBdEN1cnNvcigpICMgdGhpcyBhbHNvIHNlbGVjdHNcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgQGRvLnN0YXJ0KClcbiAgICAgICAgICAgIHNyID0gcmFuZ2VBdFBvc0luUmFuZ2VzIGNwLCBAZG8uc2VsZWN0aW9ucygpXG4gICAgICAgICAgICBpZiBzciAjIGN1cnNvciBpbiBzZWxlY3Rpb24gLT4gc2VsZWN0IG5leHQgaGlnaGxpZ2h0XG4gICAgICAgICAgICAgICAgciA9IHJhbmdlQWZ0ZXJQb3NJblJhbmdlcyBjcCwgd29yZEhpZ2hsaWdodHNcbiAgICAgICAgICAgIGVsc2UgIyBzZWxlY3QgY3VycmVudCBoaWdobGlnaHQgZmlyc3RcbiAgICAgICAgICAgICAgICByID0gcmFuZ2VBdFBvc0luUmFuZ2VzIGNwLCB3b3JkSGlnaGxpZ2h0c1xuICAgICAgICAgICAgciA/PSB3b3JkSGlnaGxpZ2h0c1swXVxuICAgICAgICAgICAgQGFkZFJhbmdlVG9TZWxlY3Rpb24gclxuICAgICAgICAgICAgQHNjcm9sbD8uY3Vyc29yVG9Ub3AoKSAjIDwgc3Vja3MhXG4gICAgICAgICAgICBAZG8uZW5kKClcblxuICAgIHNlbGVjdEFsbFdvcmRzOiAtPiAjIGNvbW1hbmQrYWx0K2RcbiAgICAgICAgXG4gICAgICAgIEBoaWdobGlnaHRXb3JkQW5kQWRkVG9TZWxlY3Rpb24oKVxuICAgICAgICBAZG8uc3RhcnQoKVxuICAgICAgICBAZG8uc2VsZWN0IEBkby5oaWdobGlnaHRzKClcbiAgICAgICAgaWYgQGRvLm51bVNlbGVjdGlvbnMoKVxuICAgICAgICAgICAgQGRvLnNldEN1cnNvcnMgZW5kUG9zaXRpb25zRnJvbVJhbmdlcyhAZG8uc2VsZWN0aW9ucygpKSwgbWFpbjogJ2Nsb3Nlc3QnXG4gICAgICAgIEBkby5lbmQoKVxuXG4gICAgIyAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMCAgICAgIDAwMDAwMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAwICAwMDAgIFxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAgICAwMDAwMDAwICAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAwIDAwMCAgXG4gICAgIyAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIFxuICAgIFxuICAgIGhpZ2hsaWdodFRleHRPZlNlbGVjdGlvbk9yV29yZEF0Q3Vyc29yOiAtPiAjIGNvbW1hbmQrZSAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICBpZiBAbnVtU2VsZWN0aW9ucygpID09IDBcbiAgICAgICAgICAgIHNyYW5nZSA9IEByYW5nZUZvclJlYWxXb3JkQXRQb3MgQGN1cnNvclBvcygpXG4gICAgICAgICAgICBpZiBlbXB0eSBAdGV4dEluUmFuZ2Uoc3JhbmdlKS50cmltKClcbiAgICAgICAgICAgICAgICBAY2xlYXJIaWdobGlnaHRzKClcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIEBzZWxlY3RTaW5nbGVSYW5nZSBzcmFuZ2VcbiAgICAgICAgXG4gICAgICAgIHNlbCA9IEBzZWxlY3Rpb24gMCAgICAgXG4gICAgICAgIHRleHQgPSBAdGV4dEluUmFuZ2Ugc2VsXG4gICAgICAgIGlmIHRleHQubGVuZ3RoXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIEBudW1IaWdobGlnaHRzKClcbiAgICAgICAgICAgICAgICBpZiB0ZXh0ID09IEB0ZXh0SW5SYW5nZSBAaGlnaGxpZ2h0IDAgIyBzZWUgaWYgd2UgY2FuIGdyb3cgdGhlIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIGxhcmdlclJhbmdlID0gW3NlbFswXSwgW3NlbFsxXVswXS0xLCBzZWxbMV1bMV1dXVxuICAgICAgICAgICAgICAgICAgICBsYXJnZXJUZXh0ID0gQHRleHRJblJhbmdlIGxhcmdlclJhbmdlXG4gICAgICAgICAgICAgICAgICAgIGlmIGxhcmdlclRleHRbMF0gaW4gXCJAIyQlJiorLSE/Oi4nXFxcIi9cIiBvciAvW0EtWmEtel0vLnRlc3QgbGFyZ2VyVGV4dFswXVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGFyZ2VyVGV4dFswXSBpbiBcIidcXFwiXCIgIyBncm93IHN0cmluZ3MgaW4gYm90aCBkaXJlY3Rpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnIgPSBbc2VsWzBdLCBbc2VsWzFdWzBdLTEsIHNlbFsxXVsxXSsxXV0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnQgPSBAdGV4dEluUmFuZ2UgbnJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBudFtudC5sZW5ndGgtMV0gPT0gbGFyZ2VyVGV4dFswXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXJnZXJUZXh0ID0gbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFyZ2VyUmFuZ2UgPSBuclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAvW0EtWmEtel0vLnRlc3QgbGFyZ2VyVGV4dFswXSAjIGdyb3cgd2hvbGUgd29yZHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSBsYXJnZXJSYW5nZVsxXVswXSA+IDAgYW5kIC9bQS1aYS16XS8udGVzdCBAbGluZShsYXJnZXJSYW5nZVswXSlbbGFyZ2VyUmFuZ2VbMV1bMF0tMV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFyZ2VyUmFuZ2VbMV1bMF0gLT0gMVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXJnZXJUZXh0ID0gQHRleHRJblJhbmdlIGxhcmdlclJhbmdlXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gbGFyZ2VyVGV4dCAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgQHNlbGVjdFNpbmdsZVJhbmdlIGxhcmdlclJhbmdlIGlmIEBudW1TZWxlY3Rpb25zKCkgPT0gMVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBAc2V0SGlnaGxpZ2h0cyBAcmFuZ2VzRm9yVGV4dCB0ZXh0LCBtYXg6OTk5OVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAjIHRoaXMgc2hvdWxkIGJlIGRvbmUgc29tZXdoZXJlIGVsc2UgKGNvbW1hbmRsaW5lIG9yIGZpbmQvc2VhcmNoIGNvbW1hbmRzKVxuICAgICAgICAgICAgaWYgQHJlbmRlckhpZ2hsaWdodHM/XG4gICAgICAgICAgICAgICAgQHJlbmRlckhpZ2hsaWdodHMoKVxuICAgICAgICAgICAgICAgIEBlbWl0ICdoaWdobGlnaHQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIEBmb2N1cygpXG5cbiAgICAjICAwMDAwMDAwICAwMDAgICAgICAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgIDAwMDAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgXG4gICAgY2xlYXJIaWdobGlnaHRzOiAtPlxuICAgICAgICBcbiAgICAgICAgaWYgQG51bUhpZ2hsaWdodHMoKVxuICAgICAgICAgICAgQHNldEhpZ2hsaWdodHMgW11cbiAgICAgICAgICAgIEBlbWl0ICdoaWdobGlnaHQnXG4gICAgICAgICAgICBcbiAgICAjIDAwMDAwMDAwICAgMDAwMDAwMDAgIDAwICAgICAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwIDAwMCAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAwIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgICAgMCAgICAgIDAwMDAwMDAwICBcbiAgICBcbiAgICByZW1vdmVTZWxlY3RlZEhpZ2hsaWdodDogLT4gIyBjb21tYW5kK3NoaWZ0K2RcbiAgICAgICAgXG4gICAgICAgIGNwID0gQGN1cnNvclBvcygpXG4gICAgICAgIHNlbCA9IEBzZWxlY3Rpb25zKClcbiAgICAgICAgc3IgPSByYW5nZUF0UG9zSW5SYW5nZXMgY3AsIHNlbFxuICAgICAgICBociA9IHJhbmdlQXRQb3NJblJhbmdlcyBjcCwgQGhpZ2hsaWdodHMoKVxuICAgICAgICBpZiBzciBhbmQgaHJcbiAgICAgICAgICAgIEByZW1vdmVTZWxlY3Rpb25BdEluZGV4IHNlbC5pbmRleE9mIHNyIFxuIl19
//# sourceURL=../../../coffee/editor/actions/highlight.coffee