// koffee 1.4.0
var _, empty, klog, ref,
    indexOf = [].indexOf;

ref = require('kxk'), empty = ref.empty, klog = ref.klog, _ = ref._;

module.exports = {
    actions: {
        menu: 'Select',
        highlightWordAndAddToSelection: {
            name: 'Highlight and Select Word',
            text: 'highlights all occurrences of text in selection or word at cursor and selects the first|next highlight.',
            combo: 'command+d',
            accel: 'ctrl+d'
        },
        selectAllWords: {
            name: 'Select All Words',
            combo: 'command+alt+d',
            accel: 'alt+ctrl+d'
        },
        removeSelectedHighlight: {
            name: 'Remove Highlighted Word from Selection',
            text: "does the inverse of 'highlight and select' word",
            combo: 'command+shift+d',
            accel: 'ctrl+shift+d'
        },
        highlightTextOfSelectionOrWordAtCursor: {
            name: 'Highlight and Select Word',
            text: 'highlights all occurrences of text in selection or word at cursor and selects it. expands to the left if already selected.',
            combo: 'command+e',
            accel: 'alt+e'
        }
    },
    highlightText: function(text, opt) {
        var hls, ref1, ref2, ref3;
        hls = this.rangesForText(text, opt);
        if (hls.length) {
            switch (opt != null ? opt.select : void 0) {
                case 'after':
                    this.selectSingleRange((ref1 = rangeAfterPosInRanges(this.cursorPos(), hls)) != null ? ref1 : _.first(hls));
                    break;
                case 'before':
                    this.selectSingleRange((ref2 = rangeBeforePosInRanges(this.cursorPos(), hls)) != null ? ref2 : _.first(hls));
                    break;
                case 'first':
                    this.selectSingleRange(_.first(hls));
            }
            if (!(opt != null ? opt.noScroll : void 0)) {
                if ((ref3 = this.scroll) != null) {
                    ref3.cursorToTop();
                }
            }
        }
        this.setHighlights(hls);
        this.renderHighlights();
        return this.emit('highlight');
    },
    wordHighlights: function() {
        return this.highlights().filter(function(h) {
            var ref1, ref2, ref3, ref4;
            return !((ref1 = h[2]) != null ? (ref2 = ref1.clss) != null ? ref2.startsWith('stringmatch') : void 0 : void 0) && !((ref3 = h[2]) != null ? (ref4 = ref3.clss) != null ? ref4.startsWith('bracketmatch') : void 0 : void 0);
        });
    },
    highlightForFind: function() {
        var cp, cursorInWordHighlight, wordHighlights;
        if (this.numSelections() === 1 && !empty(this.textInRange(this.selection(0)).trim())) {
            this.highlightText(this.textInRange(this.selection(0)));
        } else {
            cp = this.cursorPos();
            wordHighlights = this.wordHighlights();
            cursorInWordHighlight = wordHighlights.length;
            if (!cursorInWordHighlight) {
                this.highlightTextOfSelectionOrWordAtCursor();
            }
        }
        return this.selectNextHighlight();
    },
    highlightWordAndAddToSelection: function() {
        var cp, cursorInWordHighlight, r, ref1, sr, wordHighlights;
        cp = this.cursorPos();
        wordHighlights = this.wordHighlights();
        cursorInWordHighlight = wordHighlights.length && rangeAtPosInRanges(cp, wordHighlights);
        if (!cursorInWordHighlight) {
            return this.highlightTextOfSelectionOrWordAtCursor();
        } else {
            this["do"].start();
            sr = rangeAtPosInRanges(cp, this["do"].selections());
            if (sr) {
                r = rangeAfterPosInRanges(cp, wordHighlights);
            } else {
                r = rangeAtPosInRanges(cp, wordHighlights);
            }
            if (r != null) {
                r;
            } else {
                r = wordHighlights[0];
            }
            this.addRangeToSelection(r);
            if ((ref1 = this.scroll) != null) {
                ref1.cursorToTop();
            }
            return this["do"].end();
        }
    },
    selectAllWords: function() {
        this.highlightWordAndAddToSelection();
        this["do"].start();
        this["do"].select(this["do"].highlights());
        if (this["do"].numSelections()) {
            this["do"].setCursors(endPositionsFromRanges(this["do"].selections()), {
                main: 'closest'
            });
        }
        return this["do"].end();
    },
    highlightTextOfSelectionOrWordAtCursor: function() {
        var largerRange, largerText, nr, nt, ref1, ref2, sel, srange, text;
        if (this.numSelections() === 0) {
            srange = this.rangeForRealWordAtPos(this.cursorPos());
            if (empty(this.textInRange(srange).trim())) {
                this.clearHighlights();
                return;
            }
            this.selectSingleRange(srange);
        }
        sel = this.selection(0);
        text = this.textInRange(sel);
        if (text.length) {
            if (this.numHighlights()) {
                if (text === this.textInRange(this.highlight(0))) {
                    largerRange = [sel[0], [sel[1][0] - 1, sel[1][1]]];
                    largerText = this.textInRange(largerRange);
                    if ((ref1 = largerText[0], indexOf.call("@#$%&*+-!?:.'\"/", ref1) >= 0) || /[A-Za-z]/.test(largerText[0])) {
                        if (ref2 = largerText[0], indexOf.call("'\"", ref2) >= 0) {
                            nr = [sel[0], [sel[1][0] - 1, sel[1][1] + 1]];
                            nt = this.textInRange(nr);
                            if (nt[nt.length - 1] === largerText[0]) {
                                largerText = nt;
                                largerRange = nr;
                            }
                        } else if (/[A-Za-z]/.test(largerText[0])) {
                            while (largerRange[1][0] > 0 && /[A-Za-z]/.test(this.line(largerRange[0])[largerRange[1][0] - 1])) {
                                largerRange[1][0] -= 1;
                                largerText = this.textInRange(largerRange);
                            }
                        }
                        text = largerText;
                        if (this.numSelections() === 1) {
                            this.selectSingleRange(largerRange);
                        }
                    }
                }
            }
            this.setHighlights(this.rangesForText(text, {
                max: 9999
            }));
            if (this.renderHighlights != null) {
                this.renderHighlights();
                this.emit('highlight');
                return this.focus();
            }
        }
    },
    clearHighlights: function() {
        if (this.numHighlights()) {
            this.setHighlights([]);
            return this.emit('highlight');
        }
    },
    removeSelectedHighlight: function() {
        var cp, hr, sel, sr;
        cp = this.cursorPos();
        sel = this.selections();
        sr = rangeAtPosInRanges(cp, sel);
        hr = rangeAtPosInRanges(cp, this.highlights());
        if (sr && hr) {
            return this.removeSelectionAtIndex(sel.indexOf(sr));
        }
    }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlnaGxpZ2h0LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBT0EsSUFBQSxtQkFBQTtJQUFBOztBQUFBLE1BQXFCLE9BQUEsQ0FBUSxLQUFSLENBQXJCLEVBQUUsaUJBQUYsRUFBUyxlQUFULEVBQWU7O0FBRWYsTUFBTSxDQUFDLE9BQVAsR0FFSTtJQUFBLE9BQUEsRUFDSTtRQUFBLElBQUEsRUFBTSxRQUFOO1FBRUEsOEJBQUEsRUFDSTtZQUFBLElBQUEsRUFBTywyQkFBUDtZQUNBLElBQUEsRUFBTyx5R0FEUDtZQUVBLEtBQUEsRUFBTyxXQUZQO1lBR0EsS0FBQSxFQUFPLFFBSFA7U0FISjtRQVFBLGNBQUEsRUFDSTtZQUFBLElBQUEsRUFBTyxrQkFBUDtZQUNBLEtBQUEsRUFBTyxlQURQO1lBRUEsS0FBQSxFQUFPLFlBRlA7U0FUSjtRQWFBLHVCQUFBLEVBQ0k7WUFBQSxJQUFBLEVBQU0sd0NBQU47WUFDQSxJQUFBLEVBQU8saURBRFA7WUFFQSxLQUFBLEVBQU8saUJBRlA7WUFHQSxLQUFBLEVBQU8sY0FIUDtTQWRKO1FBbUJBLHNDQUFBLEVBQ0k7WUFBQSxJQUFBLEVBQU8sMkJBQVA7WUFDQSxJQUFBLEVBQU8sNEhBRFA7WUFFQSxLQUFBLEVBQU8sV0FGUDtZQUdBLEtBQUEsRUFBTyxPQUhQO1NBcEJKO0tBREo7SUFnQ0EsYUFBQSxFQUFlLFNBQUMsSUFBRCxFQUFPLEdBQVA7QUFFWCxZQUFBO1FBQUEsR0FBQSxHQUFNLElBQUMsQ0FBQSxhQUFELENBQWUsSUFBZixFQUFxQixHQUFyQjtRQUNOLElBQUcsR0FBRyxDQUFDLE1BQVA7QUFDSSxrQ0FBTyxHQUFHLENBQUUsZUFBWjtBQUFBLHFCQUNTLE9BRFQ7b0JBQ3VCLElBQUMsQ0FBQSxpQkFBRCx3RUFBOEQsQ0FBQyxDQUFDLEtBQUYsQ0FBUSxHQUFSLENBQTlEO0FBQWQ7QUFEVCxxQkFFUyxRQUZUO29CQUV1QixJQUFDLENBQUEsaUJBQUQs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YUFBRCxDQUFBLENBQUEsS0FBb0IsQ0FBdEQ7NEJBQUEsSUFBQyxDQUFBLGlCQUFELENBQW1CLFdBQW5CLEVBQUE7eUJBWko7cUJBSEo7aUJBREo7O1lBa0JBLElBQUMsQ0FBQSxhQUFELENBQWUsSUFBQyxDQUFBLGFBQUQsQ0FBZSxJQUFmLEVBQXFCO2dCQUFBLEdBQUEsRUFBSSxJQUFKO2FBQXJCLENBQWY7WUFHQSxJQUFHLDZCQUFIO2dCQUNJLElBQUMsQ0FBQSxnQkFBRCxDQUFBO2dCQUNBLElBQUMsQ0FBQSxJQUFELENBQU0sV0FBTjt1QkFFQSxJQUFDLENBQUEsS0FBRCxDQUFBLEVBSko7YUF2Qko7O0lBWG9DLENBbkd4QztJQWlKQSxlQUFBLEVBQWlCLFNBQUE7UUFFYixJQUFHLElBQUMsQ0FBQSxhQUFELENBQUEsQ0FBSDtZQUNJLElBQUMsQ0FBQSxhQUFELENBQWUsRUFBZjttQkFDQSxJQUFDLENBQUEsSUFBRCxDQUFNLFdBQU4sRUFGSjs7SUFGYSxDQWpKakI7SUE2SkEsdUJBQUEsRUFBeUIsU0FBQTtBQUVyQixZQUFBO1FBQUEsRUFBQSxHQUFLLElBQUMsQ0FBQSxTQUFELENBQUE7UUFDTCxHQUFBLEdBQU0sSUFBQyxDQUFBLFVBQUQsQ0FBQTtRQUNOLEVBQUEsR0FBSyxrQkFBQSxDQUFtQixFQUFuQixFQUF1QixHQUF2QjtRQUNMLEVBQUEsR0FBSyxrQkFBQSxDQUFtQixFQUFuQixFQUF1QixJQUFDLENBQUEsVUFBRCxDQUFBLENBQXZCO1FBQ0wsSUFBRyxFQUFBLElBQU8sRUFBVjttQkFDSSxJQUFDLENBQUEsc0JBQUQsQ0FBd0IsR0FBRyxDQUFDLE9BQUosQ0FBWSxFQUFaLENBQXhCLEVBREo7O0lBTnFCLENBN0p6QiIsInNvdXJjZXNDb250ZW50IjpbIlxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiMgMDAwMDAwMDAwICAwMDAgIDAwMCAgMDAwMCAgMDAwMDAwMDAwICAwMDAgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwMDAwMDAwICAgICAwMDAgICAgIFxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcblxueyBlbXB0eSwga2xvZywgXyB9ID0gcmVxdWlyZSAna3hrJ1xuXG5tb2R1bGUuZXhwb3J0cyA9IFxuXG4gICAgYWN0aW9uczpcbiAgICAgICAgbWVudTogJ1NlbGVjdCdcbiAgICAgICAgXG4gICAgICAgIGhpZ2hsaWdodFdvcmRBbmRBZGRUb1NlbGVjdGlvbjpcbiAgICAgICAgICAgIG5hbWU6ICAnSGlnaGxpZ2h0IGFuZCBTZWxlY3QgV29yZCdcbiAgICAgICAgICAgIHRleHQ6ICAnaGlnaGxpZ2h0cyBhbGwgb2NjdXJyZW5jZXMgb2YgdGV4dCBpbiBzZWxlY3Rpb24gb3Igd29yZCBhdCBjdXJzb3IgYW5kIHNlbGVjdHMgdGhlIGZpcnN0fG5leHQgaGlnaGxpZ2h0LidcbiAgICAgICAgICAgIGNvbWJvOiAnY29tbWFuZCtkJ1xuICAgICAgICAgICAgYWNjZWw6ICdjdHJsK2QnXG4gICAgICAgICAgICBcbiAgICAgICAgc2VsZWN0QWxsV29yZHM6XG4gICAgICAgICAgICBuYW1lOiAgJ1NlbGVjdCBBbGwgV29yZHMnXG4gICAgICAgICAgICBjb21ibzogJ2NvbW1hbmQrYWx0K2QnXG4gICAgICAgICAgICBhY2NlbDogJ2FsdCtjdHJsK2QnXG4gICAgICAgICAgICBcbiAgICAgICAgcmVtb3ZlU2VsZWN0ZWRIaWdobGlnaHQ6XG4gICAgICAgICAgICBuYW1lOiAnUmVtb3ZlIEhpZ2hsaWdodGVkIFdvcmQgZnJvbSBTZWxlY3Rpb24nXG4gICAgICAgICAgICB0ZXh0OiAgXCJkb2VzIHRoZSBpbnZlcnNlIG9mICdoaWdobGlnaHQgYW5kIHNlbGVjdCcgd29yZFwiXG4gICAgICAgICAgICBjb21ibzogJ2NvbW1hbmQrc2hpZnQrZCdcbiAgICAgICAgICAgIGFjY2VsOiAnY3RybCtzaGlmdCtkJ1xuICAgICAgICAgICAgXG4gICAgICAgIGhpZ2hsaWdodFRleHRPZlNlbGVjdGlvbk9yV29yZEF0Q3Vyc29yOlxuICAgICAgICAgICAgbmFtZTogICdIaWdobGlnaHQgYW5kIFNlbGVjdCBXb3JkJ1xuICAgICAgICAgICAgdGV4dDogICdoaWdobGlnaHRzIGFsbCBvY2N1cnJlbmNlcyBvZiB0ZXh0IGluIHNlbGVjdGlvbiBvciB3b3JkIGF0IGN1cnNvciBhbmQgc2VsZWN0cyBpdC4gZXhwYW5kcyB0byB0aGUgbGVmdCBpZiBhbHJlYWR5IHNlbGVjdGVkLidcbiAgICAgICAgICAgIGNvbWJvOiAnY29tbWFuZCtlJ1xuICAgICAgICAgICAgYWNjZWw6ICdhbHQrZSdcblxuICAgICMgMDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDAgIFxuICAgICMgICAgMDAwICAgICAwMDAgICAgICAgIDAwMCAwMDAgICAgICAwMDAgICAgIFxuICAgICMgICAgMDAwICAgICAwMDAwMDAwICAgICAwMDAwMCAgICAgICAwMDAgICAgIFxuICAgICMgICAgMDAwICAgICAwMDAgICAgICAgIDAwMCAwMDAgICAgICAwMDAgICAgIFxuICAgICMgICAgMDAwICAgICAwMDAwMDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIFxuICAgIFxuICAgIGhpZ2hsaWdodFRleHQ6ICh0ZXh0LCBvcHQpIC0+ICMgY2FsbGVkIGZyb20gZmluZCBjb21tYW5kXG4gICAgICAgIFxuICAgICAgICBobHMgPSBAcmFuZ2VzRm9yVGV4dCB0ZXh0LCBvcHRcbiAgICAgICAgaWYgaGxzLmxlbmd0aFxuICAgICAgICAgICAgc3dpdGNoIG9wdD8uc2VsZWN0XG4gICAgICAgICAgICAgICAgd2hlbiAnYWZ0ZXInICB0aGVuIEBzZWxlY3RTaW5nbGVSYW5nZSByYW5nZUFmdGVyUG9zSW5SYW5nZXMoQGN1cnNvclBvcygpLCBobHMpID8gXy5maXJzdCBobHNcbiAgICAgICAgICAgICAgICB3aGVuICdiZWZvcmUnIHRoZW4gQHNlbGVjdFNpbmdsZVJhbmdlIHJhbmdlQmVmb3JlUG9zSW5SYW5nZXMoQGN1cnNvclBvcygpLCBobHMpID8gXy5maXJzdCBobHNcbiAgICAgICAgICAgICAgICB3aGVuICdmaXJzdCcgIHRoZW4gQHNlbGVjdFNpbmdsZVJhbmdlIF8uZmlyc3QgaGxzXG4gICAgICAgICAgICBAc2Nyb2xsPy5jdXJzb3JUb1RvcCgpIGlmIG5vdCBvcHQ/Lm5vU2Nyb2xsICMgPCBzdWNrcyFcbiAgICAgICAgQHNldEhpZ2hsaWdodHMgaGxzXG4gICAgICAgIEByZW5kZXJIaWdobGlnaHRzKClcbiAgICAgICAgQGVtaXQgJ2hpZ2hsaWdodCdcbiAgICBcbiAgICAjIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAgICAgIDAwMDAwMDAgIFxuICAgICMgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgXG4gICAgIyAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgICAwMDAgIFxuICAgICMgMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwICAgXG4gICAgICAgIFxuICAgIHdvcmRIaWdobGlnaHRzOiAtPiBAaGlnaGxpZ2h0cygpLmZpbHRlciAoaCkgLT4gbm90IGhbMl0/LmNsc3M/LnN0YXJ0c1dpdGgoJ3N0cmluZ21hdGNoJykgYW5kIG5vdCBoWzJdPy5jbHNzPy5zdGFydHNXaXRoKCdicmFja2V0bWF0Y2gnKVxuXG4gICAgaGlnaGxpZ2h0Rm9yRmluZDogLT5cbiAgICAgICAgXG4gICAgICAgIGlmIEBudW1TZWxlY3Rpb25zKCkgPT0gMSBhbmQgbm90IGVtcHR5IEB0ZXh0SW5SYW5nZShAc2VsZWN0aW9uIDApLnRyaW0oKVxuICAgICAgICAgICAgQGhpZ2hsaWdodFRleHQgQHRleHRJblJhbmdlKEBzZWxlY3Rpb24gMClcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgY3AgPSBAY3Vyc29yUG9zKClcbiAgICAgICAgICAgIHdvcmRIaWdobGlnaHRzID0gQHdvcmRIaWdobGlnaHRzKClcbiAgICAgICAgICAgIGN1cnNvckluV29yZEhpZ2hsaWdodCA9IHdvcmRIaWdobGlnaHRzLmxlbmd0aCAjYW5kIHJhbmdlQXRQb3NJblJhbmdlcyBjcCwgd29yZEhpZ2hsaWdodHNcbiAgICAgICAgICAgIGlmIG5vdCBjdXJzb3JJbldvcmRIaWdobGlnaHRcbiAgICAgICAgICAgICAgICBAaGlnaGxpZ2h0VGV4dE9mU2VsZWN0aW9uT3JXb3JkQXRDdXJzb3IoKSAjIHRoaXMgYWxzbyBzZWxlY3RzXG4gICAgICAgIEBzZWxlY3ROZXh0SGlnaGxpZ2h0KClcbiAgICBcbiAgICBoaWdobGlnaHRXb3JkQW5kQWRkVG9TZWxlY3Rpb246IC0+ICMgY29tbWFuZCtkXG4gICAgICAgIFxuICAgICAgICBjcCA9IEBjdXJzb3JQb3MoKVxuICAgICAgICB3b3JkSGlnaGxpZ2h0cyA9IEB3b3JkSGlnaGxpZ2h0cygpXG4gICAgICAgIGN1cnNvckluV29yZEhpZ2hsaWdodCA9IHdvcmRIaWdobGlnaHRzLmxlbmd0aCBhbmQgcmFuZ2VBdFBvc0luUmFuZ2VzIGNwLCB3b3JkSGlnaGxpZ2h0c1xuICAgICAgICBpZiBub3QgY3Vyc29ySW5Xb3JkSGlnaGxpZ2h0XG4gICAgICAgICAgICBAaGlnaGxpZ2h0VGV4dE9mU2VsZWN0aW9uT3JXb3JkQXRDdXJzb3IoKSAjIHRoaXMgYWxzbyBzZWxlY3RzXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIEBkby5zdGFydCgpXG4gICAgICAgICAgICBzciA9IHJhbmdlQXRQb3NJblJhbmdlcyBjcCwgQGRvLnNlbGVjdGlvbnMoKVxuICAgICAgICAgICAgaWYgc3IgIyBjdXJzb3IgaW4gc2VsZWN0aW9uIC0+IHNlbGVjdCBuZXh0IGhpZ2hsaWdodFxuICAgICAgICAgICAgICAgIHIgPSByYW5nZUFmdGVyUG9zSW5SYW5nZXMgY3AsIHdvcmRIaWdobGlnaHRzXG4gICAgICAgICAgICBlbHNlICMgc2VsZWN0IGN1cnJlbnQgaGlnaGxpZ2h0IGZpcnN0XG4gICAgICAgICAgICAgICAgciA9IHJhbmdlQXRQb3NJblJhbmdlcyBjcCwgd29yZEhpZ2hsaWdodHNcbiAgICAgICAgICAgIHIgPz0gd29yZEhpZ2hsaWdodHNbMF1cbiAgICAgICAgICAgIEBhZGRSYW5nZVRvU2VsZWN0aW9uIHJcbiAgICAgICAgICAgIEBzY3JvbGw/LmN1cnNvclRvVG9wKCkgIyA8IHN1Y2tzIVxuICAgICAgICAgICAgQGRvLmVuZCgpXG5cbiAgICBzZWxlY3RBbGxXb3JkczogLT4gIyBjb21tYW5kK2FsdCtkXG4gICAgICAgIFxuICAgICAgICBAaGlnaGxpZ2h0V29yZEFuZEFkZFRvU2VsZWN0aW9uKClcbiAgICAgICAgQGRvLnN0YXJ0KClcbiAgICAgICAgQGRvLnNlbGVjdCBAZG8uaGlnaGxpZ2h0cygpXG4gICAgICAgIGlmIEBkby5udW1TZWxlY3Rpb25zKClcbiAgICAgICAgICAgIEBkby5zZXRDdXJzb3JzIGVuZFBvc2l0aW9uc0Zyb21SYW5nZXMoQGRvLnNlbGVjdGlvbnMoKSksIG1haW46ICdjbG9zZXN0J1xuICAgICAgICBAZG8uZW5kKClcblxuICAgICMgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAgICAwMDAwMDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgICAgMDAwMDAwMCAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgMCAwMDAgIFxuICAgICMgICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAgICAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgXG4gICAgIyAwMDAwMDAwICAgMDAwMDAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICBcbiAgICBcbiAgICBoaWdobGlnaHRUZXh0T2ZTZWxlY3Rpb25PcldvcmRBdEN1cnNvcjogLT4gIyBjb21tYW5kK2UgICAgICAgXG4gICAgICAgICAgICBcbiAgICAgICAgaWYgQG51bVNlbGVjdGlvbnMoKSA9PSAwXG4gICAgICAgICAgICBzcmFuZ2UgPSBAcmFuZ2VGb3JSZWFsV29yZEF0UG9zIEBjdXJzb3JQb3MoKVxuICAgICAgICAgICAgaWYgZW1wdHkgQHRleHRJblJhbmdlKHNyYW5nZSkudHJpbSgpXG4gICAgICAgICAgICAgICAgQGNsZWFySGlnaGxpZ2h0cygpXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICBAc2VsZWN0U2luZ2xlUmFuZ2Ugc3JhbmdlXG4gICAgICAgIFxuICAgICAgICBzZWwgPSBAc2VsZWN0aW9uIDAgICAgIFxuICAgICAgICB0ZXh0ID0gQHRleHRJblJhbmdlIHNlbFxuICAgICAgICBpZiB0ZXh0Lmxlbmd0aFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBAbnVtSGlnaGxpZ2h0cygpXG4gICAgICAgICAgICAgICAgaWYgdGV4dCA9PSBAdGV4dEluUmFuZ2UgQGhpZ2hsaWdodCAwICMgc2VlIGlmIHdlIGNhbiBncm93IHRoZSBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICBsYXJnZXJSYW5nZSA9IFtzZWxbMF0sIFtzZWxbMV1bMF0tMSwgc2VsWzFdWzFdXV1cbiAgICAgICAgICAgICAgICAgICAgbGFyZ2VyVGV4dCA9IEB0ZXh0SW5SYW5nZSBsYXJnZXJSYW5nZVxuICAgICAgICAgICAgICAgICAgICBpZiBsYXJnZXJUZXh0WzBdIGluIFwiQCMkJSYqKy0hPzouJ1xcXCIvXCIgb3IgL1tBLVphLXpdLy50ZXN0IGxhcmdlclRleHRbMF1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxhcmdlclRleHRbMF0gaW4gXCInXFxcIlwiICMgZ3JvdyBzdHJpbmdzIGluIGJvdGggZGlyZWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5yID0gW3NlbFswXSwgW3NlbFsxXVswXS0xLCBzZWxbMV1bMV0rMV1dIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG50ID0gQHRleHRJblJhbmdlIG5yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbnRbbnQubGVuZ3RoLTFdID09IGxhcmdlclRleHRbMF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFyZ2VyVGV4dCA9IG50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhcmdlclJhbmdlID0gbnJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgL1tBLVphLXpdLy50ZXN0IGxhcmdlclRleHRbMF0gIyBncm93IHdob2xlIHdvcmRzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgbGFyZ2VyUmFuZ2VbMV1bMF0gPiAwIGFuZCAvW0EtWmEtel0vLnRlc3QgQGxpbmUobGFyZ2VyUmFuZ2VbMF0pW2xhcmdlclJhbmdlWzFdWzBdLTFdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhcmdlclJhbmdlWzFdWzBdIC09IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFyZ2VyVGV4dCA9IEB0ZXh0SW5SYW5nZSBsYXJnZXJSYW5nZVxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IGxhcmdlclRleHQgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIEBzZWxlY3RTaW5nbGVSYW5nZSBsYXJnZXJSYW5nZSBpZiBAbnVtU2VsZWN0aW9ucygpID09IDFcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgQHNldEhpZ2hsaWdodHMgQHJhbmdlc0ZvclRleHQgdGV4dCwgbWF4Ojk5OTlcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgIyB0aGlzIHNob3VsZCBiZSBkb25lIHNvbWV3aGVyZSBlbHNlIChjb21tYW5kbGluZSBvciBmaW5kL3NlYXJjaCBjb21tYW5kcylcbiAgICAgICAgICAgIGlmIEByZW5kZXJIaWdobGlnaHRzP1xuICAgICAgICAgICAgICAgIEByZW5kZXJIaWdobGlnaHRzKClcbiAgICAgICAgICAgICAgICBAZW1pdCAnaGlnaGxpZ2h0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBAZm9jdXMoKVxuXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgICAgMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMDAwMDAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjICAwMDAwMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgIFxuICAgIGNsZWFySGlnaGxpZ2h0czogLT5cbiAgICAgICAgXG4gICAgICAgIGlmIEBudW1IaWdobGlnaHRzKClcbiAgICAgICAgICAgIEBzZXRIaWdobGlnaHRzIFtdXG4gICAgICAgICAgICBAZW1pdCAnaGlnaGxpZ2h0J1xuICAgICAgICAgICAgXG4gICAgIyAwMDAwMDAwMCAgIDAwMDAwMDAwICAwMCAgICAgMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMCAwMDAgICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgICAgIDAgICAgICAwMDAwMDAwMCAgXG4gICAgXG4gICAgcmVtb3ZlU2VsZWN0ZWRIaWdobGlnaHQ6IC0+ICMgY29tbWFuZCtzaGlmdCtkXG4gICAgICAgIFxuICAgICAgICBjcCA9IEBjdXJzb3JQb3MoKVxuICAgICAgICBzZWwgPSBAc2VsZWN0aW9ucygpXG4gICAgICAgIHNyID0gcmFuZ2VBdFBvc0luUmFuZ2VzIGNwLCBzZWxcbiAgICAgICAgaHIgPSByYW5nZUF0UG9zSW5SYW5nZXMgY3AsIEBoaWdobGlnaHRzKClcbiAgICAgICAgaWYgc3IgYW5kIGhyXG4gICAgICAgICAgICBAcmVtb3ZlU2VsZWN0aW9uQXRJbmRleCBzZWwuaW5kZXhPZiBzciBcbiJdfQ==
//# sourceURL=../../../coffee/editor/actions/highlight.coffee