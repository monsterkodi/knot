// koffee 1.4.0
var _, clipboard, electron, empty, klog, ref;

ref = require('kxk'), empty = ref.empty, klog = ref.klog, _ = ref._;

electron = require('electron');

clipboard = electron.clipboard;

module.exports = {
    actions: {
        cutCopyPaste: {
            combos: ['command+x', 'ctrl+x', 'command+c', 'ctrl+c', 'command+v', 'ctrl+v']
        }
    },
    cutCopyPaste: function(key, info) {
        switch (key) {
            case 'x':
                return this.cut();
            case 'c':
                return this.copy();
            case 'v':
                return this.paste();
        }
    },
    cut: function() {
        this["do"].start();
        this.copy();
        this.deleteSelectionOrCursorLines();
        return this["do"].end();
    },
    copy: function() {
        return clipboard != null ? clipboard.writeText(this.textOfSelectionForClipboard()) : void 0;
    },
    paste: function() {
        return this.pasteText(clipboard != null ? clipboard.readText() : void 0);
    },
    replaceSelectedText: function(lines) {
        var i, insert, j, ldiff, len, len1, newSelections, ns, oldLength, os, ref1;
        this["do"].start();
        newSelections = this["do"].selections();
        for (i = 0, len = newSelections.length; i < len; i++) {
            ns = newSelections[i];
            insert = lines.shift();
            oldLength = ns[1][1] - ns[1][0];
            this["do"].change(ns[0], this["do"].line(ns[0]).splice(ns[1][0], oldLength, insert));
            ldiff = insert.length - oldLength;
            ref1 = rangesAfterLineColInRanges(ns[0], ns[1][1], newSelections);
            for (j = 0, len1 = ref1.length; j < len1; j++) {
                os = ref1[j];
                os[1][0] += ldiff;
                os[1][1] += ldiff;
            }
            ns[1][1] += ldiff;
        }
        this["do"].select(newSelections);
        this["do"].setCursors(endPositionsFromRanges(newSelections));
        return this["do"].end();
    },
    pasteText: function(text) {
        var after, before, c, ci, cp, i, indt, insert, isInputCursorAndSelection, j, k, len, len1, li, line, lines, newCursors, ref1, ref2, ref3, removeLastLine;
        lines = text.split('\n');
        isInputCursorAndSelection = this.isInputCursor() && this.selectedLineIndices().length === 1 && this.selectedLineIndices()[0] === this.numLines() - 1;
        if (isInputCursorAndSelection && lines.length === this.numSelections()) {
            this.replaceSelectedText(lines);
            this.select([]);
            return;
        }
        if ((this.numLines() === 1 && this.text() === '' && lines.length > 1) || areSameRanges(this.rangesForAllLines(), this.selections())) {
            removeLastLine = true;
        }
        if (isInputCursorAndSelection) {
            this.deleteSelection();
        } else {
            this.select([]);
        }
        this["do"].start();
        newCursors = this.restoreInputCursor();
        if (newCursors.length > 1 && lines.length === 1) {
            lines = (function() {
                var i, len, results;
                results = [];
                for (i = 0, len = newCursors.length; i < len; i++) {
                    c = newCursors[i];
                    results.push(lines[0]);
                }
                return results;
            })();
        }
        if (newCursors.length > 1 || (lines.length === 1)) {
            for (ci = i = ref1 = newCursors.length - 1; ref1 <= 0 ? i <= 0 : i >= 0; ci = ref1 <= 0 ? ++i : --i) {
                c = newCursors[ci];
                insert = lines[ci % lines.length];
                this["do"].change(c[1], this["do"].line(c[1]).splice(c[0], 0, insert));
                ref2 = positionsAfterLineColInPositions(c[1], c[0] - 1, newCursors);
                for (j = 0, len = ref2.length; j < len; j++) {
                    c = ref2[j];
                    cursorDelta(c, insert.length);
                }
            }
        } else {
            cp = newCursors[0];
            li = cp[1];
            newCursors = null;
            if (cp[0] > 0) {
                ref3 = this.splitStateLineAtPos(this["do"], cp), before = ref3[0], after = ref3[1];
                after = after.trimLeft();
                indt = _.padStart('', indentationInLine(this["do"].line(cp[1])));
                if (before.trim().length) {
                    this["do"].change(li, before);
                    li += 1;
                    if ((indt + after).trim().length) {
                        lines.push(indt + after);
                        newCursors = [[0, li + lines.length - 1]];
                    }
                }
            } else {
                if (this["do"].line(li).length === 0 && !removeLastLine) {
                    li += 1;
                }
            }
            for (k = 0, len1 = lines.length; k < len1; k++) {
                line = lines[k];
                this["do"].insert(li, line);
                li += 1;
            }
            if (empty(newCursors)) {
                newCursors = [[0, li]];
            }
        }
        if (removeLastLine) {
            this["do"]["delete"](this["do"].numLines() - 1);
        }
        this["do"].setCursors(newCursors);
        return this["do"].end();
    }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFzdGUuanMiLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFPQSxJQUFBOztBQUFBLE1BQXFCLE9BQUEsQ0FBUSxLQUFSLENBQXJCLEVBQUUsaUJBQUYsRUFBUyxlQUFULEVBQWU7O0FBRWYsUUFBQSxHQUFZLE9BQUEsQ0FBUSxVQUFSOztBQUNaLFNBQUEsR0FBWSxRQUFRLENBQUM7O0FBRXJCLE1BQU0sQ0FBQyxPQUFQLEdBRUk7SUFBQSxPQUFBLEVBRUk7UUFBQSxZQUFBLEVBQ0k7WUFBQSxNQUFBLEVBQVEsQ0FBQyxXQUFELEVBQWEsUUFBYixFQUFzQixXQUF0QixFQUFrQyxRQUFsQyxFQUEyQyxXQUEzQyxFQUF1RCxRQUF2RCxDQUFSO1NBREo7S0FGSjtJQUtBLFlBQUEsRUFBYyxTQUFDLEdBQUQsRUFBTSxJQUFOO0FBQ1YsZ0JBQU8sR0FBUDtBQUFBLGlCQUNTLEdBRFQ7dUJBQ2tCLElBQUMsQ0FBQSxHQUFELENBQUE7QUFEbEIsaUJBRVMsR0FGVDt1QkFFa0IsSUFBQyxDQUFBLElBQUQsQ0FBQTtBQUZsQixpQkFHUyxHQUhUO3VCQUdrQixJQUFDLENBQUEsS0FBRCxDQUFBO0FBSGxCO0lBRFUsQ0FMZDtJQVdBLEdBQUEsRUFBSyxTQUFBO1FBQ0QsSUFBQyxFQUFBLEVBQUEsRUFBRSxDQUFDLEtBQUosQ0FBQTtRQUNBLElBQUMsQ0FBQSxJQUFELENBQUE7UUFDQSxJQUFDLENBQUEsNEJBQUQsQ0FBQTtlQUNBLElBQUMsRUFBQSxFQUFBLEVBQUUsQ0FBQyxHQUFKLENBQUE7SUFKQyxDQVhMO0lBaUJBLElBQUEsRUFBTSxTQUFBO21DQUFHLFNBQVMsQ0FBRSxTQUFYLENBQXFCLElBQUMsQ0FBQSwyQkFBRCxDQUFBLENBQXJCO0lBQUgsQ0FqQk47SUFtQkEsS0FBQSxFQUFPLFNBQUE7ZUFBRyxJQUFDLENBQUEsU0FBRCxxQkFBVyxTQUFTLENBQUUsUUFBWCxDQUFBLFVBQVg7SUFBSCxDQW5CUDtJQTJC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QUFYLEVBQWUsTUFBZjtvQkFDQSxFQUFBLElBQU07b0JBQ04sSUFBRyxDQUFDLElBQUEsR0FBTyxLQUFSLENBQWMsQ0FBQyxJQUFmLENBQUEsQ0FBcUIsQ0FBQyxNQUF6Qjt3QkFDSSxLQUFLLENBQUMsSUFBTixDQUFXLElBQUEsR0FBTyxLQUFsQjt3QkFDQSxVQUFBLEdBQWEsQ0FBQyxDQUFDLENBQUQsRUFBRyxFQUFBLEdBQUcsS0FBSyxDQUFDLE1BQVQsR0FBZ0IsQ0FBbkIsQ0FBRCxFQUZqQjtxQkFISjtpQkFOSjthQUFBLE1BQUE7Z0JBYUksSUFBRyxJQUFDLEVBQUEsRUFBQSxFQUFFLENBQUMsSUFBSixDQUFTLEVBQVQsQ0FBWSxDQUFDLE1BQWIsS0FBdUIsQ0FBdkIsSUFBNkIsQ0FBSSxjQUFwQztvQkFDSSxFQUFBLElBQU0sRUFEVjtpQkFiSjs7QUFnQkEsaUJBQUEseUNBQUE7O2dCQUNJLElBQUMsRUFBQSxFQUFBLEVBQUUsQ0FBQyxNQUFKLENBQVcsRUFBWCxFQUFlLElBQWY7Z0JBQ0EsRUFBQSxJQUFNO0FBRlY7WUFJQSxJQUEwQixLQUFBLENBQU0sVUFBTixDQUExQjtnQkFBQSxVQUFBLEdBQWEsQ0FBQyxDQUFDLENBQUQsRUFBSSxFQUFKLENBQUQsRUFBYjthQWxDSjs7UUFvQ0EsSUFBRyxjQUFIO1lBQ0ksSUFBQyxFQUFBLEVBQUEsRUFBRSxFQUFDLE1BQUQsRUFBSCxDQUFXLElBQUMsRUFBQSxFQUFBLEVBQUUsQ0FBQyxRQUFKLENBQUEsQ0FBQSxHQUFlLENBQTFCLEVBREo7O1FBR0EsSUFBQyxFQUFBLEVBQUEsRUFBRSxDQUFDLFVBQUosQ0FBZSxVQUFmO2VBQ0EsSUFBQyxFQUFBLEVBQUEsRUFBRSxDQUFDLEdBQUosQ0FBQTtJQW5FTyxDQXBEWCIsInNvdXJjZXNDb250ZW50IjpbIlxuIyAwMDAwMDAwMCAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMFxuIyAwMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMFxuIyAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgICAwMDAgICAgIDAwMCAgICAgMDAwXG4jIDAwMCAgICAgICAgMDAwICAgMDAwICAwMDAwMDAwICAgICAgMDAwICAgICAwMDAwMDAwMFxuXG57IGVtcHR5LCBrbG9nLCBfIH0gPSByZXF1aXJlICdreGsnXG5cbmVsZWN0cm9uICA9IHJlcXVpcmUgJ2VsZWN0cm9uJ1xuY2xpcGJvYXJkID0gZWxlY3Ryb24uY2xpcGJvYXJkXG5cbm1vZHVsZS5leHBvcnRzID1cblxuICAgIGFjdGlvbnM6XG5cbiAgICAgICAgY3V0Q29weVBhc3RlOlxuICAgICAgICAgICAgY29tYm9zOiBbJ2NvbW1hbmQreCcgJ2N0cmwreCcgJ2NvbW1hbmQrYycgJ2N0cmwrYycgJ2NvbW1hbmQrdicgJ2N0cmwrdiddXG5cbiAgICBjdXRDb3B5UGFzdGU6IChrZXksIGluZm8pIC0+XG4gICAgICAgIHN3aXRjaCBrZXlcbiAgICAgICAgICAgIHdoZW4gJ3gnIHRoZW4gQGN1dCgpXG4gICAgICAgICAgICB3aGVuICdjJyB0aGVuIEBjb3B5KClcbiAgICAgICAgICAgIHdoZW4gJ3YnIHRoZW4gQHBhc3RlKClcblxuICAgIGN1dDogLT5cbiAgICAgICAgQGRvLnN0YXJ0KClcbiAgICAgICAgQGNvcHkoKVxuICAgICAgICBAZGVsZXRlU2VsZWN0aW9uT3JDdXJzb3JMaW5lcygpXG4gICAgICAgIEBkby5lbmQoKVxuXG4gICAgY29weTogLT4gY2xpcGJvYXJkPy53cml0ZVRleHQgQHRleHRPZlNlbGVjdGlvbkZvckNsaXBib2FyZCgpXG5cbiAgICBwYXN0ZTogLT4gQHBhc3RlVGV4dCBjbGlwYm9hcmQ/LnJlYWRUZXh0KClcblxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwICAgICAgMDAwMDAwMDAwICAwMDAgICAgICAgMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgICAgICAgMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgMDAwMDAwMDBcblxuICAgIHJlcGxhY2VTZWxlY3RlZFRleHQ6IChsaW5lcykgLT5cblxuICAgICAgICBAZG8uc3RhcnQoKVxuICAgICAgICBuZXdTZWxlY3Rpb25zID0gQGRvLnNlbGVjdGlvbnMoKVxuXG4gICAgICAgIGZvciBucyBpbiBuZXdTZWxlY3Rpb25zXG4gICAgICAgICAgICBpbnNlcnQgPSBsaW5lcy5zaGlmdCgpXG4gICAgICAgICAgICBvbGRMZW5ndGggPSBuc1sxXVsxXS1uc1sxXVswXVxuICAgICAgICAgICAgQGRvLmNoYW5nZSBuc1swXSwgQGRvLmxpbmUobnNbMF0pLnNwbGljZSBuc1sxXVswXSwgb2xkTGVuZ3RoLCBpbnNlcnRcbiAgICAgICAgICAgIGxkaWZmID0gaW5zZXJ0Lmxlbmd0aCAtIG9sZExlbmd0aFxuICAgICAgICAgICAgZm9yIG9zIGluIHJhbmdlc0FmdGVyTGluZUNvbEluUmFuZ2VzIG5zWzBdLCBuc1sxXVsxXSwgbmV3U2VsZWN0aW9uc1xuICAgICAgICAgICAgICAgIG9zWzFdWzBdICs9IGxkaWZmXG4gICAgICAgICAgICAgICAgb3NbMV1bMV0gKz0gbGRpZmZcbiAgICAgICAgICAgIG5zWzFdWzFdICs9IGxkaWZmXG5cbiAgICAgICAgQGRvLnNlbGVjdCBuZXdTZWxlY3Rpb25zXG4gICAgICAgIEBkby5zZXRDdXJzb3JzIGVuZFBvc2l0aW9uc0Zyb21SYW5nZXMgbmV3U2VsZWN0aW9uc1xuICAgICAgICBAZG8uZW5kKClcblxuICAgICMgMDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwXG4gICAgIyAwMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMFxuICAgICMgMDAwICAgICAgICAwMDAgICAwMDAgICAgICAgMDAwICAgICAwMDAgICAgIDAwMFxuICAgICMgMDAwICAgICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMDAwMDAwXG5cbiAgICBwYXN0ZVRleHQ6ICh0ZXh0KSAtPlxuXG4gICAgICAgIGxpbmVzID0gdGV4dC5zcGxpdCAnXFxuJ1xuXG4gICAgICAgIGlzSW5wdXRDdXJzb3JBbmRTZWxlY3Rpb24gPSBAaXNJbnB1dEN1cnNvcigpIGFuZCBAc2VsZWN0ZWRMaW5lSW5kaWNlcygpLmxlbmd0aCA9PSAxIGFuZCBAc2VsZWN0ZWRMaW5lSW5kaWNlcygpWzBdID09IEBudW1MaW5lcygpLTFcblxuICAgICAgICBpZiBpc0lucHV0Q3Vyc29yQW5kU2VsZWN0aW9uIGFuZCBsaW5lcy5sZW5ndGggPT0gQG51bVNlbGVjdGlvbnMoKVxuICAgICAgICAgICAgQHJlcGxhY2VTZWxlY3RlZFRleHQgbGluZXNcbiAgICAgICAgICAgIEBzZWxlY3QgW11cbiAgICAgICAgICAgIHJldHVyblxuXG4gICAgICAgIGlmIChAbnVtTGluZXMoKSA9PSAxIGFuZCBAdGV4dCgpID09ICcnIGFuZCBsaW5lcy5sZW5ndGggPiAxKSBvciBhcmVTYW1lUmFuZ2VzIEByYW5nZXNGb3JBbGxMaW5lcygpLCBAc2VsZWN0aW9ucygpXG4gICAgICAgICAgICByZW1vdmVMYXN0TGluZSA9IHRydWUgIyBwcmV2ZW50cyB0cmFpbGluZyBlbXB0eSBsaW5lXG5cbiAgICAgICAgaWYgaXNJbnB1dEN1cnNvckFuZFNlbGVjdGlvblxuICAgICAgICAgICAgQGRlbGV0ZVNlbGVjdGlvbigpXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIEBzZWxlY3QgW11cblxuICAgICAgICBAZG8uc3RhcnQoKVxuXG4gICAgICAgIG5ld0N1cnNvcnMgPSBAcmVzdG9yZUlucHV0Q3Vyc29yKClcblxuICAgICAgICBpZiBuZXdDdXJzb3JzLmxlbmd0aCA+IDEgYW5kIGxpbmVzLmxlbmd0aCA9PSAxXG4gICAgICAgICAgICAjIHJlcGxpY2F0ZSBzaW5nbGUgbGluZXMgZm9yIGluc2VydGlvbiBhdCBtdWx0aXBsZSBjdXJzb3JzXG4gICAgICAgICAgICBsaW5lcyA9IChsaW5lc1swXSBmb3IgYyBpbiBuZXdDdXJzb3JzKVxuXG4gICAgICAgIGlmIG5ld0N1cnNvcnMubGVuZ3RoID4gMSBvciAobGluZXMubGVuZ3RoID09IDEpXG4gICAgICAgICAgICAjIGluc2VydCBpbnRvIG11bHRpcGxlIGN1cnNvcnNcbiAgICAgICAgICAgIGZvciBjaSBpbiBbbmV3Q3Vyc29ycy5sZW5ndGgtMS4uMF1cbiAgICAgICAgICAgICAgICBjID0gbmV3Q3Vyc29yc1tjaV1cbiAgICAgICAgICAgICAgICBpbnNlcnQgPSBsaW5lc1tjaSAlIGxpbmVzLmxlbmd0aF1cbiAgICAgICAgICAgICAgICBAZG8uY2hhbmdlIGNbMV0sIEBkby5saW5lKGNbMV0pLnNwbGljZSBjWzBdLCAwLCBpbnNlcnRcbiAgICAgICAgICAgICAgICBmb3IgYyBpbiBwb3NpdGlvbnNBZnRlckxpbmVDb2xJblBvc2l0aW9ucyBjWzFdLCBjWzBdLTEsIG5ld0N1cnNvcnNcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yRGVsdGEgYywgaW5zZXJ0Lmxlbmd0aCAjIG1vdmUgY3Vyc29ycyBhZnRlciBpbnNlcnRpb25cblxuICAgICAgICBlbHNlICMgaW5zZXJ0IG5ldyBsaW5lKHMpIGF0IHNpbmdsZSBjdXJzb3JcbiAgICAgICAgICAgIGNwID0gbmV3Q3Vyc29yc1swXVxuICAgICAgICAgICAgbGkgPSBjcFsxXVxuICAgICAgICAgICAgbmV3Q3Vyc29ycyA9IG51bGxcblxuICAgICAgICAgICAgaWYgY3BbMF0gPiAwXG5cbiAgICAgICAgICAgICAgICBbYmVmb3JlLCBhZnRlcl0gPSBAc3BsaXRTdGF0ZUxpbmVBdFBvcyBAZG8sIGNwXG4gICAgICAgICAgICAgICAgYWZ0ZXIgPSBhZnRlci50cmltTGVmdCgpXG5cbiAgICAgICAgICAgICAgICBpbmR0ICAgPSBfLnBhZFN0YXJ0ICcnIGluZGVudGF0aW9uSW5MaW5lIEBkby5saW5lIGNwWzFdXG4gICAgICAgICAgICAgICAgaWYgYmVmb3JlLnRyaW0oKS5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgQGRvLmNoYW5nZSBsaSwgYmVmb3JlXG4gICAgICAgICAgICAgICAgICAgIGxpICs9IDFcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZHQgKyBhZnRlcikudHJpbSgpLmxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZXMucHVzaCBpbmR0ICsgYWZ0ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0N1cnNvcnMgPSBbWzAsbGkrbGluZXMubGVuZ3RoLTFdXVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGlmIEBkby5saW5lKGxpKS5sZW5ndGggPT0gMCBhbmQgbm90IHJlbW92ZUxhc3RMaW5lXG4gICAgICAgICAgICAgICAgICAgIGxpICs9IDEgIyBpbnNlcnQgYWZ0ZXIgZW1wdHkgbGluZVxuXG4gICAgICAgICAgICBmb3IgbGluZSBpbiBsaW5lc1xuICAgICAgICAgICAgICAgIEBkby5pbnNlcnQgbGksIGxpbmVcbiAgICAgICAgICAgICAgICBsaSArPSAxXG5cbiAgICAgICAgICAgIG5ld0N1cnNvcnMgPSBbWzAsIGxpXV0gaWYgZW1wdHkgbmV3Q3Vyc29yc1xuXG4gICAgICAgIGlmIHJlbW92ZUxhc3RMaW5lXG4gICAgICAgICAgICBAZG8uZGVsZXRlIEBkby5udW1MaW5lcygpLTFcblxuICAgICAgICBAZG8uc2V0Q3Vyc29ycyBuZXdDdXJzb3JzXG4gICAgICAgIEBkby5lbmQoKVxuIl19
//# sourceURL=../../../coffee/editor/actions/paste.coffee