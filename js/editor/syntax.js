// koffee 1.4.0

/*
 0000000  000   000  000   000  000000000   0000000   000   000
000        000 000   0000  000     000     000   000   000 000
0000000     00000    000 0 000     000     000000000    00000
     000     000     000  0000     000     000   000   000 000
0000000      000     000   000     000     000   000  000   000
 */
var Syntax, _, chroma, elem, empty, kerror, klor, kstr, last, matchr, ref;

ref = require('kxk'), matchr = ref.matchr, empty = ref.empty, kstr = ref.kstr, klor = ref.klor, elem = ref.elem, last = ref.last, kerror = ref.kerror, _ = ref._;

chroma = require('chroma-js');

Syntax = (function() {
    function Syntax(name, getLine, getAnsi) {
        this.name = name;
        this.getLine = getLine;
        this.getAnsi = getAnsi;
        this.diss = [];
        this.colors = {};
        this.ansi = new kstr.ansi;
    }

    Syntax.prototype.newDiss = function(li) {
        var ansi, diss, text;
        text = this.getLine(li);
        if (text == null) {
            return kerror("dissForLine -- no line at index " + li + "?");
        }
        if (empty(text)) {
            return [
                {
                    start: 0,
                    length: 0,
                    match: ''
                }
            ];
        }
        if (ansi = this.getAnsi(li)) {
            diss = this.ansi.dissect(ansi)[1];
        } else {
            diss = klor.dissect([text], 'sh')[0];
        }
        return diss;
    };

    Syntax.prototype.getDiss = function(li) {
        if (this.diss[li] == null) {
            this.diss[li] = this.newDiss(li);
        }
        return this.diss[li];
    };

    Syntax.prototype.setDiss = function(li, dss) {
        this.diss[li] = dss;
        return dss;
    };

    Syntax.prototype.fillDiss = function(bot) {
        var i, li, ref1, results;
        results = [];
        for (li = i = 0, ref1 = bot; 0 <= ref1 ? i <= ref1 : i >= ref1; li = 0 <= ref1 ? ++i : --i) {
            results.push(this.getDiss(li));
        }
        return results;
    };

    Syntax.prototype.setLines = function(lines) {};

    Syntax.prototype.changed = function(changeInfo) {
        var ch, change, di, i, len, li, ref1, ref2, results;
        ref1 = changeInfo.changes;
        results = [];
        for (i = 0, len = ref1.length; i < len; i++) {
            change = ref1[i];
            ref2 = [change.doIndex, change.newIndex, change.change], di = ref2[0], li = ref2[1], ch = ref2[2];
            switch (ch) {
                case 'changed':
                    results.push(this.diss[di] = this.newDiss(di));
                    break;
                case 'deleted':
                    results.push(this.diss.splice(di, 1));
                    break;
                case 'inserted':
                    results.push(this.diss.splice(di, 0, this.newDiss(di)));
                    break;
                default:
                    results.push(void 0);
            }
        }
        return results;
    };

    Syntax.prototype.setFileType = function(name) {
        this.name = name;
    };

    Syntax.prototype.clear = function() {
        return this.diss = [];
    };

    Syntax.prototype.colorForClassnames = function(clss) {
        var color, computedStyle, div, opacity;
        if (this.colors[clss] == null) {
            div = elem({
                "class": clss
            });
            document.body.appendChild(div);
            computedStyle = window.getComputedStyle(div);
            color = computedStyle.color;
            opacity = computedStyle.opacity;
            if (opacity !== '1') {
                color = 'rgba(' + color.slice(4, color.length - 2) + ', ' + opacity + ')';
            }
            this.colors[clss] = color;
            div.remove();
        }
        return this.colors[clss];
    };

    Syntax.prototype.colorForStyle = function(styl) {
        var bgcol, div;
        if (this.colors[styl] == null) {
            div = elem('div');
            div.style = styl;
            document.body.appendChild(div);
            bgcol = kstr(window.getComputedStyle(div).backgroundColor);
            if (styl.startsWith('back')) {
                this.colors[styl] = bgcol;
            } else {
                this.colors[styl] = kstr(window.getComputedStyle(div).color);
                if (bgcol !== 'rgba(0, 0, 0, 0)') {
                    this.colors[styl] = chroma.mix(bgcol, this.colors[styl], 0.5, 'hsl').css();
                }
            }
            div.remove();
        }
        return this.colors[styl];
    };

    Syntax.prototype.schemeChanged = function() {
        return this.colors = {};
    };


    /*
     0000000  000000000   0000000   000000000  000   0000000
    000          000     000   000     000     000  000
    0000000      000     000000000     000     000  000
         000     000     000   000     000     000  000
    0000000      000     000   000     000     000   0000000
     */

    Syntax.matchrConfigs = {};

    Syntax.syntaxNames = [];

    Syntax.spanForTextAndSyntax = function(text, n) {
        var clrzd, clss, d, di, diss, i, j, l, ref1, ref2, ref3, sp, spc, style;
        l = "";
        diss = this.dissForTextAndSyntax(text, n);
        if (diss != null ? diss.length : void 0) {
            last = 0;
            for (di = i = 0, ref1 = diss.length; 0 <= ref1 ? i < ref1 : i > ref1; di = 0 <= ref1 ? ++i : --i) {
                d = diss[di];
                style = (d.styl != null) && d.styl.length && (" style=\"" + d.styl + "\"") || '';
                spc = '';
                for (sp = j = ref2 = last, ref3 = d.start; ref2 <= ref3 ? j < ref3 : j > ref3; sp = ref2 <= ref3 ? ++j : --j) {
                    spc += '&nbsp;';
                }
                last = d.start + d.match.length;
                clss = (d.clss != null) && d.clss.length && (" class=\"" + d.clss + "\"") || '';
                clrzd = "<span" + style + clss + ">" + spc + (kstr.encode(d.match)) + "</span>";
                l += clrzd;
            }
        }
        return l;
    };

    Syntax.rangesForTextAndSyntax = function(line, n) {
        return matchr.ranges(Syntax.matchrConfigs[n], line);
    };

    Syntax.dissForTextAndSyntax = function(text, n) {
        return klor.ranges(text, n);
    };

    Syntax.lineForDiss = function(dss) {
        var d, i, l, len;
        l = "";
        for (i = 0, len = dss.length; i < len; i++) {
            d = dss[i];
            l = _.padEnd(l, d.start);
            l += d.match;
        }
        return l;
    };

    Syntax.init = function() {
        return this.syntaxNames = this.syntaxNames.concat(klor.exts);
    };

    return Syntax;

})();

Syntax.init();

module.exports = Syntax;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ludGF4LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxNQUF1RCxPQUFBLENBQVEsS0FBUixDQUF2RCxFQUFFLG1CQUFGLEVBQVUsaUJBQVYsRUFBaUIsZUFBakIsRUFBdUIsZUFBdkIsRUFBNkIsZUFBN0IsRUFBbUMsZUFBbkMsRUFBeUMsbUJBQXpDLEVBQWlEOztBQUVqRCxNQUFBLEdBQVMsT0FBQSxDQUFRLFdBQVI7O0FBRUg7SUFFQyxnQkFBQyxJQUFELEVBQVEsT0FBUixFQUFrQixPQUFsQjtRQUFDLElBQUMsQ0FBQSxPQUFEO1FBQU8sSUFBQyxDQUFBLFVBQUQ7UUFBVSxJQUFDLENBQUEsVUFBRDtRQUVqQixJQUFDLENBQUEsSUFBRCxHQUFVO1FBQ1YsSUFBQyxDQUFBLE1BQUQsR0FBVTtRQUNWLElBQUMsQ0FBQSxJQUFELEdBQVUsSUFBSSxJQUFJLENBQUM7SUFKcEI7O3FCQVlILE9BQUEsR0FBUyxTQUFDLEVBQUQ7QUFFTCxZQUFBO1FBQUEsSUFBQSxHQUFPLElBQUMsQ0FBQSxPQUFELENBQVMsRUFBVDtRQUVQLElBQU8sWUFBUDtBQUNJLG1CQUFPLE1BQUEsQ0FBTyxrQ0FBQSxHQUFtQyxFQUFuQyxHQUFzQyxHQUE3QyxFQURYOztRQUdBLElBQXNDLEtBQUEsQ0FBTSxJQUFOLENBQXRDO0FBQUEsbUJBQU87Z0JBQUM7b0JBQUEsS0FBQSxFQUFNLENBQU47b0JBQVEsTUFBQSxFQUFPLENBQWY7b0JBQWlCLEtBQUEsRUFBTSxFQUF2QjtpQkFBRDtjQUFQOztRQUVBLElBQUcsSUFBQSxHQUFPLElBQUMsQ0FBQSxPQUFELENBQVMsRUFBVCxDQUFWO1lBQ0ksSUFBQSxHQUFPLElBQUMsQ0FBQSxJQUFJLENBQUMsT0FBTixDQUFjLElBQWQsQ0FBb0IsQ0FBQSxDQUFBLEVBRC9CO1NBQUEsTUFBQTtZQUlJLElBQUEsR0FBTyxJQUFJLENBQUMsT0FB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O0FBQ0EsTUFBTSxDQUFDLE9BQVAsR0FBaUIiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbiAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMFxuMDAwICAgICAgICAwMDAgMDAwICAgMDAwMCAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgIDAwMCAwMDBcbjAwMDAwMDAgICAgIDAwMDAwICAgIDAwMCAwIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMDAgICAgMDAwMDBcbiAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgMDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgICAwMDAgMDAwXG4wMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDBcbiMjI1xuXG57IG1hdGNociwgZW1wdHksIGtzdHIsIGtsb3IsIGVsZW0sIGxhc3QsIGtlcnJvciwgXyB9ID0gcmVxdWlyZSAna3hrJ1xuXG5jaHJvbWEgPSByZXF1aXJlICdjaHJvbWEtanMnXG5cbmNsYXNzIFN5bnRheFxuICAgIFxuICAgIEA6IChAbmFtZSwgQGdldExpbmUsIEBnZXRBbnNpKSAtPlxuXG4gICAgICAgIEBkaXNzICAgPSBbXVxuICAgICAgICBAY29sb3JzID0ge31cbiAgICAgICAgQGFuc2kgICA9IG5ldyBrc3RyLmFuc2lcblxuICAgICMgMDAwMDAwMCAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwICAgMDAwMDAwMFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMFxuICAgICMgMDAwMDAwMCAgICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwXG5cbiAgICBuZXdEaXNzOiAobGkpIC0+XG5cbiAgICAgICAgdGV4dCA9IEBnZXRMaW5lIGxpXG5cbiAgICAgICAgaWYgbm90IHRleHQ/XG4gICAgICAgICAgICByZXR1cm4ga2Vycm9yIFwiZGlzc0ZvckxpbmUgLS0gbm8gbGluZSBhdCBpbmRleCAje2xpfT9cIlxuICAgICAgICAgICAgXG4gICAgICAgIHJldHVybiBbc3RhcnQ6MCBsZW5ndGg6MCBtYXRjaDonJ10gaWYgZW1wdHkgdGV4dFxuXG4gICAgICAgIGlmIGFuc2kgPSBAZ2V0QW5zaSBsaVxuICAgICAgICAgICAgZGlzcyA9IEBhbnNpLmRpc3NlY3QoYW5zaSlbMV1cbiAgICAgICAgICAgICMga2xvZyAnbmV3RGlzcycgbGksIGRpc3NcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgZGlzcyA9IGtsb3IuZGlzc2VjdChbdGV4dF0sICdzaCcpWzBdXG4gICAgICAgICAgICBcbiAgICAgICAgZGlzc1xuXG4gICAgZ2V0RGlzczogKGxpKSAtPlxuXG4gICAgICAgIGlmIG5vdCBAZGlzc1tsaV0/XG4gICAgICAgICAgICBAZGlzc1tsaV0gPSBAbmV3RGlzcyBsaVxuXG4gICAgICAgICMga2xvZyBcIiN7bGl9XCIgQGRpc3NbbGldXG4gICAgICAgICAgICBcbiAgICAgICAgQGRpc3NbbGldXG5cbiAgICBzZXREaXNzOiAobGksIGRzcykgLT5cblxuICAgICAgICBAZGlzc1tsaV0gPSBkc3NcbiAgICAgICAgZHNzXG5cbiAgICBmaWxsRGlzczogKGJvdCkgLT5cblxuICAgICAgICBmb3IgbGkgaW4gWzAuLmJvdF1cbiAgICAgICAgICAgIEBnZXREaXNzIGxpXG5cbiAgICAjICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAgICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICBcbiAgICAjICAgICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgICAgICAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgICBcbiAgICBcbiAgICBzZXRMaW5lczogKGxpbmVzKSAtPlxuICAgICAgICBcbiAgICAjICAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAwMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAwMDAwICAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMFxuXG4gICAgY2hhbmdlZDogKGNoYW5nZUluZm8pIC0+XG5cbiAgICAgICAgZm9yIGNoYW5nZSBpbiBjaGFuZ2VJbmZvLmNoYW5nZXNcblxuICAgICAgICAgICAgW2RpLGxpLGNoXSA9IFtjaGFuZ2UuZG9JbmRleCwgY2hhbmdlLm5ld0luZGV4LCBjaGFuZ2UuY2hhbmdlXVxuXG4gICAgICAgICAgICBzd2l0Y2ggY2hcblxuICAgICAgICAgICAgICAgIHdoZW4gJ2NoYW5nZWQnXG5cbiAgICAgICAgICAgICAgICAgICAgQGRpc3NbZGldID0gQG5ld0Rpc3MgZGlcblxuICAgICAgICAgICAgICAgIHdoZW4gJ2RlbGV0ZWQnXG5cbiAgICAgICAgICAgICAgICAgICAgQGRpc3Muc3BsaWNlIGRpLCAxXG5cbiAgICAgICAgICAgICAgICB3aGVuICdpbnNlcnRlZCdcblxuICAgICAgICAgICAgICAgICAgICBAZGlzcy5zcGxpY2UgZGksIDAsIEBuZXdEaXNzIGRpXG5cbiAgICAjIDAwMDAwMDAwICAwMDAgIDAwMCAgICAgIDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwMFxuICAgICMgMDAwICAgICAgIDAwMCAgMDAwICAgICAgMDAwICAgICAgICAgIDAwMCAgICAgIDAwMCAwMDAgICAwMDAgICAwMDAgIDAwMFxuICAgICMgMDAwMDAwICAgIDAwMCAgMDAwICAgICAgMDAwMDAwMCAgICAgIDAwMCAgICAgICAwMDAwMCAgICAwMDAwMDAwMCAgIDAwMDAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgIDAwMCAgICAgIDAwMCAgICAgICAgICAwMDAgICAgICAgIDAwMCAgICAgMDAwICAgICAgICAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICAgICAwMDAgICAgICAgIDAwMCAgICAgMDAwICAgICAgICAwMDAwMDAwMFxuXG4gICAgc2V0RmlsZVR5cGU6IChAbmFtZSkgLT5cblxuICAgICMgIDAwMDAwMDAgIDAwMCAgICAgIDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuICAgICMgIDAwMDAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuXG4gICAgY2xlYXI6IC0+XG5cbiAgICAgICAgQGRpc3MgPSBbXVxuXG4gICAgIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAgICAgMDAwMDAwMCAgIDAwMDAwMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgMDAwICAwMDAwMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuICAgICMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDBcblxuICAgIGNvbG9yRm9yQ2xhc3NuYW1lczogKGNsc3MpIC0+XG5cbiAgICAgICAgaWYgbm90IEBjb2xvcnNbY2xzc10/XG5cbiAgICAgICAgICAgIGRpdiA9IGVsZW0gY2xhc3M6IGNsc3NcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQgZGl2XG4gICAgICAgICAgICBjb21wdXRlZFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUgZGl2XG4gICAgICAgICAgICBjb2xvciA9IGNvbXB1dGVkU3R5bGUuY29sb3JcbiAgICAgICAgICAgIG9wYWNpdHkgPSBjb21wdXRlZFN0eWxlLm9wYWNpdHlcbiAgICAgICAgICAgIGlmIG9wYWNpdHkgIT0gJzEnXG4gICAgICAgICAgICAgICAgY29sb3IgPSAncmdiYSgnICsgY29sb3Iuc2xpY2UoNCwgY29sb3IubGVuZ3RoLTIpICsgJywgJyArIG9wYWNpdHkgKyAnKSdcbiAgICAgICAgICAgIEBjb2xvcnNbY2xzc10gPSBjb2xvclxuICAgICAgICAgICAgZGl2LnJlbW92ZSgpXG5cbiAgICAgICAgcmV0dXJuIEBjb2xvcnNbY2xzc11cblxuICAgIGNvbG9yRm9yU3R5bGU6IChzdHlsKSAtPlxuXG4gICAgICAgIGlmIG5vdCBAY29sb3JzW3N0eWxdP1xuICAgICAgICAgICAgZGl2ID0gZWxlbSAnZGl2J1xuICAgICAgICAgICAgZGl2LnN0eWxlID0gc3R5bFxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCBkaXZcbiAgICAgICAgICAgIGJnY29sID0ga3N0ciB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkaXYpLmJhY2tncm91bmRDb2xvclxuICAgICAgICAgICAgaWYgc3R5bC5zdGFydHNXaXRoICdiYWNrJyBcbiAgICAgICAgICAgICAgICBAY29sb3JzW3N0eWxdID0gYmdjb2xcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBAY29sb3JzW3N0eWxdID0ga3N0ciB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkaXYpLmNvbG9yXG4gICAgICAgICAgICAgICAgaWYgYmdjb2wgIT0gJ3JnYmEoMCwgMCwgMCwgMCknXG4gICAgICAgICAgICAgICAgICAgIEBjb2xvcnNbc3R5bF0gPSBjaHJvbWEubWl4KGJnY29sLCBAY29sb3JzW3N0eWxdLCAwLjUsICdoc2wnKS5jc3MoKVxuICAgICAgICAgICAgICAgICAgICAjIGtsb2cgJ2NvbG9yJyBAY29sb3JzW3N0eWxdXG4gICAgICAgICAgICBkaXYucmVtb3ZlKClcblxuICAgICAgICByZXR1cm4gQGNvbG9yc1tzdHlsXVxuXG4gICAgc2NoZW1lQ2hhbmdlZDogLT4gQGNvbG9ycyA9IHt9XG5cbiAgICAjIyNcbiAgICAgMDAwMDAwMCAgMDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwICAgMDAwMDAwMFxuICAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgIDAwMFxuICAgIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAgIDAwMFxuICAgICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgIDAwMFxuICAgIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAwMDAwXG4gICAgIyMjXG5cbiAgICBAbWF0Y2hyQ29uZmlncyA9IHt9XG4gICAgQHN5bnRheE5hbWVzID0gW11cblxuICAgIEBzcGFuRm9yVGV4dEFuZFN5bnRheDogKHRleHQsIG4pIC0+XG5cbiAgICAgICAgbCA9IFwiXCJcbiAgICAgICAgZGlzcyA9IEBkaXNzRm9yVGV4dEFuZFN5bnRheCB0ZXh0LCBuXG4gICAgICAgIGlmIGRpc3M/Lmxlbmd0aFxuICAgICAgICAgICAgbGFzdCA9IDBcbiAgICAgICAgICAgIGZvciBkaSBpbiBbMC4uLmRpc3MubGVuZ3RoXVxuICAgICAgICAgICAgICAgIGQgPSBkaXNzW2RpXVxuICAgICAgICAgICAgICAgIHN0eWxlID0gZC5zdHlsPyBhbmQgZC5zdHlsLmxlbmd0aCBhbmQgXCIgc3R5bGU9XFxcIiN7ZC5zdHlsfVxcXCJcIiBvciAnJ1xuICAgICAgICAgICAgICAgIHNwYyA9ICcnXG4gICAgICAgICAgICAgICAgZm9yIHNwIGluIFtsYXN0Li4uZC5zdGFydF1cbiAgICAgICAgICAgICAgICAgICAgc3BjICs9ICcmbmJzcDsnXG4gICAgICAgICAgICAgICAgbGFzdCAgPSBkLnN0YXJ0ICsgZC5tYXRjaC5sZW5ndGhcbiAgICAgICAgICAgICAgICBjbHNzID0gZC5jbHNzPyBhbmQgZC5jbHNzLmxlbmd0aCBhbmQgXCIgY2xhc3M9XFxcIiN7ZC5jbHNzfVxcXCJcIiBvciAnJ1xuICAgICAgICAgICAgICAgIGNscnpkID0gXCI8c3BhbiN7c3R5bGV9I3tjbHNzfT4je3NwY30je2tzdHIuZW5jb2RlIGQubWF0Y2h9PC9zcGFuPlwiXG4gICAgICAgICAgICAgICAgbCArPSBjbHJ6ZFxuICAgICAgICBsXG5cbiAgICBAcmFuZ2VzRm9yVGV4dEFuZFN5bnRheDogKGxpbmUsIG4pIC0+XG5cbiAgICAgICAgbWF0Y2hyLnJhbmdlcyBTeW50YXgubWF0Y2hyQ29uZmlnc1tuXSwgbGluZVxuXG4gICAgQGRpc3NGb3JUZXh0QW5kU3ludGF4OiAodGV4dCwgbikgLT5cblxuICAgICAgICBrbG9yLnJhbmdlcyB0ZXh0LCBuXG5cbiAgICBAbGluZUZvckRpc3M6IChkc3MpIC0+XG5cbiAgICAgICAgbCA9IFwiXCJcbiAgICAgICAgZm9yIGQgaW4gZHNzXG4gICAgICAgICAgICBsID0gXy5wYWRFbmQgbCwgZC5zdGFydFxuICAgICAgICAgICAgbCArPSBkLm1hdGNoXG4gICAgICAgIGxcblxuICAgICMgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMDAwMDAwXG4gICAgIyAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAwMDBcbiAgICAjIDAwMCAgMDAwIDAgMDAwICAwMDAgICAgIDAwMFxuICAgICMgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgMDAwXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAwMDBcblxuICAgIEBpbml0OiAtPlxuXG4gICAgICAgICMgc3ludGF4RGlyID0gXCIje19fZGlybmFtZX0vLi4vLi4vc3ludGF4L1wiXG5cbiAgICAgICAgIyBmb3Igc3ludGF4RmlsZSBpbiBmcy5yZWFkZGlyU3luYyBzeW50YXhEaXJcblxuICAgICAgICAgICAgIyBzeW50YXhOYW1lID0gc2xhc2guYmFzZW5hbWUgc3ludGF4RmlsZSwgJy5ub29uJ1xuICAgICAgICAgICAgIyBwYXR0ZXJucyA9IG5vb24ubG9hZCBzbGFzaC5qb2luIHN5bnRheERpciwgc3ludGF4RmlsZVxuXG4gICAgICAgICAgICAjIHBhdHRlcm5zWydcXFxcdysnXSAgICAgICA9ICd0ZXh0JyAgICMgdGhpcyBlbnN1cmVzIHRoYXQgYWxsIC4uLlxuICAgICAgICAgICAgIyBwYXR0ZXJuc1snW15cXFxcd1xcXFxzXSsnXSA9ICdzeW50YXgnICMgbm9uLXNwYWNlIGNoYXJhY3RlcnMgbWF0Y2hcblxuICAgICAgICAgICAgIyBpZiBwYXR0ZXJucy5rbz8uZXh0bmFtZXM/XG4gICAgICAgICAgICAgICAgIyBleHRuYW1lcyA9IHBhdHRlcm5zLmtvLmV4dG5hbWVzXG4gICAgICAgICAgICAgICAgIyBkZWxldGUgcGF0dGVybnMua29cblxuICAgICAgICAgICAgICAgICMgY29uZmlnID0gbWF0Y2hyLmNvbmZpZyBwYXR0ZXJuc1xuICAgICAgICAgICAgICAgICMgZm9yIHN5bnRheE5hbWUgaW4gZXh0bmFtZXNcbiAgICAgICAgICAgICAgICAgICAgIyBAc3ludGF4TmFtZXMucHVzaCBzeW50YXhOYW1lXG4gICAgICAgICAgICAgICAgICAgICMgQG1hdGNockNvbmZpZ3Nbc3ludGF4TmFtZV0gPSBjb25maWdcbiAgICAgICAgICAgICMgZWxzZVxuICAgICAgICAgICAgICAgICMgQHN5bnRheE5hbWVzLnB1c2ggc3ludGF4TmFtZVxuICAgICAgICAgICAgICAgICMgQG1hdGNockNvbmZpZ3Nbc3ludGF4TmFtZV0gPSBtYXRjaHIuY29uZmlnIHBhdHRlcm5zXG5cbiAgICAgICAgIyBrbG9yLmluaXQoKVxuICAgICAgICBAc3ludGF4TmFtZXMgPSBAc3ludGF4TmFtZXMuY29uY2F0IGtsb3IuZXh0c1xuXG5TeW50YXguaW5pdCgpXG5tb2R1bGUuZXhwb3J0cyA9IFN5bnRheFxuIl19
//# sourceURL=../../coffee/editor/syntax.coffee